

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/blogFavicon.png">
  <link rel="icon" href="/img/blogFavicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  
    <meta name="description" content="">
  
  <meta name="author" content="Daiwei">
  <meta name="keywords" content="">
  
  <title>JVM GC篇 — 日志解读与GC调优 - Daiwei‘s blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.8","typing":{"enable":true,"typeSpeed":100,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"onlypost":false},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Daiwei's blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('https://gitee.com/realDaiwei/img/raw/master/justin-heap-RrUItyCYrVM-unsplash.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="JVM GC篇 — 日志解读与GC调优">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-07-25 17:38" pubdate>
        2021年7月25日 下午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      26.6k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      124
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">JVM GC篇 — 日志解读与GC调优</h1>
            
            <div class="markdown-body">
              <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前面一小节我们简单深入的梳理了垃圾收集器，梳理理解了各个垃圾收集器的原理和回收流程。其中主要的垃圾收集器可以分为“经典垃圾收集器”和“低延迟垃圾收集器”，其中经典垃圾收集器是以Parallel、CMS、G1为首在生产环境经过千万次历练的垃圾收集器。低延迟垃圾收集器们则是最新还处于实验状态的 shenandoah 和 ZGC，这一代的设计目标是在超大堆下依旧能能实现高吞吐低延迟的垃圾收集。但是就目前为止，我们在生产环境使用的依旧是经典垃圾收集器，因此在GC环境，我们依旧要对GC进行调优以充分利用物理机的性能。GC调优这个词我们听过很多次，但是真正操作起来可能会像不知所措无从下手。但是朋友不要害怕，有了前面的基础铺垫再加上一些监控指标，经过这一小节，你一定会对GC调优有个全面的认识。这一小节我们会先从GC调优分析开始，介绍调优的基本流程、GC的一些限制，随后我们进行一段调优的示例，在示例中我们如何进行日志分析与GC调优。最后我们会梳理一个简单的产生垃圾的程序，并分析在不同的垃圾收集器下的GC日志分析调优。</p>
<h2 id="日志解读"><a href="#日志解读" class="headerlink" title="日志解读"></a>日志解读</h2><p>上一节我们介绍了各种垃圾收集器。如果定位GC问题和GC调优我们离不开对GC日志的分析。在这个部分我们将分析这些GC的日志，来分GC日志中隐藏的GC垃圾收集信息。</p>
<h3 id="Serial-GC-日志解读"><a href="#Serial-GC-日志解读" class="headerlink" title="Serial GC 日志解读"></a>Serial GC 日志解读</h3><p>我们为了能够打开GC日志记录并指定垃圾收集器为Serial，我们使用下面的JVM启动参数：</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-XX:+UseSerialGC -Xms512m -Xmx512m -Xloggc:gc.log </span><br><span class="hljs-deletion">-XX:+PrintGCDetails -XX:+PrintGCDateStamps</span><br></code></pre></td></tr></table></figure>

<p>使用上面的JVM启动参数，我们可以得到如下的日志输出（p.s. 已经手工折叠部分日志）</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-variable">Java</span> <span class="hljs-variable">HotSpot</span><span class="hljs-punctuation">(</span><span class="hljs-variable">TM</span><span class="hljs-punctuation">)</span> <span class="hljs-number">64</span><span class="hljs-operator">-</span><span class="hljs-variable">Bit</span> <span class="hljs-variable">Server</span> <span class="hljs-variable">VM</span> <span class="hljs-punctuation">(</span><span class="hljs-number">25.231</span><span class="hljs-operator">-</span><span class="hljs-variable">b11</span><span class="hljs-punctuation">)</span> <span class="hljs-variable">for</span> <span class="hljs-variable">bsd</span><span class="hljs-operator">-</span><span class="hljs-variable">amd64</span> <span class="hljs-variable">JRE</span> <span class="hljs-punctuation">(</span><span class="hljs-number">1.8</span><span class="hljs-number">.0</span><span class="hljs-type">_</span><span class="hljs-number">231</span><span class="hljs-operator">-</span><span class="hljs-variable">b11</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-variable">built</span> <span class="hljs-variable">on</span> <span class="hljs-variable">Oct</span>  <span class="hljs-number">5</span> <span class="hljs-number">2019</span> <span class="hljs-number">03</span><span class="hljs-operator">:</span><span class="hljs-number">15</span><span class="hljs-operator">:</span><span class="hljs-number">25</span> <span class="hljs-variable">by</span> <span class="hljs-string">&quot;java_re&quot;</span> <span class="hljs-variable">with</span> <span class="hljs-variable">gcc</span> <span class="hljs-number">4.2</span><span class="hljs-number">.1</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Based</span> <span class="hljs-variable">on</span> <span class="hljs-variable">Apple</span> <span class="hljs-variable">Inc</span><span class="hljs-operator">.</span> <span class="hljs-variable">build</span> <span class="hljs-number">5658</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">LLVM</span> <span class="hljs-variable">build</span> <span class="hljs-number">2336.11</span><span class="hljs-number">.00</span><span class="hljs-punctuation">)</span><br><span class="hljs-variable">Memory</span><span class="hljs-operator">:</span> <span class="hljs-number">4</span><span class="hljs-variable">k</span> <span class="hljs-variable">page</span><span class="hljs-operator">,</span> <span class="hljs-variable">physical</span> <span class="hljs-number">16777216</span><span class="hljs-variable">k</span><span class="hljs-punctuation">(</span><span class="hljs-number">794016</span><span class="hljs-variable">k</span> <span class="hljs-variable">free</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-operator">/</span><span class="hljs-variable">proc</span><span class="hljs-operator">/</span><span class="hljs-variable">meminfo</span><span class="hljs-operator">:</span><br><br><span class="hljs-variable">CommandLine</span> <span class="hljs-variable">flags</span><span class="hljs-operator">:</span> <br>        <span class="hljs-operator">-</span><span class="hljs-variable">XX</span><span class="hljs-operator">:</span><span class="hljs-variable">InitialHeapSize</span><span class="hljs-operator">=</span><span class="hljs-number">536870912</span> <span class="hljs-operator">-</span><span class="hljs-variable">XX</span><span class="hljs-operator">:</span><span class="hljs-variable">MaxHeapSize</span><span class="hljs-operator">=</span><span class="hljs-number">536870912</span> <br>    <span class="hljs-operator">-</span><span class="hljs-variable">XX</span><span class="hljs-operator">:+</span><span class="hljs-variable">PrintGC</span> <span class="hljs-operator">-</span><span class="hljs-variable">XX</span><span class="hljs-operator">:+</span><span class="hljs-variable">PrintGCDateStamps</span> <span class="hljs-operator">-</span><span class="hljs-variable">XX</span><span class="hljs-operator">:+</span><span class="hljs-variable">PrintGCDetails</span> <span class="hljs-operator">-</span><span class="hljs-variable">XX</span><span class="hljs-operator">:+</span><span class="hljs-variable">PrintGCTimeStamps</span> <br>    <span class="hljs-operator">-</span><span class="hljs-variable">XX</span><span class="hljs-operator">:+</span><span class="hljs-variable">UseCompressedClassPointers</span> <br>    <span class="hljs-operator">-</span><span class="hljs-variable">XX</span><span class="hljs-operator">:+</span><span class="hljs-variable">UseCompressedOops</span> <span class="hljs-operator">-</span><span class="hljs-variable">XX</span><span class="hljs-operator">:+</span><span class="hljs-variable">UseSerialGC</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">13.329</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.177</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">13.329</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.177</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">DefNew</span><span class="hljs-operator">:</span> <span class="hljs-number">139776</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">17472</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">157248</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0219962</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-number">139776</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">45575</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">506816</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0221202</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.03</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">13.369</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.217</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">13.369</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.217</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">DefNew</span><span class="hljs-operator">:</span> <span class="hljs-number">157248</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">17471</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">157248</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0271936</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-number">185351</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">89018</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">506816</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0272786</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.03</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">13.412</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.260</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">13.412</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.260</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">DefNew</span><span class="hljs-operator">:</span> <span class="hljs-number">157247</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">17471</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">157248</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0224308</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-number">228794</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">134099</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">506816</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0225212</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.02</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-operator">......</span><br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">13.931</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.779</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">13.931</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.779</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">DefNew</span><span class="hljs-operator">:</span> <span class="hljs-number">157243</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">157243</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">157248</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0000170</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">13.931</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.779</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Tenured</span><span class="hljs-operator">:</span> <span class="hljs-number">332621</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">341869</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">349568</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0488050</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-number">489864</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">341869</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">506816</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0489122</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.00</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.05</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">13.997</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.845</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">13.997</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.845</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">DefNew</span><span class="hljs-operator">:</span> <span class="hljs-number">139776</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">139776</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">157248</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0000171</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">13.997</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.845</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Tenured</span><span class="hljs-operator">:</span> <span class="hljs-number">341869</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">340659</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">349568</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0437236</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-number">481645</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">340659</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">506816</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0438227</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.00</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.05</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">14.058</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.906</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">14.058</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.906</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">DefNew</span><span class="hljs-operator">:</span> <span class="hljs-number">139776</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">139776</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">157248</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0000175</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">14.058</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.906</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Tenured</span><span class="hljs-operator">:</span> <span class="hljs-number">340659</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">342260</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">349568</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0457178</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-number">480435</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">342260</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">506816</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0458305</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.00</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.05</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">14.122</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.970</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">14.122</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.970</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">DefNew</span><span class="hljs-operator">:</span> <span class="hljs-number">139776</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">139776</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">157248</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0000197</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">14.122</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.970</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Tenured</span><span class="hljs-operator">:</span> <span class="hljs-number">342260</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">332184</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">349568</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0497748</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-number">482036</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">332184</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">506816</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0498987</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.05</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.00</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.05</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">14.190</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">1.038</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">14.190</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">1.038</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">DefNew</span><span class="hljs-operator">:</span> <span class="hljs-number">139776</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">139776</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">157248</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0000187</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">14.190</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">1.038</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Tenured</span><span class="hljs-operator">:</span> <span class="hljs-number">332184</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">349062</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">349568</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0294194</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-number">471960</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">353796</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">506816</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0295288</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.03</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.03</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">14.241</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">1.089</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">14.241</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">1.089</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Tenured</span><span class="hljs-operator">:</span> <span class="hljs-number">349062</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">349274</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">349568</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0397096</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-number">506055</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">351244</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">506816</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0398051</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.00</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-variable">Heap</span><br> <span class="hljs-variable">def</span> <span class="hljs-variable">new</span> <span class="hljs-variable">generation</span>   <span class="hljs-variable">total</span> <span class="hljs-number">157248</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span> <span class="hljs-variable">used</span> <span class="hljs-number">8337</span><span class="hljs-built_in">K</span> <span class="hljs-punctuation">[</span><span class="hljs-number">0</span><span class="hljs-variable">x00000007a0000000</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span><span class="hljs-variable">x00000007aaaa0000</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span><span class="hljs-variable">x00000007aaaa0000</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-variable">eden</span> <span class="hljs-variable">space</span> <span class="hljs-number">139776</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span>   <span class="hljs-number">5</span><span class="hljs-operator">%</span> <span class="hljs-variable">used</span> <span class="hljs-punctuation">[</span><span class="hljs-number">0</span><span class="hljs-variable">x00000007a0000000</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span><span class="hljs-variable">x00000007a08244f0</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span><span class="hljs-variable">x00000007a8880000</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-variable">from</span> <span class="hljs-variable">space</span> <span class="hljs-number">17472</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span>   <span class="hljs-number">0</span><span class="hljs-operator">%</span> <span class="hljs-variable">used</span> <span class="hljs-punctuation">[</span><span class="hljs-number">0</span><span class="hljs-variable">x00000007a8880000</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span><span class="hljs-variable">x00000007a8880000</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span><span class="hljs-variable">x00000007a9990000</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-variable">to</span>   <span class="hljs-variable">space</span> <span class="hljs-number">17472</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span>   <span class="hljs-number">0</span><span class="hljs-operator">%</span> <span class="hljs-variable">used</span> <span class="hljs-punctuation">[</span><span class="hljs-number">0</span><span class="hljs-variable">x00000007a9990000</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span><span class="hljs-variable">x00000007a9990000</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span><span class="hljs-variable">x00000007aaaa0000</span><span class="hljs-punctuation">)</span><br> <span class="hljs-variable">tenured</span> <span class="hljs-variable">generation</span>   <span class="hljs-variable">total</span> <span class="hljs-number">349568</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span> <span class="hljs-variable">used</span> <span class="hljs-number">349274</span><span class="hljs-built_in">K</span> <span class="hljs-punctuation">[</span><span class="hljs-number">0</span><span class="hljs-variable">x00000007aaaa0000</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span><span class="hljs-variable">x00000007c0000000</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span><span class="hljs-variable">x00000007c0000000</span><span class="hljs-punctuation">)</span><br>   <span class="hljs-variable">the</span> <span class="hljs-variable">space</span> <span class="hljs-number">349568</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span>  <span class="hljs-number">99</span><span class="hljs-operator">%</span> <span class="hljs-variable">used</span> <span class="hljs-punctuation">[</span><span class="hljs-number">0</span><span class="hljs-variable">x00000007aaaa0000</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span><span class="hljs-variable">x00000007bffb6998</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span><span class="hljs-variable">x00000007bffb6a00</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span><span class="hljs-variable">x00000007c0000000</span><span class="hljs-punctuation">)</span><br> <span class="hljs-variable">Metaspace</span>       <span class="hljs-variable">used</span> <span class="hljs-number">2571</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span> <span class="hljs-variable">capacity</span> <span class="hljs-number">4486</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span> <span class="hljs-variable">committed</span> <span class="hljs-number">4864</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span> <span class="hljs-variable">reserved</span> <span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><br>  <span class="hljs-variable">class</span> <span class="hljs-variable">space</span>    <span class="hljs-variable">used</span> <span class="hljs-number">276</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span> <span class="hljs-variable">capacity</span> <span class="hljs-number">386</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span> <span class="hljs-variable">committed</span> <span class="hljs-number">512</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span> <span class="hljs-variable">reserved</span> <span class="hljs-number">1048576</span><span class="hljs-built_in">K</span><br></code></pre></td></tr></table></figure>

<p>其中我们不难看出，输出的日志信息一眼看上去简单可以分为三大块，第一个部分是<strong>JVM版本信息和一些执行机器的内存情况</strong>，第二个部分<strong>日志块是JVM的执行参数和日志信息</strong>。最后一个块是<strong>程序结束时堆空间和元数据区的内存使用情况</strong>。来我们先看年轻代的GC日志，下面是我们GC日志中的第二次GC事件。</p>
<h4 id="MinorGC-日志分析"><a href="#MinorGC-日志分析" class="headerlink" title="MinorGC 日志分析"></a>MinorGC 日志分析</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2021</span>-<span class="hljs-number">07</span>-<span class="hljs-number">11</span>T<span class="hljs-number">18</span>:<span class="hljs-number">30</span>:<span class="hljs-number">13</span>.<span class="hljs-number">369</span>-<span class="hljs-number">0800</span>: <br>        <span class="hljs-attribute">0</span>.<span class="hljs-number">217</span>:<span class="hljs-meta"> [GC (Allocation Failure) 2021-07-11T18:30:13.369-0800: </span><br><span class="hljs-meta">        0.217: [DefNew: 157248K-&gt;17471K(157248K), 0.0271936 secs] 185351K-&gt;89018K(506816K), 0.0272786 secs] </span><br><span class="hljs-meta">                 [Times: user=0.01 sys=0.01, real=0.03 secs] </span><br></code></pre></td></tr></table></figure>

<p>从上面的日志信息中可以解读出如下的信息：</p>
<ol>
<li><code>2021-07-11T18:30:13.369-0800</code> GC事件开始的时间点，其中<code>-0800</code>表示当前时区为东八区，这只是一个标识，方便我们直观判断GC发生的时间点。后面的<code>0.217</code> 是GC事件相较于JVM启动事件的间隔，单位是秒。</li>
<li><code>GC</code>用来区分 MinorGC 还是 FullGC 的标志。<code>GC</code>表明这是一次小型GC（Minor GC），即年轻代GC。<code>Allocation Failure</code> 表示触发GC的原因。本次GC事件，是由于对象分配失败，即年轻代中没有空间用来存放新生成的对象引起的。</li>
<li><code>DefNew</code> 表示垃圾收集器的名称。这个名字表示：年轻代使用单线程、标记-复制、STW垃圾收集器。<code>157248K-&gt;17471K</code>表示在垃圾收集之前和只之后的年轻代使用量。<code>(157248K)</code>表示年轻代的总空间大小。进一步分析可知：GC之后年轻代使用率为11%。</li>
<li><code>185351K-&gt;89018K(506816K)</code>表示在垃圾收集之前和之后整个堆内存的使用情况。<code>(506816K)</code>则表示堆内存可以用空间总大小。进一步分析可知：GC之后堆内存使用量为17.5%</li>
<li><code>0.0272786 secs</code> GC事件持续的时间，以秒为单位。</li>
<li><code>[Times: user=0.01 sys=0.01, real=0.03 secs]</code> 此次GC时间的持续时间，通过三个部分衡量：<code>user</code>部分表示所有GC线程消耗的CPU时间；<code>sys</code>部分表示系统调用和系统等待事件消耗的时间。<code>real</code>则表示应用程序暂停的时间。因为串行垃圾收集器（Serial Garbage Collector）只使用单个线程，所以这里 <code>real ~= user + system</code>, 0.03秒也就是30毫秒。</li>
</ol>
<p>就经验而谈，这个暂停时间对大部分系统来说可以接受，但是对于某些延迟敏感的系统来说就是大问题了，就比如你打网络游戏，这30ms的暂停造成的延迟就会让你很难接受。</p>
<p>通过这样的解读我们可以分析JVM在GC时间中的内存使用以及变化情况。在此次垃圾收集之前，对内存总的使用量为<code>185351K</code>，而年轻代的空间使用量为<code>157248K</code>，不难算出老年代已经占用了<code>28103K</code>。当然这些数字中还蕴含更重要的信息：GC前后对比年轻代使用量从<code>157248K-&gt;17471K</code>减少了<code>139777K</code>，而总堆空间大小<code>185351K-&gt;89018K</code>只下降了<code>96333K</code>的内存空间。其中有<code>43444K(139777K-96333K)</code> 对象从年轻代提升到老年代。</p>
<blockquote>
<p>通过这么分析下来，不难看出，我们关注的主要两个数据：<strong>GC暂停时间</strong>，<strong>以及GC之后的内存使用量/使用率</strong>。</p>
</blockquote>
<h4 id="FullGC-日志分析"><a href="#FullGC-日志分析" class="headerlink" title="FullGC 日志分析"></a>FullGC 日志分析</h4><p>前面分析完成MinorGC的日志，我们对GC日志的格式也大致有一个概念了，我们接下来一起看看分析FullGC的日志。</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">13.840</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.688</span><span class="hljs-operator">:</span> <br>        <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">13.840</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.688</span><span class="hljs-operator">:</span> <br>        <span class="hljs-punctuation">[</span><span class="hljs-variable">DefNew</span><span class="hljs-operator">:</span> <span class="hljs-number">139776</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">139776</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">157248</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0000196</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span><br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">11</span><span class="hljs-variable">T18</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-operator">:</span><span class="hljs-number">13.840</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.688</span><span class="hljs-operator">:</span> <br>        <span class="hljs-punctuation">[</span><span class="hljs-variable">Tenured</span><span class="hljs-operator">:</span> <span class="hljs-number">309538</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">298877</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">349568</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0407769</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-number">449314</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">298877</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">506816</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <br>    <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0409461</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>    <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.00</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure>

<p>从上面的日志信息可以解读出这些信息：</p>
<ol>
<li><code>2021-07-11T18:30:13.840-0800</code> GC事件的开始时间。</li>
<li><code>[DefNew: 139776K-&gt;139776K(157248K), 0.0000196 secs]</code> 前面已经解读过这段日志了，因为内存分配失败，发生了一次年轻代GC。此次GC同样使用了 DefNew 收集器。注意：此次垃圾收集器消耗了<code>0.0000196 secs</code>，并且年轻代空间并没有减少，基本上可以确认这次GC事件没怎么处理年轻代。</li>
<li><code>Tenured</code> 用于清理老年代空间的垃圾收集器名称。<code>Tenured</code>表明使用的是单线程的STW垃圾收集器，使用的算法<code>标记-清理-整理（mark-sweep-compact）</code>。<code>309538K-&gt;298877K</code>表示GC前后的堆内存的使用情况，以及老年代的大小。<code>0.0407769 secs</code> 是清理老年代所花的时间。</li>
<li><code>449314K-&gt;298877K(506816K)</code> 在GC前后整个堆内存部分的使用情况，以及可用堆空间大小。</li>
<li><code>[Metaspace: 2565K-&gt;2565K(1056768K)], 0.0409461 secs]</code> Metaspace 空间的变化情况。可以看出，此次GC过程中 Metaspace 也没有变化。</li>
<li><code>[Times: user=0.04 sys=0.00, real=0.04 secs]</code> GC事件的持续事件，分别为<code>user</code>，<code>sys</code>，<code>real</code>三个部分。因为串行垃圾收集器只使用单个线程，所以<code>user + sys = real</code>。这40ms 的暂停挺尸，比前面年轻代的暂停增大了不少，这个时间和什么有关系呢？GC时间，与GC后存活的对象总数量关系最大。</li>
</ol>
<p>进一步分析这些数据，GC之后老年代的使用率为：298877K/349568K～=85.5%，这个比例已经很大了，这次老年代GC仅仅只回收了10661K，老年代触发FullGC但是老年代仅发生少量对象的回收，这个问题很大。同时我们发现和年轻代GC相比，比较明显的是这次GC事件还清理了老年代和Metaspace。</p>
<blockquote>
<p>FullGC, 我们主要关注GC之后内存使用量是否下降，其次关注暂停时间。简单估算，GC后老年代使用量约为350MB，GC耗时40ms左右，如果我们把内存扩大10倍，GC后的老年代也扩大10倍，那么耗时将会达到400ms甚至更高，就会明显影响到系统的吞吐了。这也就是我们说串行性能弱的原因。服务端一般不会使用Serial GC。</p>
</blockquote>
<h3 id="Parallel-GC-日志解读"><a href="#Parallel-GC-日志解读" class="headerlink" title="Parallel GC 日志解读"></a>Parallel GC 日志解读</h3><p>并行的垃圾收集器对年轻代使用<code>标记-复制(mark-copy)</code>算法，对老年代使用<code>标记-清除-整理(mark-sweep-compact)</code>算法。年轻代和老年代的垃圾回收时都会触发STW事件，暂停所有的应用线程，再执行垃圾收集，在执行<code>标记</code>和<code>复制/整理</code>阶段时都使用多个线程。因此得名”Parallel”。通过多个GC线程并行执行的方式，能使JVM在多CPU平台上的GC时间大幅减少。通过命令行参数<code>-XX:ParallelGCThread=N</code>可以指定GC线程的数量，其<strong>默认是CPU内核数量。</strong>下面三组命令是等价的都可以用来指定 ParallelGC</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-XX:+UseParallelGC</span><br><span class="hljs-deletion">-XX:+UseParallelOldGC</span><br><span class="hljs-deletion">-XX:+UseParallelGC -XX:+UseParallelOldGC</span><br></code></pre></td></tr></table></figure>

<p>我们使用下面的命令启动JVM，指定ParallelGC并指定输出gc日志。</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-XX:+UseParallelGC -Xmx512m -Xms512m -Xloggc:gc.log </span><br><span class="hljs-deletion">-XX:+PrintGCDetails -XX:+PrintGCDateStamps</span><br></code></pre></td></tr></table></figure>

<p>行垃圾收集器会适用于多核服务器，其主要目标是增加系统吞吐量（也就是降低GC总体消耗的时间）。为了达成这个目标，会尽量使用尽可能多的CPU资源：</p>
<ul>
<li><strong>在GC事件执行期间，所有CPU内核都在并行地清理垃圾，所以暂停时间相对来说更短。</strong></li>
<li><strong>在两次GC事件中间的间隙期，不会启动GC线程，所以这段事件内不会消耗任何系统资源。</strong></li>
</ul>
<p>另一方面，因为并行GC的所有阶段都是不能中断，所以并行GC很可能会出现长时间的卡顿。因为GC期间应用线程是被暂停的。如果单次暂停时间比较长对延迟要求很高，应该选择其他的垃圾收集器。下面是一段并行GC的日志。</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-variable">Java</span> <span class="hljs-variable">HotSpot</span><span class="hljs-punctuation">(</span><span class="hljs-variable">TM</span><span class="hljs-punctuation">)</span> <span class="hljs-number">64</span><span class="hljs-operator">-</span><span class="hljs-variable">Bit</span> <span class="hljs-variable">Server</span> <span class="hljs-variable">VM</span> <span class="hljs-punctuation">(</span><span class="hljs-number">25.231</span><span class="hljs-operator">-</span><span class="hljs-variable">b11</span><span class="hljs-punctuation">)</span> <span class="hljs-variable">for</span> <span class="hljs-variable">bsd</span><span class="hljs-operator">-</span><span class="hljs-variable">amd64</span> <span class="hljs-variable">JRE</span> <span class="hljs-punctuation">(</span><span class="hljs-number">1.8</span><span class="hljs-number">.0</span><span class="hljs-type">_</span><span class="hljs-number">231</span><span class="hljs-operator">-</span><span class="hljs-variable">b11</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-variable">built</span> <span class="hljs-variable">on</span> <span class="hljs-variable">Oct</span>  <span class="hljs-number">5</span> <span class="hljs-number">2019</span> <span class="hljs-number">03</span><span class="hljs-operator">:</span><span class="hljs-number">15</span><span class="hljs-operator">:</span><span class="hljs-number">25</span> <span class="hljs-variable">by</span> <span class="hljs-string">&quot;java_re&quot;</span> <span class="hljs-variable">with</span> <span class="hljs-variable">gcc</span> <span class="hljs-number">4.2</span><span class="hljs-number">.1</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Based</span> <span class="hljs-variable">on</span> <span class="hljs-variable">Apple</span> <span class="hljs-variable">Inc</span><span class="hljs-operator">.</span> <span class="hljs-variable">build</span> <span class="hljs-number">5658</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">LLVM</span> <span class="hljs-variable">build</span> <span class="hljs-number">2336.11</span><span class="hljs-number">.00</span><span class="hljs-punctuation">)</span><br><span class="hljs-variable">Memory</span><span class="hljs-operator">:</span> <span class="hljs-number">4</span><span class="hljs-variable">k</span> <span class="hljs-variable">page</span><span class="hljs-operator">,</span> <span class="hljs-variable">physical</span> <span class="hljs-number">16777216</span><span class="hljs-variable">k</span><span class="hljs-punctuation">(</span><span class="hljs-number">589368</span><span class="hljs-variable">k</span> <span class="hljs-variable">free</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-operator">/</span><span class="hljs-variable">proc</span><span class="hljs-operator">/</span><span class="hljs-variable">meminfo</span><span class="hljs-operator">:</span><br><br><span class="hljs-variable">CommandLine</span> <span class="hljs-variable">flags</span><span class="hljs-operator">:</span> <span class="hljs-operator">-</span><span class="hljs-variable">XX</span><span class="hljs-operator">:</span><span class="hljs-variable">InitialHeapSize</span><span class="hljs-operator">=</span><span class="hljs-number">536870912</span> <span class="hljs-operator">-</span><span class="hljs-variable">XX</span><span class="hljs-operator">:</span><span class="hljs-variable">MaxHeapSize</span><span class="hljs-operator">=</span><span class="hljs-number">536870912</span> <span class="hljs-operator">-</span><span class="hljs-variable">XX</span><span class="hljs-operator">:+</span><span class="hljs-variable">PrintGC</span> <span class="hljs-operator">-</span><span class="hljs-variable">XX</span><span class="hljs-operator">:+</span><span class="hljs-variable">PrintGCDateStamps</span> <span class="hljs-operator">-</span><span class="hljs-variable">XX</span><span class="hljs-operator">:+</span><span class="hljs-variable">PrintGCDetails</span> <span class="hljs-operator">-</span><span class="hljs-variable">XX</span><span class="hljs-operator">:+</span><span class="hljs-variable">PrintGCTimeStamps</span> <span class="hljs-operator">-</span><span class="hljs-variable">XX</span><span class="hljs-operator">:+</span><span class="hljs-variable">UseCompressedClassPointers</span> <span class="hljs-operator">-</span><span class="hljs-variable">XX</span><span class="hljs-operator">:+</span><span class="hljs-variable">UseCompressedOops</span> <span class="hljs-operator">-</span><span class="hljs-variable">XX</span><span class="hljs-operator">:+</span><span class="hljs-variable">UseParallelGC</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">11.646</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.126</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">131584</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">21502</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">153088</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">131584</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">47819</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">502784</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0115940</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.02</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.05</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">11.676</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.156</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">153086</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">21497</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">153088</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">179403</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">91591</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">502784</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0159088</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.03</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.07</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.02</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">11.707</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.188</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">153081</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">21500</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">153088</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">223175</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">131269</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">502784</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0127081</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.02</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">11.736</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.216</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">153084</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">21503</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">153088</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">262853</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">177469</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">502784</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0151634</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.06</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.02</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">11.766</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.247</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">152950</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">21488</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">153088</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">308916</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">218539</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">502784</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0144377</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.03</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.06</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.02</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">11.797</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.277</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">152645</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">21497</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">80384</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">349697</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">259325</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">430080</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0132490</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.03</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.02</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">11.818</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.298</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">79609</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">36259</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">116736</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">317437</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">280306</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">466432</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0053558</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.03</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">11.833</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.313</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">95139</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">47999</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">116736</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">339186</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">298252</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">466432</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0076742</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">11.848</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.329</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">106879</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">57817</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">116736</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">357132</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">316937</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">466432</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0094228</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.05</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">11.866</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.347</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">116697</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">40221</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">116736</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">375817</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">335350</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">466432</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0127900</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.05</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">11.879</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.360</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">40221</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">0</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">116736</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">295129</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">240839</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">349696</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">335350</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">240839</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">466432</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0331005</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.21</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">11.922</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.402</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">58315</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">21801</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">116736</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">299155</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">262641</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">466432</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0018162</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.00</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.00</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-operator">......</span><br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">16.041</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">4.521</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">58880</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">22595</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">116736</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">349642</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">349114</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">349696</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">408522</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">371709</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">466432</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0395122</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.24</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.00</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">16.086</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">4.567</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">58714</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">26618</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">116736</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">349114</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">349513</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">349696</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">407828</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">376131</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">466432</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0603584</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.20</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.00</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.06</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">16.152</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">4.632</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">58880</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">21695</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">116736</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">349513</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">349492</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">349696</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">408393</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">371188</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">466432</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0389743</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.20</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">16.198</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">4.678</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">58739</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">20467</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">116736</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">349492</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">349172</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">349696</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">408231</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">369639</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">466432</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0382426</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.22</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.00</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">16.242</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">4.723</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">58634</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">15899</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">116736</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">349172</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">349690</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">349696</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">407806</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">365590</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">466432</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0375539</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.22</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.00</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">16.288</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">4.768</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">58880</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">17101</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">116736</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">349690</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">349416</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">349696</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">408570</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">366517</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">466432</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0399298</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.20</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.00</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">16.335</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">4.816</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">58765</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">15555</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">116736</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">349416</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">349180</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">349696</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">408182</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">364736</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">466432</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0380655</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.21</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">16.381</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">4.861</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">58681</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">18582</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">116736</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">349180</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">349211</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">349696</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">407862</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">367794</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">466432</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0398334</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.23</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.00</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">16.429</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">4.909</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">58773</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">16686</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">116736</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">349211</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">349040</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">349696</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">407985</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">365727</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">466432</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0384315</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.20</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.00</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">16.474</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">4.955</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">58872</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">17929</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">116736</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">349040</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">349562</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">349696</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">407913</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">367492</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">466432</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0397868</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.22</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">16.522</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">5.002</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">58877</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">15917</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">116736</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">349562</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">349348</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">349696</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">408440</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">365266</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">466432</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0391023</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.22</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.00</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">16.571</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">5.051</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <br><span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">58597</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">17423</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">116736</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">349348</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">349274</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">349696</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">407945</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">366698</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">466432</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0379030</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.21</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.00</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.03</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-variable">Heap</span><br> <span class="hljs-variable">PSYoungGen</span>      <span class="hljs-variable">total</span> <span class="hljs-number">116736</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span> <span class="hljs-variable">used</span> <span class="hljs-number">19718</span><span class="hljs-built_in">K</span> <span class="hljs-punctuation">[</span><span class="hljs-number">0</span><span class="hljs-variable">x00000007b5580000</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span><span class="hljs-variable">x00000007c0000000</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span><span class="hljs-variable">x00000007c0000000</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-variable">eden</span> <span class="hljs-variable">space</span> <span class="hljs-number">58880</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span> <span class="hljs-number">33</span><span class="hljs-operator">%</span> <span class="hljs-variable">used</span> <span class="hljs-punctuation">[</span><span class="hljs-number">0</span><span class="hljs-variable">x00000007b5580000</span><span class="hljs-operator">,</span><span class="hljs-number">0</span><span class="hljs-variable">x00000007b68c1a00</span><span class="hljs-operator">,</span><span class="hljs-number">0</span><span class="hljs-variable">x00000007b8f00000</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-variable">from</span> <span class="hljs-variable">space</span> <span class="hljs-number">57856</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span><span class="hljs-operator">%</span> <span class="hljs-variable">used</span> <span class="hljs-punctuation">[</span><span class="hljs-number">0</span><span class="hljs-variable">x00000007b8f00000</span><span class="hljs-operator">,</span><span class="hljs-number">0</span><span class="hljs-variable">x00000007b8f00000</span><span class="hljs-operator">,</span><span class="hljs-number">0</span><span class="hljs-variable">x00000007bc780000</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-variable">to</span>   <span class="hljs-variable">space</span> <span class="hljs-number">57856</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span><span class="hljs-operator">%</span> <span class="hljs-variable">used</span> <span class="hljs-punctuation">[</span><span class="hljs-number">0</span><span class="hljs-variable">x00000007bc780000</span><span class="hljs-operator">,</span><span class="hljs-number">0</span><span class="hljs-variable">x00000007bc780000</span><span class="hljs-operator">,</span><span class="hljs-number">0</span><span class="hljs-variable">x00000007c0000000</span><span class="hljs-punctuation">)</span><br> <span class="hljs-variable">ParOldGen</span>       <span class="hljs-variable">total</span> <span class="hljs-number">349696</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span> <span class="hljs-variable">used</span> <span class="hljs-number">349274</span><span class="hljs-built_in">K</span> <span class="hljs-punctuation">[</span><span class="hljs-number">0</span><span class="hljs-variable">x00000007a0000000</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span><span class="hljs-variable">x00000007b5580000</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span><span class="hljs-variable">x00000007b5580000</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-variable">object</span> <span class="hljs-variable">space</span> <span class="hljs-number">349696</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span> <span class="hljs-number">99</span><span class="hljs-operator">%</span> <span class="hljs-variable">used</span> <span class="hljs-punctuation">[</span><span class="hljs-number">0</span><span class="hljs-variable">x00000007a0000000</span><span class="hljs-operator">,</span><span class="hljs-number">0</span><span class="hljs-variable">x00000007b5516a00</span><span class="hljs-operator">,</span><span class="hljs-number">0</span><span class="hljs-variable">x00000007b5580000</span><span class="hljs-punctuation">)</span><br> <span class="hljs-variable">Metaspace</span>       <span class="hljs-variable">used</span> <span class="hljs-number">2571</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span> <span class="hljs-variable">capacity</span> <span class="hljs-number">4486</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span> <span class="hljs-variable">committed</span> <span class="hljs-number">4864</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span> <span class="hljs-variable">reserved</span> <span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><br>  <span class="hljs-variable">class</span> <span class="hljs-variable">space</span>    <span class="hljs-variable">used</span> <span class="hljs-number">276</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span> <span class="hljs-variable">capacity</span> <span class="hljs-number">386</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span> <span class="hljs-variable">committed</span> <span class="hljs-number">512</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span> <span class="hljs-variable">reserved</span> <span class="hljs-number">1048576</span><span class="hljs-built_in">K</span><br></code></pre></td></tr></table></figure>

<p>我们可以看到到ParallelGC 的GC日志和Serial GC 的日志大体结构是一致的，下面是MinorGC 的日志分析。</p>
<h4 id="MinorGC-日志分析-1"><a href="#MinorGC-日志分析-1" class="headerlink" title="MinorGC 日志分析"></a>MinorGC 日志分析</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">11.676</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.156</span><span class="hljs-operator">:</span> <br>        <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <br>        <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">153086</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">21497</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">153088</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">179403</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">91591</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">502784</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0159088</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>    <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.03</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.07</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.02</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br></code></pre></td></tr></table></figure>

<p>日志解读如下：</p>
<ol>
<li><code>2021-07-14T00:42:11.676-0800: 0.156</code> GC事件开始事件。</li>
<li><code>GC</code>用来区分MinorGC还是FullGC的标志，这里是一个次小型GC（MinorGC）。</li>
<li><code>PSYoungGen</code> 垃圾收集器名称。这个名字表示的是在年轻代中使用：并行GC的<code>标记-复制(mark-copy)</code>，全线暂停(STW)垃圾收集器。<code>153086K-&gt;21497K(153088K)</code> 则是GC前后年轻代的使用量，以及年轻代的总大小，简单计算可以得出GC后年轻代的使用率<code>21497K/153088K～=14%</code>。</li>
<li><code>179403K-&gt;91591K(502784K)</code> 则是GC前后堆空间的使用量，已经可用堆的总大小，GC后堆空间的使用率为<code>91591K/502784K～=18.2%</code>，由于这个GC事件发生在JVM刚启动，创建的对象并不多。这个使用量还算是健康的。</li>
<li><code>[Times: user=0.03 sys=0.07, real=0.02 secs]</code> GC事件的持续事件，通过三个部分衡量：<code>user</code>表示GC线程所消耗的总CPU时间，<code>sys</code>表示操作系统调用和系统等待事件所消耗的事件。<code>real</code>则表示应用程序实际消耗的时间。因为不是并不是所有的操作的过程都能全部并行，所有在ParallelGC中，<code>real～=(user+ system)/GC线程数</code>。</li>
</ol>
<p>通过这部分日志我们可以简单计算出：在GC之前，堆内存总使用量为<code>179403K</code>，其中年轻代为<code>153086K</code>，那么老年代的使用量为<code>179403K-153086K=26319K</code>这并不多，但是这是JVM的第二次GC时间，有一部分对象已经在第一次GC完成后直接被晋升进了老年代。在这次GC完成后年轻代减少了<code>153086K-21497K=131589K</code>，总堆减少了<code>179403K-91591K=87812K</code>，其中有<code>131589K-87812K=43777K</code>被提升到了老年代。老年代的总大小为<code>502784K-153088K=349696K</code>，当前老年代使用率为<code>(91591K-21497K)/349696K~=20%</code>。</p>
<blockquote>
<p>年轻代GC，我们可以关注业务暂停时间，以及GC后内存的使用率是否正常，<strong>但不用特别关注GC前的使用量，而且只要业务在运行，年轻代的对象分配就少不了，回收量也不会少。</strong></p>
</blockquote>
<h4 id="FullGC-日志分析-1"><a href="#FullGC-日志分析-1" class="headerlink" title="FullGC 日志分析"></a>FullGC 日志分析</h4><p>前面介绍了并行GC的年轻代的GC日志，下面我们看看老年代的GC日志。</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">14</span><span class="hljs-variable">T00</span><span class="hljs-operator">:</span><span class="hljs-number">42</span><span class="hljs-operator">:</span><span class="hljs-number">16.571</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">5.051</span><span class="hljs-operator">:</span> <br>            <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <br>            <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">58597</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">17423</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">116736</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <br>            <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">349348</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">349274</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">349696</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">407945</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">366698</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">466432</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <br>      <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2565</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0379030</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>      <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.21</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.00</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.03</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br></code></pre></td></tr></table></figure>

<p>在上面的日志中我们可以分析出以下的一些信息：</p>
<ol>
<li><code>2021-07-14T00:42:16.571-0800:</code> GC事件开始事件。</li>
<li><code>Full GC</code> 一次fullGC的标识，FullGC 表明本次GC事件清理老年代和年轻代，<code>Ergonomics</code> 是触发GC的原因，表示JVM内部环境认为此时可以进行一次垃圾收集。</li>
<li><code>[PSYoungGen: 58597K-&gt;17423K(116736K)]</code> 和上面的示例一样，清理年轻代的垃圾收集气是名为“PSYoungGen”的STW收集器，采用<code>标记-复制(mark-copy)</code>算法。年轻代使用量从<code>58597K</code>变为<code>17423K</code>，这里值得注意的是年轻代在fullGC之后并没有被清空，而是保留了部分的对象。因为这条GC日志是JVM执行后期的日志，其中老年代已经被塞的很满，不能支持这么多对象晋升。</li>
<li><code>ParOldGen</code>用于清理老年代空间的垃圾收集器类型。这里的使用的是 ParOldGen 的垃圾收集器，这是一款并行STW垃圾收集器，算法为<code>标记-清除-整理(mark-sweep-compact)</code>。简单计算下，GC之前老年代的使用率为 <code>349348K/349696K～=99.9%</code>，GC之后的老年代使用率为<code>349274K/349696K～=99.8%</code>，我们不难发现，fullGC并没有回收多少的内存，在这个阶段JVM在不断的进行垃圾回收，系统已经处于不可用的状态。</li>
<li><code>407945K-&gt;366698K(466432K)</code> 在垃圾收集之前和之后的堆内存的使用情况，以及可用堆内容总容量。简单分析可以知道，GC之前堆内存的使用率为：<code>407945K/466432K～=87.5%</code>，GC之后的堆内存为：<code>366698K/466432K～=78.6%</code></li>
<li><code>[Metaspace: 2565K-&gt;2565K(1056768K)]</code>前面我们也看到了关于Metaspace 空间类似的信息，可以看出，在GC事件中Metaspace 里面没有回收任何对象。</li>
<li><code>0.0379030 secs</code> GC事件的持续时间，以秒为单位。其中<code>[Times: user=0.21 sys=0.00, real=0.03 secs]</code>这也是GC的持续时间，<code>user + sys &gt; real</code>这是多线程执行的结果。同时这里约等于是7倍，而我的机器是4核8线程的，<strong>因为总有一定比例是不能并行执行的。</strong></li>
</ol>
<blockquote>
<p>FullGC 时我们<strong>更关注老年代的使用量有没有下降，以及下降了多少</strong>。如果FullGC之后内存不怎么下降，使用率还是很高，那就说明系统有问题了（就像我们的测试的系统一样）。</p>
</blockquote>
<h3 id="CMS-日志解读"><a href="#CMS-日志解读" class="headerlink" title="CMS 日志解读"></a>CMS 日志解读</h3><p>CMS也可以称为<code>并发标记清除垃圾收集器</code>。其设计目的是避免老年代GC时出现长时间的卡顿。默认情况下，CMS 使用的并发线程等于CPU内核数的<code>1/4</code>。如果CPU资源受限，CMS的吞吐量会比ParallelGC，我们可以通过下面的选项指定CMS垃圾收集器，并将日志输出到gc.log</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-XX:+UseConcMarkSweepGC -Xms512m -Xmx512m -Xloggc:gc.log </span><br><span class="hljs-deletion">-XX:+PrintGCDetails -XX:+PrintGCDateStamps</span><br></code></pre></td></tr></table></figure>

<p>和前面分析的串行GC和并行GC一样，我们将程序启动起来，看看CMS的GC日志和前面的日志有什么不一样。</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs dns">Java HotSpot(TM) <span class="hljs-number">64</span>-Bit Server VM (<span class="hljs-number">25</span>.<span class="hljs-number">231</span>-b11) for bsd-amd64 JRE (<span class="hljs-number">1.8.0_231</span>-b11), built on Oct  <span class="hljs-number">5 2019 03</span>:<span class="hljs-number">15</span>:<span class="hljs-number">25</span> by &quot;java_re&quot; with gcc <span class="hljs-number">4</span>.<span class="hljs-number">2</span>.<span class="hljs-number">1</span> (Based on Apple Inc. build <span class="hljs-number">5658</span>) (LLVM build <span class="hljs-number">2336.11.00</span>)<br>Memory: <span class="hljs-number">4</span>k page, physical <span class="hljs-number">16777216</span>k(<span class="hljs-number">395052</span>k free)<br><br>/proc/meminfo:<br><br>CommandLine flags: -XX:InitialHeapSize=<span class="hljs-number">536870912</span> -XX:MaxHeapSize=<span class="hljs-number">536870912</span> -XX:MaxNewSize=<span class="hljs-number">178958336</span> -XX:MaxTenuringThreshold=<span class="hljs-number">6</span> -XX:NewSize=<span class="hljs-number">178958336</span> -XX:OldPLABSize=<span class="hljs-number">16</span> -XX:OldSize=<span class="hljs-number">357912576</span> -XX:+PrintGC -XX:+PrintGCDateStamps -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+UseCompressedClassPointers -XX:+UseCompressedOops -XX:+UseConcMarkSweepGC -XX:+UseParNewGC <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">03</span>.<span class="hljs-number">885-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">177</span>: [GC (Allocation Failure) <span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">03</span>.<span class="hljs-number">885-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">177</span>: [ParNew: <span class="hljs-number">139776</span>K-&gt;<span class="hljs-number">17471</span>K(<span class="hljs-number">157248</span>K), <span class="hljs-number">0.0140477</span> secs] <span class="hljs-number">139776</span>K-&gt;<span class="hljs-number">46305</span>K(<span class="hljs-number">506816</span>K), <span class="hljs-number">0.0142076</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">03</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">06</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">01</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">03</span>.<span class="hljs-number">919-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">211</span>: [GC (Allocation Failure) <span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">03</span>.<span class="hljs-number">920-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">212</span>: [ParNew: <span class="hljs-number">157247</span>K-&gt;<span class="hljs-number">17466</span>K(<span class="hljs-number">157248</span>K), <span class="hljs-number">0.0156764</span> secs] <span class="hljs-number">186081</span>K-&gt;<span class="hljs-number">88855</span>K(<span class="hljs-number">506816</span>K), <span class="hljs-number">0.0157774</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">04</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">06</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">02</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">03</span>.<span class="hljs-number">953-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">245</span>: [GC (Allocation Failure) <span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">03</span>.<span class="hljs-number">953-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">245</span>: [ParNew: <span class="hljs-number">156977</span>K-&gt;<span class="hljs-number">17471</span>K(<span class="hljs-number">157248</span>K), <span class="hljs-number">0.0246946</span> secs] <span class="hljs-number">228367</span>K-&gt;<span class="hljs-number">132415</span>K(<span class="hljs-number">506816</span>K), <span class="hljs-number">0.0247922</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">17</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">01</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">02</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">03</span>.<span class="hljs-number">995-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">287</span>: [GC (Allocation Failure) <span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">03</span>.<span class="hljs-number">995-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">287</span>: [ParNew: <span class="hljs-number">157247</span>K-&gt;<span class="hljs-number">17470</span>K(<span class="hljs-number">157248</span>K), <span class="hljs-number">0.0201253</span> secs] <span class="hljs-number">272191</span>K-&gt;<span class="hljs-number">170226</span>K(<span class="hljs-number">506816</span>K), <span class="hljs-number">0.0202300</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">14</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">01</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">02</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">031-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">323</span>: [GC (Allocation Failure) <span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">031-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">323</span>: [ParNew: <span class="hljs-number">157246</span>K-&gt;<span class="hljs-number">17472</span>K(<span class="hljs-number">157248</span>K), <span class="hljs-number">0.0231496</span> secs] <span class="hljs-number">310002</span>K-&gt;<span class="hljs-number">211673</span>K(<span class="hljs-number">506816</span>K), <span class="hljs-number">0.0232433</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">15</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">02</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">02</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">054-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">346</span>: [GC (CMS Initial Mark) [<span class="hljs-number">1</span> CMS-initial-mark: <span class="hljs-number">194201</span>K(<span class="hljs-number">349568</span>K)] <span class="hljs-number">211961</span>K(<span class="hljs-number">506816</span>K), <span class="hljs-number">0.0002540</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">054-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">346</span>: [CMS-concurrent-mark-start]<br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">056-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">348</span>: [CMS-concurrent-mark: <span class="hljs-number">0.002/0</span>.<span class="hljs-number">002</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">056-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">348</span>: [CMS-concurrent-preclean-start]<br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">057-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">349</span>: [CMS-concurrent-preclean: <span class="hljs-number">0.000/0</span>.<span class="hljs-number">000</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">057-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">349</span>: [CMS-concurrent-abortable-preclean-start]<br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">071-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">363</span>: [GC (Allocation Failure) <span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">071-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">363</span>: [ParNew: <span class="hljs-number">157248</span>K-&gt;<span class="hljs-number">17470</span>K(<span class="hljs-number">157248</span>K), <span class="hljs-number">0.0241859</span> secs] <span class="hljs-number">351449</span>K-&gt;<span class="hljs-number">252404</span>K(<span class="hljs-number">506816</span>K), <span class="hljs-number">0.0242841</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">15</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">01</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">02</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04.110-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">402</span>: [GC (Allocation Failure) <span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04.110-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">402</span>: [ParNew: <span class="hljs-number">157246</span>K-&gt;<span class="hljs-number">17469</span>K(<span class="hljs-number">157248</span>K), <span class="hljs-number">0.0263702</span> secs] <span class="hljs-number">392180</span>K-&gt;<span class="hljs-number">298543</span>K(<span class="hljs-number">506816</span>K), <span class="hljs-number">0.0264666</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">16</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">01</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">02</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04.151-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">443</span>: [GC (Allocation Failure) <span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04.151-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">443</span>: [ParNew: <span class="hljs-number">157245</span>K-&gt;<span class="hljs-number">17471</span>K(<span class="hljs-number">157248</span>K), <span class="hljs-number">0.0225189</span> secs] <span class="hljs-number">438319</span>K-&gt;<span class="hljs-number">339365</span>K(<span class="hljs-number">506816</span>K), <span class="hljs-number">0.0226134</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">14</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">01</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">02</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04.187-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">479</span>: [GC (Allocation Failure) <span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04.187-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">479</span>: [ParNew: <span class="hljs-number">157247</span>K-&gt;<span class="hljs-number">157247</span>K(<span class="hljs-number">157248</span>K), <span class="hljs-number">0.0000202</span> secs]<span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04.187-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">479</span>: [CMS20<span class="hljs-number">21-07-15T01</span>:<span class="hljs-number">04:04.187</span>-<span class="hljs-number">0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">479</span>: [CMS-concurrent-abortable-preclean: <span class="hljs-number">0.004/0</span>.<span class="hljs-number">130</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">53</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">04</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">13</span> secs] <br> (concurrent mode failure): <span class="hljs-number">321893</span>K-&gt;<span class="hljs-number">251462</span>K(<span class="hljs-number">349568</span>K), <span class="hljs-number">0.0517382</span> secs] <span class="hljs-number">479141</span>K-&gt;<span class="hljs-number">251462</span>K(<span class="hljs-number">506816</span>K), [Metaspace: <span class="hljs-number">2565</span>K-&gt;<span class="hljs-number">2565</span>K(<span class="hljs-number">1056768</span>K)], <span class="hljs-number">0.0518718</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">05</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">01</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">05</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">256-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">548</span>: [GC (Allocation Failure) <span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">256-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">548</span>: [ParNew: <span class="hljs-number">139630</span>K-&gt;<span class="hljs-number">17468</span>K(<span class="hljs-number">157248</span>K), <span class="hljs-number">0.0062663</span> secs] <span class="hljs-number">391093</span>K-&gt;<span class="hljs-number">300508</span>K(<span class="hljs-number">506816</span>K), <span class="hljs-number">0.0063611</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">05</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">01</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">262-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">554</span>: [GC (CMS Initial Mark) [<span class="hljs-number">1</span> CMS-initial-mark: <span class="hljs-number">283040</span>K(<span class="hljs-number">349568</span>K)] <span class="hljs-number">303587</span>K(<span class="hljs-number">506816</span>K), <span class="hljs-number">0.0001363</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">262-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">554</span>: [CMS-concurrent-mark-start]<br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">263-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">555</span>: [CMS-concurrent-mark: <span class="hljs-number">0.001/0</span>.<span class="hljs-number">001</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">263-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">555</span>: [CMS-concurrent-preclean-start]<br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">264-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">556</span>: [CMS-concurrent-preclean: <span class="hljs-number">0.000/0</span>.<span class="hljs-number">000</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">264-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">556</span>: [CMS-concurrent-abortable-preclean-start]<br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">277-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">569</span>: [GC (Allocation Failure) <span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">277-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">569</span>: [ParNew: <span class="hljs-number">157244</span>K-&gt;<span class="hljs-number">17471</span>K(<span class="hljs-number">157248</span>K), <span class="hljs-number">0.0094558</span> secs] <span class="hljs-number">440284</span>K-&gt;<span class="hljs-number">344562</span>K(<span class="hljs-number">506816</span>K), <span class="hljs-number">0.0095346</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">07</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">01</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">287-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">579</span>: [CMS-concurrent-abortable-preclean: <span class="hljs-number">0.001/0</span>.<span class="hljs-number">024</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">09</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">02</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">287-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">579</span>: [GC (CMS Final Remark) [YG occupancy: <span class="hljs-number">27558</span> K (<span class="hljs-number">157248</span> K)]<span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">288-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">579</span>: [Rescan (parallel) , <span class="hljs-number">0.0002901</span> secs]<span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">288-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">580</span>: [weak refs processing, <span class="hljs-number">0.0000103</span> secs]<span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">288-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">580</span>: [class unloading, <span class="hljs-number">0.0001973</span> secs]<span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">288-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">580</span>: [scrub symbol table, <span class="hljs-number">0.0002563</span> secs]<span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">288-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">580</span>: [scrub string table, <span class="hljs-number">0.0001485</span> secs][<span class="hljs-number">1</span> CMS-remark: <span class="hljs-number">327091</span>K(<span class="hljs-number">349568</span>K)] <span class="hljs-number">354649</span>K(<span class="hljs-number">506816</span>K), <span class="hljs-number">0.0009506</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">289-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">580</span>: [CMS-concurrent-sweep-start]<br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">289-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">581</span>: [CMS-concurrent-sweep: <span class="hljs-number">0.000/0</span>.<span class="hljs-number">000</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">01</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">289-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">581</span>: [CMS-concurrent-reset-start]<br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">04</span>.<span class="hljs-number">289-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">581</span>: [CMS-concurrent-reset: <span class="hljs-number">0.000/0</span>.<span class="hljs-number">000</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> secs] <br>......<br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">774-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">066</span>: [GC (CMS Initial Mark) [<span class="hljs-number">1</span> CMS-initial-mark: <span class="hljs-number">349310</span>K(<span class="hljs-number">349568</span>K)] <span class="hljs-number">372830</span>K(<span class="hljs-number">506816</span>K), <span class="hljs-number">0.0002245</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">774-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">066</span>: [CMS-concurrent-mark-start]<br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">775-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">067</span>: [CMS-concurrent-mark: <span class="hljs-number">0.001/0</span>.<span class="hljs-number">001</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">775-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">067</span>: [CMS-concurrent-preclean-start]<br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">777-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">069</span>: [CMS-concurrent-preclean: <span class="hljs-number">0.001/0</span>.<span class="hljs-number">001</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">777-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">069</span>: [CMS-concurrent-abortable-preclean-start]<br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">777-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">069</span>: [CMS-concurrent-abortable-preclean: <span class="hljs-number">0.000/0</span>.<span class="hljs-number">000</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">777-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">069</span>: [GC (CMS Final Remark) [YG occupancy: <span class="hljs-number">42054</span> K (<span class="hljs-number">157248</span> K)]<span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">777-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">069</span>: [Rescan (parallel) , <span class="hljs-number">0.0003608</span> secs]<span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">777-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">069</span>: [weak refs processing, <span class="hljs-number">0.0000184</span> secs]<span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">777-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">069</span>: [class unloading, <span class="hljs-number">0.0002228</span> secs]<span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">778-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">070</span>: [scrub symbol table, <span class="hljs-number">0.0003110</span> secs]<span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">778-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">070</span>: [scrub string table, <span class="hljs-number">0.0002060</span> secs][<span class="hljs-number">1</span> CMS-remark: <span class="hljs-number">349310</span>K(<span class="hljs-number">349568</span>K)] <span class="hljs-number">391364</span>K(<span class="hljs-number">506816</span>K), <span class="hljs-number">0.0012004</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">01</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">778-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">070</span>: [CMS-concurrent-sweep-start]<br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">779-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">071</span>: [CMS-concurrent-sweep: <span class="hljs-number">0.000/0</span>.<span class="hljs-number">000</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">779-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">071</span>: [CMS-concurrent-reset-start]<br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">779-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">071</span>: [CMS-concurrent-reset: <span class="hljs-number">0.000/0</span>.<span class="hljs-number">000</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">794-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">086</span>: [GC (Allocation Failure) <span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">794-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">086</span>: [ParNew: <span class="hljs-number">157145</span>K-&gt;<span class="hljs-number">157145</span>K(<span class="hljs-number">157248</span>K), <span class="hljs-number">0.0000216</span> secs]<span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">794-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">086</span>: [CMS: <span class="hljs-number">349018</span>K-&gt;<span class="hljs-number">349462</span>K(<span class="hljs-number">349568</span>K), <span class="hljs-number">0.0484635</span> secs] <span class="hljs-number">506163</span>K-&gt;<span class="hljs-number">363671</span>K(<span class="hljs-number">506816</span>K), [Metaspace: <span class="hljs-number">2565</span>K-&gt;<span class="hljs-number">2565</span>K(<span class="hljs-number">1056768</span>K)], <span class="hljs-number">0.0485969</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">05</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">05</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">843-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">135</span>: [GC (CMS Initial Mark) [<span class="hljs-number">1</span> CMS-initial-mark: <span class="hljs-number">349462</span>K(<span class="hljs-number">349568</span>K)] <span class="hljs-number">363959</span>K(<span class="hljs-number">506816</span>K), <span class="hljs-number">0.0001943</span> secs] [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">843-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">135</span>: [CMS-concurrent-mark-start]<br>Heap<br> par new generation   total <span class="hljs-number">157248</span>K, used <span class="hljs-number">19849</span>K [<span class="hljs-number">0</span>x000000<span class="hljs-number">07a0000000</span>, <span class="hljs-number">0</span>x00000007aaaa0000, <span class="hljs-number">0</span>x00000007aaaa0000)<br>  eden space <span class="hljs-number">139776</span>K,  <span class="hljs-number">14</span>% used [<span class="hljs-number">0</span>x000000<span class="hljs-number">07a0000000</span>, <span class="hljs-number">0</span>x000000<span class="hljs-number">07a13627d0</span>, <span class="hljs-number">0</span>x000000<span class="hljs-number">07a8880000</span>)<br>  from space <span class="hljs-number">17472</span>K,   <span class="hljs-number">0</span>% used [<span class="hljs-number">0</span>x000000<span class="hljs-number">07a9990000</span>, <span class="hljs-number">0</span>x000000<span class="hljs-number">07a9990000</span>, <span class="hljs-number">0</span>x00000007aaaa0000)<br>  to   space <span class="hljs-number">17472</span>K,   <span class="hljs-number">0</span>% used [<span class="hljs-number">0</span>x000000<span class="hljs-number">07a8880000</span>, <span class="hljs-number">0</span>x000000<span class="hljs-number">07a8880000</span>, <span class="hljs-number">0</span>x000000<span class="hljs-number">07a9990000</span>)<br> concurrent mark-sweep generation total <span class="hljs-number">349568</span>K, used <span class="hljs-number">349462</span>K [<span class="hljs-number">0</span>x00000007aaaa0000, <span class="hljs-number">0</span>x000000<span class="hljs-number">07c0000000</span>, <span class="hljs-number">0</span>x000000<span class="hljs-number">07c0000000</span>)<br> Metaspace       used <span class="hljs-number">2571</span>K, capacity <span class="hljs-number">4486</span>K, committed <span class="hljs-number">4864</span>K, reserved <span class="hljs-number">1056768</span>K<br>  class space    used <span class="hljs-number">276</span>K, capacity <span class="hljs-number">386</span>K, committed <span class="hljs-number">512</span>K, reserved <span class="hljs-number">1048576</span>K<br></code></pre></td></tr></table></figure>

<p>以上是CMS的一部分GC日志，相比于串行GC/并行GC来说，CMS 的日志信息复杂了很多，这一方面是因为CMS拥有更加精细的GC步骤，另一方面GC日志很详细就意味着暴露出来的问题也更加全面细致。</p>
<h4 id="MinorGC-日志分析-2"><a href="#MinorGC-日志分析-2" class="headerlink" title="MinorGC 日志分析"></a>MinorGC 日志分析</h4><p>其中GC详情的前面几行是年轻代MinorGC时间。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs"><span class="hljs-attribute">2021</span>-<span class="hljs-number">07</span>-<span class="hljs-number">15</span>T<span class="hljs-number">01</span>:<span class="hljs-number">04</span>:<span class="hljs-number">03</span>.<span class="hljs-number">885</span>-<span class="hljs-number">0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">177</span>: <br>[GC (Allocation Failure) <br><span class="hljs-attribute">2021</span>-<span class="hljs-number">07</span>-<span class="hljs-number">15</span>T<span class="hljs-number">01</span>:<span class="hljs-number">04</span>:<span class="hljs-number">03</span>.<span class="hljs-number">885</span>-<span class="hljs-number">0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">177</span>: <br>        [ParNew: 139776K-&gt;17471K(157248K), 0.0140477 secs] <br>            <span class="hljs-attribute">139776K</span>-&gt;<span class="hljs-number">46305</span>K(<span class="hljs-number">506816</span>K), <span class="hljs-number">0</span>.<span class="hljs-number">0142076</span> secs] <br>    [Times: user=0.03 sys=0.06, real=0.01 secs] <br></code></pre></td></tr></table></figure>

<ol>
<li><code>2021-07-15T01:04:03.885-0800: 0.177:</code> GC事件开始的事件。</li>
<li><code>GC (Allocation Failure)</code> 用来区分MinorGC还是FullGC的标志。<code>GC</code> 表明这是一次<code>小型GC</code>；<code>Allocation Failure</code>表示触发GC的原因。本次GC事件，是由年轻代可用空间不足，新对象的内存分配失败引起的。</li>
<li><code>[ParNew: 139776K-&gt;17471K(157248K), 0.0140477 secs]</code> 其中<code>ParNew</code>是垃圾收集器的名称，对应的就是前面打印的<code>-XX:+UseParNewGC</code>这个命令行标志。表示年轻代中使用的：<code>并行的标记-复制(mark-copy)</code>垃圾收集器，专门设计了用来配合CMS 的垃圾收集器，因为CMS只负责回收老年代。后面的数字表示GC前后的年轻代使用量变化，以及年轻代的总大小。<code>0.0140477 secs</code>是消耗的时间。</li>
<li><code>139776K-&gt;46305K(506816K), 0.0142076 secs</code> 表示GC前后堆内存的使用量变化，以及堆空间的内存大小。消耗时间是<code>0.0142076 secs</code>，和前面的 ParNew 部分的时间基本上一样。</li>
<li><code>[Times: user=0.03 sys=0.06, real=0.01 secs]</code> GC事件的持续事件，<code>user</code>是GC线程所消耗的总CPU时间：<code>sys</code> 是操作系统调用和系统等待事件消耗的事件；应用程序实际暂停时间<code>real ～= (user + sys)/GC线程数</code>。</li>
</ol>
<p>通过进一步计算我们可以知道，在GC之前，年轻代是使用量为 <code>139776K/157248K ～= 88.9%</code>。堆内存的使用率为<code>139776K/506816K ～= 27.6%</code>，简单估算下老年代的使用量，在ParNew GC 开始前，年轻代和整堆使用量相同因此，老年代在GC之前的使用量为0。而GC后老年代的使用率为<code>(46305-17471)/506816K~=5.6%</code>。</p>
<h4 id="FullGC-日志分析-2"><a href="#FullGC-日志分析-2" class="headerlink" title="FullGC 日志分析"></a>FullGC 日志分析</h4><p>CMS 的日志风格和之前的集中日志的风格不一样，CMS的日志包含了CMS执行的多个阶段的内存使用信息，同时也包含了更多更详细的GC信息，下面就是一条完整的GC日志信息。</p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs subunit">2021<span class="hljs-string">-07</span><span class="hljs-string">-15</span>T01:04:08.774<span class="hljs-string">-0800</span>: 5.066: <br>        [GC (CMS Initial Mark) <br>    [1 CMS-initial-mark: 349310K(349568K)] 372830K(506816K), 0.0002245 secs] <br>    [Times: user=0.00 sys=0.00, real=0.00 secs] <br>2021<span class="hljs-string">-07</span><span class="hljs-string">-15</span>T01:04:08.774<span class="hljs-string">-0800</span>: 5.066: [CMS-concurrent-mark-start]<br>2021<span class="hljs-string">-07</span><span class="hljs-string">-15</span>T01:04:08.775<span class="hljs-string">-0800</span>: 5.067: <br>        [CMS-concurrent-mark: 0.001/0.001 secs] <br>    [Times: user=0.00 sys=0.00, real=0.00 secs] <br>2021<span class="hljs-string">-07</span><span class="hljs-string">-15</span>T01:04:08.775<span class="hljs-string">-0800</span>: 5.067: [CMS-concurrent-preclean-start]<br>2021<span class="hljs-string">-07</span><span class="hljs-string">-15</span>T01:04:08.777<span class="hljs-string">-0800</span>: 5.069: <br>        [CMS-concurrent-preclean: 0.001/0.001 secs] <br>    [Times: user=0.00 sys=0.00, real=0.00 secs] <br>2021<span class="hljs-string">-07</span><span class="hljs-string">-15</span>T01:04:08.777<span class="hljs-string">-0800</span>: 5.069: [CMS-concurrent-abortable-preclean-start]<br>2021<span class="hljs-string">-07</span><span class="hljs-string">-15</span>T01:04:08.777<span class="hljs-string">-0800</span>: 5.069: <br>        [CMS-concurrent-abortable-preclean: 0.000/0.000 secs] <br>    [Times: user=0.00 sys=0.00, real=0.00 secs] <br>2021<span class="hljs-string">-07</span><span class="hljs-string">-15</span>T01:04:08.777<span class="hljs-string">-0800</span>: 5.069: [GC (CMS Final Remark) [YG occupancy: 42054 K (157248 K)]<br>2021<span class="hljs-string">-07</span><span class="hljs-string">-15</span>T01:04:08.777<span class="hljs-string">-0800</span>: 5.069: [Rescan (parallel) , 0.0003608 secs]<br>2021<span class="hljs-string">-07</span><span class="hljs-string">-15</span>T01:04:08.777<span class="hljs-string">-0800</span>: 5.069: [weak refs processing, 0.0000184 secs]<br>2021<span class="hljs-string">-07</span><span class="hljs-string">-15</span>T01:04:08.777<span class="hljs-string">-0800</span>: 5.069: [class unloading, 0.0002228 secs]<br>2021<span class="hljs-string">-07</span><span class="hljs-string">-15</span>T01:04:08.778<span class="hljs-string">-0800</span>: 5.070: [scrub symbol table, 0.0003110 secs]<br>2021<span class="hljs-string">-07</span><span class="hljs-string">-15</span>T01:04:08.778<span class="hljs-string">-0800</span>: 5.070: [scrub string table, 0.0002060 secs]<br>    [1 CMS-remark: 349310K(349568K)] 391364K(506816K), 0.0012004 secs] <br>    [Times: user=0.01 sys=0.00, real=0.00 secs] <br>2021<span class="hljs-string">-07</span><span class="hljs-string">-15</span>T01:04:08.778<span class="hljs-string">-0800</span>: 5.070: [CMS-concurrent-sweep-start]<br>2021<span class="hljs-string">-07</span><span class="hljs-string">-15</span>T01:04:08.779<span class="hljs-string">-0800</span>: 5.071: <br>        [CMS-concurrent-sweep: 0.000/0.000 secs] <br>    [Times: user=0.00 sys=0.00, real=0.00 secs] <br>2021<span class="hljs-string">-07</span><span class="hljs-string">-15</span>T01:04:08.779<span class="hljs-string">-0800</span>: 5.071: [CMS-concurrent-reset-start]<br>2021<span class="hljs-string">-07</span><span class="hljs-string">-15</span>T01:04:08.779<span class="hljs-string">-0800</span>: 5.071: <br>        [CMS-concurrent-reset: 0.000/0.000 secs] <br>    [Times: user=0.00 sys=0.00, real=0.00 secs] <br></code></pre></td></tr></table></figure>

<p>在实际的运行阶段，CMS在进行老年代的并发垃圾回收时，可能伴随多次年轻代的MinorGC，在这种情况下，FullGC的日志中可能掺杂多次MinorGC事件。接下来我们会详细分析CMS日志的每个部分，如果又忘记的小伙伴可以去垃圾收集器（上）复习下CMS的垃圾收集过程。</p>
<h5 id="阶段1：Initial-Mark（初始标记）"><a href="#阶段1：Initial-Mark（初始标记）" class="headerlink" title="阶段1：Initial Mark（初始标记）"></a>阶段1：Initial Mark（初始标记）</h5><p>前面提到过，这个阶段伴随着STW暂停。初始标记的目标是标记所有的根对象，包括<code>GC ROOT</code>直接引用的对象，以及被年轻代中所有存活对象所引用的对象。后面这部分也非常重要，因为老年代是独立进行回收的。先看这个阶段的日志信息。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">2021-07-15T01:04:08.774-0800: 5.066: <br>        [GC (CMS Initial Mark) <br>    [1 CMS-initial-mark: 349310K(349568K)] 372830K(506816K), 0.0002245 secs] <br>    [Times: <span class="hljs-attribute">user</span>=0.00 <span class="hljs-attribute">sys</span>=0.00, <span class="hljs-attribute">real</span>=0.00 secs] <br></code></pre></td></tr></table></figure>

<blockquote>
<ol>
<li><code>2021-07-15T01:04:08.774-0800: 5.066:</code> GC开始事件，这个部分就不重复。</li>
<li><code>CMS Initial Mark</code>这个阶段的名称为 “<code>Initial Mark</code>”，会标记所有的<code>GC ROOT</code>。</li>
<li><code>[1 CMS-initial-mark: 349310K(349568K)]</code> 这个部分数字表示老年代的使用量，以及老年代的空间大小。</li>
<li><code>372830K(506816K), 0.0002245 secs</code> 这个是当前堆内存的使用量，以及可用堆的大小，消耗的时间，可以看出这个时间非常短，只有<code>0.02</code>毫秒，因为要标记的Root数量非常少。</li>
<li><code>[Times: user=0.00 sys=0.00, real=0.00 secs]</code> 初始标记时间暂停的时间，我们可以看到耗费时间非常短，基本可以忽略不计。</li>
</ol>
</blockquote>
<h5 id="阶段2：Concurrent-Mark（并发标记）"><a href="#阶段2：Concurrent-Mark（并发标记）" class="headerlink" title="阶段2：Concurrent Mark（并发标记）"></a>阶段2：Concurrent Mark（并发标记）</h5><p>在并发标记阶段，CMS 从前一段 “Inital Mark”找到ROOT开始算起，遍历老年代并标记所有的存活对象。这个阶段的GC日志如下：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">2021-07-15T01:04:08.774-0800: 5.066: [CMS-concurrent-mark-start]<br>2021-07-15T01:04:08.775-0800: 5.067: <br>        [CMS-concurrent-mark: 0.001/0.001 secs] <br>    [Times: <span class="hljs-attribute">user</span>=0.00 <span class="hljs-attribute">sys</span>=0.00, <span class="hljs-attribute">real</span>=0.00 secs] <br></code></pre></td></tr></table></figure>

<blockquote>
<ol>
<li><code>CMS-concurrent-mark-start</code> -指明了是CMS垃圾收集器所处的阶段为并发标记”Concurrent Mark”。</li>
<li><code>0.001/0.001 secs</code> 此阶段的持续时间，分别是GC线程消耗的时间和实际消耗的时间。</li>
<li><code>[Times: user=0.00 sys=0.00, real=0.00 secs]</code> 执行实现对并发阶段来说并没有多少意义，因为是从并发标记开始时刻计算的，而这段时间应用线程也在执行，所以这个时间只是一个大概的值。</li>
</ol>
</blockquote>
<h5 id="阶段3：Concurrent-Preclean（并发预清理）"><a href="#阶段3：Concurrent-Preclean（并发预清理）" class="headerlink" title="阶段3：Concurrent Preclean（并发预清理）"></a>阶段3：Concurrent Preclean（并发预清理）</h5><p>此阶段同样是与应用线程并发执行的，不需要停止应用线程。这阶段的并发日志如下：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">2021-07-15T01:04:08.775-0800: 5.067: [CMS-concurrent-preclean-start]<br>2021-07-15T01:04:08.777-0800: 5.069: <br>        [CMS-concurrent-preclean: 0.001/0.001 secs] <br>    [Times: <span class="hljs-attribute">user</span>=0.00 <span class="hljs-attribute">sys</span>=0.00, <span class="hljs-attribute">real</span>=0.00 secs]<br></code></pre></td></tr></table></figure>

<p>简单解读：</p>
<blockquote>
<ol>
<li><code>CMS-concurrent-preclean</code> 表明这是并发清理阶段的日志，这个阶段会统计前面的并发标阶段执行过程中发生了改变的对象。</li>
<li><code>0.001/0.001 secs</code> 此阶段的持续时间，分别是GC线程运行时间和实际占用的时间。<code>Times</code>部分和前面的一样这里就不重复介绍了。</li>
</ol>
</blockquote>
<h5 id="阶段4：Concurrent-Abortable-Preclean（可取消的并发预清理）"><a href="#阶段4：Concurrent-Abortable-Preclean（可取消的并发预清理）" class="headerlink" title="阶段4：Concurrent Abortable Preclean（可取消的并发预清理）"></a>阶段4：Concurrent Abortable Preclean（可取消的并发预清理）</h5><p>此阶段也不停止应用线程，尝试在就触发STW的Final Remark 阶段开始之前，尽可能地多干一些活。本阶段的具体时间取决于多种因素，因为它循环做同样的事情，直到满足某一个退出条件（如迭代次数，有用工作量，消耗的系统时间等等）。以下是GC日志：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">2021-07-15T01:04:08.777-0800: 5.069: [CMS-concurrent-abortable-preclean-start]<br>2021-07-15T01:04:08.777-0800: 5.069: <br>        [CMS-concurrent-abortable-preclean: 0.000/0.000 secs] <br>    [Times: <span class="hljs-attribute">user</span>=0.00 <span class="hljs-attribute">sys</span>=0.00, <span class="hljs-attribute">real</span>=0.00 secs] <br></code></pre></td></tr></table></figure>

<p>解读如下：</p>
<blockquote>
<ol>
<li><code>CMS-concurrent-abortable-preclean</code> 表明此阶段的名称：Concurrent-Abortable-Preclean。</li>
<li><code>0.000/0.000 secs</code> 此阶段GC线程的运行时间和实际占用时间，本质上来说，GC线程试图在执行STW暂停之前等待尽可能长的时间，默认条件下，此阶段可以持续最长5秒钟的时间。</li>
</ol>
</blockquote>
<p>此阶段完成的工作可能对STW停顿时间有较大的影响，并且有许多的重要配置选项和失败模式。</p>
<h5 id="阶段5：Final-Remark（最终标记）"><a href="#阶段5：Final-Remark（最终标记）" class="headerlink" title="阶段5：Final Remark（最终标记）"></a>阶段5：Final Remark（最终标记）</h5><p>最终标记是此次GC事件中的第二次（也是最后一次）STW停顿。本阶段的目标是完成老年代的所有存活对象的标记。因为之前的预清理阶段是并发执行的，有可能GC线程跟不上应用线程的修改速度，所以需要一次STW暂停来处理各种复杂的情况。通常CMS会尝试在年轻代尽可能空的情况下执行final remark阶段，以避免连续触发多次STW时间。以下是这个部分的日志。</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">777-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">069</span>: [GC (CMS Final Remark) [YG occupancy: <span class="hljs-number">42054</span> K (<span class="hljs-number">157248</span> K)]<br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">777-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">069</span>: [Rescan (parallel) , <span class="hljs-number">0.0003608</span> secs]<br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">777-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">069</span>: [weak refs processing, <span class="hljs-number">0.0000184</span> secs]<br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">777-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">069</span>: [class unloading, <span class="hljs-number">0.0002228</span> secs]<br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">778-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">070</span>: [scrub symbol table, <span class="hljs-number">0.0003110</span> secs]<br><span class="hljs-number">2021</span>-<span class="hljs-number">07-15T01:04</span>:<span class="hljs-number">08</span>.<span class="hljs-number">778-0800</span>: <span class="hljs-number">5</span>.<span class="hljs-number">070</span>: [scrub string table, <span class="hljs-number">0.0002060</span> secs]<br>    [<span class="hljs-number">1</span> CMS-remark: <span class="hljs-number">349310</span>K(<span class="hljs-number">349568</span>K)] <span class="hljs-number">391364</span>K(<span class="hljs-number">506816</span>K), <span class="hljs-number">0.0012004</span> secs] <br>    [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">01</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> secs] <br></code></pre></td></tr></table></figure>

<blockquote>
<ol>
<li><code>CMS Final Remark</code> 这是此阶段的名称，最终标记阶段。会标记老年代中所有的存活对象，包括此前的并发标记过程中创建/修改的引用。</li>
<li><code>YG occupancy: 42054 K (157248 K)</code> 当前年轻代的使用量和总容量。</li>
<li><code>[Rescan (parallel) , 0.0003608 secs]</code> 在程序暂停后进行重新扫描（Rescan），以完成存活对象的标记，这部分是并行执行的，消耗的时间为<code>0.0003608 secs</code>。</li>
<li><code>[weak refs processing, 0.0000184 secs]</code>这是第一个子阶段：处理弱引用的持续时间。</li>
<li><code>class unloading, 0.0002228 secs</code> 第二个子阶段：卸载不使用的类，以及持续时间。</li>
<li><code>scrub symbol table, 0.0003110 secs</code> 第三个子阶段：清理符号表，即持有class级别metadata 的符号表（symbol tables）。</li>
<li><code>scrub string table, 0.0002060 secs</code>第四个子阶段：清理内联的字符串对应的String tables。</li>
<li><code>CMS-remark: 349310K(349568K)</code> 此阶段完成后老年代的使用量和总容量。</li>
<li><code>391364K(506816K), 0.0012004 secs</code> 此阶段完成后，整个内存堆的使用量和总容量。</li>
<li><code>[Times: user=0.01 sys=0.00, real=0.00 secs]</code> GC事件的持续时间。</li>
</ol>
</blockquote>
<p>在这5个阶段完成后，老年代中的所有对象都被标记上，接下来JVM会将所有不使用的对西那个清除，以回收老年代空间。</p>
<h5 id="阶段6：Concurrent-Sweep（并发清除）"><a href="#阶段6：Concurrent-Sweep（并发清除）" class="headerlink" title="阶段6：Concurrent Sweep（并发清除）"></a>阶段6：Concurrent Sweep（并发清除）</h5><p>这个阶段与应用程序并发执行，不需要STW停顿，目的是删除不再使用的对象，并回收他们占用的空间。以下是这部分的GC日志。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">2021-07-15T01:04:08.778-0800: 5.070: [CMS-concurrent-sweep-start]<br>2021-07-15T01:04:08.779-0800: 5.071: <br>        [CMS-concurrent-sweep: 0.000/0.000 secs] <br>    [Times: <span class="hljs-attribute">user</span>=0.00 <span class="hljs-attribute">sys</span>=0.00, <span class="hljs-attribute">real</span>=0.00 secs]<br></code></pre></td></tr></table></figure>

<p>简单解读：</p>
<blockquote>
<ol>
<li><code>CMS-concurrent-sweep</code> 这是这个阶段的名字“concurrent-sweep”，并发清除老年代中所有未被标记的对象，也就是不再使用的对象，以释放内存空间。</li>
<li><code>0.000/0.000 secs</code> 此阶段的持续时间和实际占用的时间，这是一个四舍五入的值，只精确到小数点后3位。</li>
</ol>
</blockquote>
<h5 id="阶段7：Concurrent-Reset（并发重置）"><a href="#阶段7：Concurrent-Reset（并发重置）" class="headerlink" title="阶段7：Concurrent Reset（并发重置）"></a>阶段7：Concurrent Reset（并发重置）</h5><p>此阶段与应用程序线程并发执行，重置CMS算法相关的内部数据结构，下一次触发GC时就可以直接使用。这个阶段的日志如下：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">2021-07-15T01:04:08.779-0800: 5.071: [CMS-concurrent-reset-start]<br>2021-07-15T01:04:08.779-0800: 5.071: <br>        [CMS-concurrent-reset: 0.000/0.000 secs] <br>    [Times: <span class="hljs-attribute">user</span>=0.00 <span class="hljs-attribute">sys</span>=0.00, <span class="hljs-attribute">real</span>=0.00 secs]<br></code></pre></td></tr></table></figure>

<p>简单解读如下：</p>
<blockquote>
<ol>
<li><code>CMS-concurrent-reset</code> 此阶段的名称，“Concurrent Reset”，重置CMS算法的内部数据结构，为以下此GC循环做准备。</li>
<li><code>0.000/0.000 secs</code> 此阶段的持续时间和实际占用时间。</li>
</ol>
</blockquote>
<p>总之，CMS垃圾收集器在减少停顿时间上做出了很多给力的工作，很大一部分GC线程与应用线程并发运行的，不需要暂停应用线程，这样就可以在一般情况下每次暂停的时间较少。当然，CMS也有一些缺点，其中最大的问题就是老年代的内存碎片问题，在某个情况下GC会有不可预测的暂停时间，特别是堆内存比较大的情况下。CMS 的原理与解析可以看我们复习我们前面的垃圾收集器(上)。</p>
<h3 id="G1-日志解读"><a href="#G1-日志解读" class="headerlink" title="G1 日志解读"></a>G1 日志解读</h3><p>如果对于G1的垃圾收集器的收集过程和原理不熟悉的同学也可以复习我们前面总结的垃圾收集器(上)。使用如下JVM参数启动。</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">-XX:+UseG1GC -Xloggc:gc.<span class="hljs-built_in">log</span> -XX:+PrintGCDetails -XX:+PrintGCDateStamps<br></code></pre></td></tr></table></figure>

<p>使用GC垃圾收集器我们可以得到如下的日志：</p>
<figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><code class="hljs tcl">ava HotSpot(TM) <span class="hljs-number">64</span>-Bit Server VM (<span class="hljs-number">25.231</span>-b11) <span class="hljs-keyword">for</span> bsd-amd64 JRE (<span class="hljs-number">1.8</span><span class="hljs-number">.0</span>_231-b11), built on Oct  <span class="hljs-number">5</span> <span class="hljs-number">2019</span> <span class="hljs-number">03</span>:<span class="hljs-number">15</span>:<span class="hljs-number">25</span> by <span class="hljs-string">&quot;java_re&quot;</span> with gcc <span class="hljs-number">4.2</span><span class="hljs-number">.1</span> (Based on Apple Inc. build <span class="hljs-number">5658</span>) (LLVM build <span class="hljs-number">2336.11</span><span class="hljs-number">.00</span>)<br>Memory: <span class="hljs-number">4</span>k page, physical <span class="hljs-number">16777216</span>k(<span class="hljs-number">588376</span>k free)<br><br>/<span class="hljs-keyword">proc</span>/meminfo:<br><br>CommandLine<span class="hljs-title"> flags:</span> -XX:InitialHeapSize=536870912 -XX:MaxHeapSize=536870912 -XX:+PrintGC -XX:+PrintGCDateStamps -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+UseCompressedClassPointers -XX:+UseCompressedOops -XX:+UseG1GC <br>2021-07-21T00:45:17.323-0800: 0.077: [GC<span class="hljs-title"> pause</span> (G1<span class="hljs-title"> Evacuation</span> Pause) (young), 0.0035596<span class="hljs-title"> secs]</span><br><span class="hljs-title"></span>   [Parallel<span class="hljs-title"> Time:</span> 2.8<span class="hljs-title"> ms,</span> GC<span class="hljs-title"> Workers:</span> 8]<br>      [GC<span class="hljs-title"> Worker</span> Start (ms):<span class="hljs-title"> Min:</span> 77.4,<span class="hljs-title"> Avg:</span> 77.5,<span class="hljs-title"> Max:</span> 77.5,<span class="hljs-title"> Diff:</span> 0.1]<br>      [Ext<span class="hljs-title"> Root</span> Scanning (ms):<span class="hljs-title"> Min:</span> 0.1,<span class="hljs-title"> Avg:</span> 0.2,<span class="hljs-title"> Max:</span> 0.8,<span class="hljs-title"> Diff:</span> 0.7,<span class="hljs-title"> Sum:</span> 1.8]<br>      [Update<span class="hljs-title"> RS</span> (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.0,<span class="hljs-title"> Max:</span> 0.0,<span class="hljs-title"> Diff:</span> 0.0,<span class="hljs-title"> Sum:</span> 0.0]<br>         [Processed<span class="hljs-title"> Buffers:</span> Min: 0,<span class="hljs-title"> Avg:</span> 0.0,<span class="hljs-title"> Max:</span> 0,<span class="hljs-title"> Diff:</span> 0,<span class="hljs-title"> Sum:</span> 0]<br>      [Scan<span class="hljs-title"> RS</span> (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.0,<span class="hljs-title"> Max:</span> 0.0,<span class="hljs-title"> Diff:</span> 0.0,<span class="hljs-title"> Sum:</span> 0.0]<br>      [Code<span class="hljs-title"> Root</span> Scanning (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.0,<span class="hljs-title"> Max:</span> 0.0,<span class="hljs-title"> Diff:</span> 0.0,<span class="hljs-title"> Sum:</span> 0.0]<br>      [Object<span class="hljs-title"> Copy</span> (ms):<span class="hljs-title"> Min:</span> 1.5,<span class="hljs-title"> Avg:</span> 1.7,<span class="hljs-title"> Max:</span> 1.8,<span class="hljs-title"> Diff:</span> 0.3,<span class="hljs-title"> Sum:</span> 13.5]<br>      [Termination (ms):<span class="hljs-title"> Min:</span> 0.3,<span class="hljs-title"> Avg:</span> 0.7,<span class="hljs-title"> Max:</span> 0.8,<span class="hljs-title"> Diff:</span> 0.4,<span class="hljs-title"> Sum:</span> 5.3]<br>         [Termination<span class="hljs-title"> Attempts:</span> Min: 1,<span class="hljs-title"> Avg:</span> 4.4,<span class="hljs-title"> Max:</span> 7,<span class="hljs-title"> Diff:</span> 6,<span class="hljs-title"> Sum:</span> 35]<br>      [GC<span class="hljs-title"> Worker</span> Other (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.0,<span class="hljs-title"> Max:</span> 0.0,<span class="hljs-title"> Diff:</span> 0.0,<span class="hljs-title"> Sum:</span> 0.1]<br>      [GC<span class="hljs-title"> Worker</span> Total (ms):<span class="hljs-title"> Min:</span> 2.5,<span class="hljs-title"> Avg:</span> 2.6,<span class="hljs-title"> Max:</span> 2.7,<span class="hljs-title"> Diff:</span> 0.2,<span class="hljs-title"> Sum:</span> 20.8]<br>      [GC<span class="hljs-title"> Worker</span> End (ms):<span class="hljs-title"> Min:</span> 80.0,<span class="hljs-title"> Avg:</span> 80.0,<span class="hljs-title"> Max:</span> 80.2,<span class="hljs-title"> Diff:</span> 0.2]<br>   [Code<span class="hljs-title"> Root</span> Fixup: 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>   [Code<span class="hljs-title"> Root</span> Purge: 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>   [Clear<span class="hljs-title"> CT:</span> 0.1<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>   [Other: 0.6<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Choose<span class="hljs-title"> CSet:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Ref<span class="hljs-title"> Proc:</span> 0.2<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Ref<span class="hljs-title"> Enq:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Redirty<span class="hljs-title"> Cards:</span> 0.1<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Humongous<span class="hljs-title"> Register:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Humongous<span class="hljs-title"> Reclaim:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Free<span class="hljs-title"> CSet:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>   [Eden: 25.0M(25.0M)-&gt;0.0B(27.0M)<span class="hljs-title"> Survivors:</span> 0.0B-&gt;4096.0K<span class="hljs-title"> Heap:</span> 28.6M(512.0M)-&gt;8908.2K(512.0M)]<br> [Times:<span class="hljs-title"> user=0.01</span> sys=0.01,<span class="hljs-title"> real=0.00</span> secs] <br>......<br>2021-07-21T00:45:17.538-0800: 0.292: [GC<span class="hljs-title"> pause</span> (G1<span class="hljs-title"> Humongous</span> Allocation) (young) (initial-mark), 0.0044054<span class="hljs-title"> secs]</span><br><span class="hljs-title"></span>   [Parallel<span class="hljs-title"> Time:</span> 4.0<span class="hljs-title"> ms,</span> GC<span class="hljs-title"> Workers:</span> 8]<br>      [GC<span class="hljs-title"> Worker</span> Start (ms):<span class="hljs-title"> Min:</span> 292.0,<span class="hljs-title"> Avg:</span> 292.1,<span class="hljs-title"> Max:</span> 292.1,<span class="hljs-title"> Diff:</span> 0.1]<br>      [Ext<span class="hljs-title"> Root</span> Scanning (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.1,<span class="hljs-title"> Max:</span> 0.2,<span class="hljs-title"> Diff:</span> 0.1,<span class="hljs-title"> Sum:</span> 0.6]<br>      [Update<span class="hljs-title"> RS</span> (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.0,<span class="hljs-title"> Max:</span> 0.0,<span class="hljs-title"> Diff:</span> 0.0,<span class="hljs-title"> Sum:</span> 0.2]<br>         [Processed<span class="hljs-title"> Buffers:</span> Min: 1,<span class="hljs-title"> Avg:</span> 1.2,<span class="hljs-title"> Max:</span> 2,<span class="hljs-title"> Diff:</span> 1,<span class="hljs-title"> Sum:</span> 10]<br>      [Scan<span class="hljs-title"> RS</span> (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.0,<span class="hljs-title"> Max:</span> 0.0,<span class="hljs-title"> Diff:</span> 0.0,<span class="hljs-title"> Sum:</span> 0.0]<br>      [Code<span class="hljs-title"> Root</span> Scanning (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.0,<span class="hljs-title"> Max:</span> 0.0,<span class="hljs-title"> Diff:</span> 0.0,<span class="hljs-title"> Sum:</span> 0.0]<br>      [Object<span class="hljs-title"> Copy</span> (ms):<span class="hljs-title"> Min:</span> 3.6,<span class="hljs-title"> Avg:</span> 3.7,<span class="hljs-title"> Max:</span> 3.7,<span class="hljs-title"> Diff:</span> 0.1,<span class="hljs-title"> Sum:</span> 29.2]<br>      [Termination (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.1,<span class="hljs-title"> Max:</span> 0.2,<span class="hljs-title"> Diff:</span> 0.2,<span class="hljs-title"> Sum:</span> 0.6]<br>         [Termination<span class="hljs-title"> Attempts:</span> Min: 1,<span class="hljs-title"> Avg:</span> 1.0,<span class="hljs-title"> Max:</span> 1,<span class="hljs-title"> Diff:</span> 0,<span class="hljs-title"> Sum:</span> 8]<br>      [GC<span class="hljs-title"> Worker</span> Other (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.0,<span class="hljs-title"> Max:</span> 0.0,<span class="hljs-title"> Diff:</span> 0.0,<span class="hljs-title"> Sum:</span> 0.1]<br>      [GC<span class="hljs-title"> Worker</span> Total (ms):<span class="hljs-title"> Min:</span> 3.8,<span class="hljs-title"> Avg:</span> 3.8,<span class="hljs-title"> Max:</span> 3.9,<span class="hljs-title"> Diff:</span> 0.1,<span class="hljs-title"> Sum:</span> 30.8]<br>      [GC<span class="hljs-title"> Worker</span> End (ms):<span class="hljs-title"> Min:</span> 295.9,<span class="hljs-title"> Avg:</span> 295.9,<span class="hljs-title"> Max:</span> 296.0,<span class="hljs-title"> Diff:</span> 0.1]<br>   [Code<span class="hljs-title"> Root</span> Fixup: 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>   [Code<span class="hljs-title"> Root</span> Purge: 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>   [Clear<span class="hljs-title"> CT:</span> 0.1<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>   [Other: 0.3<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Choose<span class="hljs-title"> CSet:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Ref<span class="hljs-title"> Proc:</span> 0.1<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Ref<span class="hljs-title"> Enq:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Redirty<span class="hljs-title"> Cards:</span> 0.1<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Humongous<span class="hljs-title"> Register:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Humongous<span class="hljs-title"> Reclaim:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Free<span class="hljs-title"> CSet:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>   [Eden: 2048.0K(71.0M)-&gt;0.0B(116.0M)<span class="hljs-title"> Survivors:</span> 33.0M-&gt;1024.0K<span class="hljs-title"> Heap:</span> 307.5M(512.0M)-&gt;305.7M(512.0M)]<br> [Times:<span class="hljs-title"> user=0.02</span> sys=0.00,<span class="hljs-title"> real=0.01</span> secs] <br>2021-07-21T00:45:17.542-0800: 0.296: [GC<span class="hljs-title"> concurrent-root-region-scan-start]</span><br><span class="hljs-title">2021-07-21T00:45:17.542-0800:</span> 0.296: [GC<span class="hljs-title"> concurrent-root-region-scan-end,</span> 0.0000326<span class="hljs-title"> secs]</span><br><span class="hljs-title">2021-07-21T00:45:17.542-0800:</span> 0.296: [GC<span class="hljs-title"> concurrent-mark-start]</span><br><span class="hljs-title">2021-07-21T00:45:17.544-0800:</span> 0.298: [GC<span class="hljs-title"> concurrent-mark-end,</span> 0.0019507<span class="hljs-title"> secs]</span><br><span class="hljs-title">2021-07-21T00:45:17.544-0800:</span> 0.299: [GC<span class="hljs-title"> remark</span> 2021-07-21T00:45:17.544-0800: 0.299: [Finalize<span class="hljs-title"> Marking,</span> 0.0002050<span class="hljs-title"> secs]</span> 2021-07-21T00:45:17.544-0800: 0.299: [GC<span class="hljs-title"> ref-proc,</span> 0.0000344<span class="hljs-title"> secs]</span> 2021-07-21T00:45:17.544-0800: 0.299: [Unloading, 0.0003887<span class="hljs-title"> secs],</span> 0.0010297<span class="hljs-title"> secs]</span><br><span class="hljs-title"></span> [Times:<span class="hljs-title"> user=0.00</span> sys=0.00,<span class="hljs-title"> real=0.00</span> secs] <br>2021-07-21T00:45:17.545-0800: 0.300: [GC<span class="hljs-title"> cleanup</span> 319M-&gt;319M(512M), 0.0007032<span class="hljs-title"> secs]</span><br><span class="hljs-title"></span> [Times:<span class="hljs-title"> user=0.01</span> sys=0.00,<span class="hljs-title"> real=0.00</span> secs] <br>2021-07-21T00:45:17.569-0800: 0.323: [GC<span class="hljs-title"> pause</span> (G1<span class="hljs-title"> Evacuation</span> Pause) (young) (to-space<span class="hljs-title"> exhausted),</span> 0.0032034<span class="hljs-title"> secs]</span><br><span class="hljs-title"></span>   [Parallel<span class="hljs-title"> Time:</span> 2.3<span class="hljs-title"> ms,</span> GC<span class="hljs-title"> Workers:</span> 8]<br>      [GC<span class="hljs-title"> Worker</span> Start (ms):<span class="hljs-title"> Min:</span> 323.3,<span class="hljs-title"> Avg:</span> 323.4,<span class="hljs-title"> Max:</span> 323.4,<span class="hljs-title"> Diff:</span> 0.2]<br>      [Ext<span class="hljs-title"> Root</span> Scanning (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.1,<span class="hljs-title"> Max:</span> 0.2,<span class="hljs-title"> Diff:</span> 0.2,<span class="hljs-title"> Sum:</span> 0.7]<br>      [Update<span class="hljs-title"> RS</span> (ms):<span class="hljs-title"> Min:</span> 0.1,<span class="hljs-title"> Avg:</span> 0.2,<span class="hljs-title"> Max:</span> 0.3,<span class="hljs-title"> Diff:</span> 0.2,<span class="hljs-title"> Sum:</span> 1.4]<br>         [Processed<span class="hljs-title"> Buffers:</span> Min: 0,<span class="hljs-title"> Avg:</span> 2.4,<span class="hljs-title"> Max:</span> 3,<span class="hljs-title"> Diff:</span> 3,<span class="hljs-title"> Sum:</span> 19]<br>      [Scan<span class="hljs-title"> RS</span> (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.0,<span class="hljs-title"> Max:</span> 0.0,<span class="hljs-title"> Diff:</span> 0.0,<span class="hljs-title"> Sum:</span> 0.1]<br>      [Code<span class="hljs-title"> Root</span> Scanning (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.0,<span class="hljs-title"> Max:</span> 0.0,<span class="hljs-title"> Diff:</span> 0.0,<span class="hljs-title"> Sum:</span> 0.0]<br>      [Object<span class="hljs-title"> Copy</span> (ms):<span class="hljs-title"> Min:</span> 1.6,<span class="hljs-title"> Avg:</span> 1.8,<span class="hljs-title"> Max:</span> 1.8,<span class="hljs-title"> Diff:</span> 0.2,<span class="hljs-title"> Sum:</span> 14.3]<br>      [Termination (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.0,<span class="hljs-title"> Max:</span> 0.1,<span class="hljs-title"> Diff:</span> 0.1,<span class="hljs-title"> Sum:</span> 0.2]<br>         [Termination<span class="hljs-title"> Attempts:</span> Min: 1,<span class="hljs-title"> Avg:</span> 1.0,<span class="hljs-title"> Max:</span> 1,<span class="hljs-title"> Diff:</span> 0,<span class="hljs-title"> Sum:</span> 8]<br>      [GC<span class="hljs-title"> Worker</span> Other (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.0,<span class="hljs-title"> Max:</span> 0.0,<span class="hljs-title"> Diff:</span> 0.0,<span class="hljs-title"> Sum:</span> 0.1]<br>      [GC<span class="hljs-title"> Worker</span> Total (ms):<span class="hljs-title"> Min:</span> 2.0,<span class="hljs-title"> Avg:</span> 2.1,<span class="hljs-title"> Max:</span> 2.2,<span class="hljs-title"> Diff:</span> 0.2,<span class="hljs-title"> Sum:</span> 16.9]<br>      [GC<span class="hljs-title"> Worker</span> End (ms):<span class="hljs-title"> Min:</span> 325.5,<span class="hljs-title"> Avg:</span> 325.5,<span class="hljs-title"> Max:</span> 325.5,<span class="hljs-title"> Diff:</span> 0.0]<br>   [Code<span class="hljs-title"> Root</span> Fixup: 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>   [Code<span class="hljs-title"> Root</span> Purge: 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>   [Clear<span class="hljs-title"> CT:</span> 0.1<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>   [Other: 0.8<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Evacuation<span class="hljs-title"> Failure:</span> 0.5<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Choose<span class="hljs-title"> CSet:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Ref<span class="hljs-title"> Proc:</span> 0.1<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Ref<span class="hljs-title"> Enq:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Redirty<span class="hljs-title"> Cards:</span> 0.1<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Humongous<span class="hljs-title"> Register:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Humongous<span class="hljs-title"> Reclaim:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Free<span class="hljs-title"> CSet:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>   [Eden: 116.0M(116.0M)-&gt;0.0B(10.0M)<span class="hljs-title"> Survivors:</span> 1024.0K-&gt;15.0M<span class="hljs-title"> Heap:</span> 455.3M(512.0M)-&gt;412.4M(512.0M)]<br> [Times:<span class="hljs-title"> user=0.01</span> sys=0.01,<span class="hljs-title"> real=0.01</span> secs] <br>2021-07-21T00:45:17.574-0800: 0.328: [GC<span class="hljs-title"> pause</span> (G1<span class="hljs-title"> Evacuation</span> Pause) (mixed), 0.0028130<span class="hljs-title"> secs]</span><br><span class="hljs-title"></span>   [Parallel<span class="hljs-title"> Time:</span> 2.4<span class="hljs-title"> ms,</span> GC<span class="hljs-title"> Workers:</span> 8]<br>      [GC<span class="hljs-title"> Worker</span> Start (ms):<span class="hljs-title"> Min:</span> 328.6,<span class="hljs-title"> Avg:</span> 328.6,<span class="hljs-title"> Max:</span> 328.7,<span class="hljs-title"> Diff:</span> 0.1]<br>      [Ext<span class="hljs-title"> Root</span> Scanning (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.1,<span class="hljs-title"> Max:</span> 0.1,<span class="hljs-title"> Diff:</span> 0.1,<span class="hljs-title"> Sum:</span> 0.6]<br>      [Update<span class="hljs-title"> RS</span> (ms):<span class="hljs-title"> Min:</span> 0.1,<span class="hljs-title"> Avg:</span> 0.2,<span class="hljs-title"> Max:</span> 0.2,<span class="hljs-title"> Diff:</span> 0.1,<span class="hljs-title"> Sum:</span> 1.3]<br>         [Processed<span class="hljs-title"> Buffers:</span> Min: 0,<span class="hljs-title"> Avg:</span> 2.2,<span class="hljs-title"> Max:</span> 3,<span class="hljs-title"> Diff:</span> 3,<span class="hljs-title"> Sum:</span> 18]<br>      [Scan<span class="hljs-title"> RS</span> (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.0,<span class="hljs-title"> Max:</span> 0.0,<span class="hljs-title"> Diff:</span> 0.0,<span class="hljs-title"> Sum:</span> 0.1]<br>      [Code<span class="hljs-title"> Root</span> Scanning (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.0,<span class="hljs-title"> Max:</span> 0.0,<span class="hljs-title"> Diff:</span> 0.0,<span class="hljs-title"> Sum:</span> 0.0]<br>      [Object<span class="hljs-title"> Copy</span> (ms):<span class="hljs-title"> Min:</span> 1.9,<span class="hljs-title"> Avg:</span> 1.9,<span class="hljs-title"> Max:</span> 2.0,<span class="hljs-title"> Diff:</span> 0.2,<span class="hljs-title"> Sum:</span> 15.5]<br>      [Termination (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.1,<span class="hljs-title"> Max:</span> 0.2,<span class="hljs-title"> Diff:</span> 0.2,<span class="hljs-title"> Sum:</span> 0.7]<br>         [Termination<span class="hljs-title"> Attempts:</span> Min: 1,<span class="hljs-title"> Avg:</span> 1.0,<span class="hljs-title"> Max:</span> 1,<span class="hljs-title"> Diff:</span> 0,<span class="hljs-title"> Sum:</span> 8]<br>      [GC<span class="hljs-title"> Worker</span> Other (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.0,<span class="hljs-title"> Max:</span> 0.0,<span class="hljs-title"> Diff:</span> 0.0,<span class="hljs-title"> Sum:</span> 0.1]<br>      [GC<span class="hljs-title"> Worker</span> Total (ms):<span class="hljs-title"> Min:</span> 2.2,<span class="hljs-title"> Avg:</span> 2.3,<span class="hljs-title"> Max:</span> 2.3,<span class="hljs-title"> Diff:</span> 0.1,<span class="hljs-title"> Sum:</span> 18.3]<br>      [GC<span class="hljs-title"> Worker</span> End (ms):<span class="hljs-title"> Min:</span> 330.9,<span class="hljs-title"> Avg:</span> 330.9,<span class="hljs-title"> Max:</span> 331.0,<span class="hljs-title"> Diff:</span> 0.1]<br>   [Code<span class="hljs-title"> Root</span> Fixup: 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>   [Code<span class="hljs-title"> Root</span> Purge: 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>   [Clear<span class="hljs-title"> CT:</span> 0.1<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>   [Other: 0.3<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Choose<span class="hljs-title"> CSet:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Ref<span class="hljs-title"> Proc:</span> 0.1<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Ref<span class="hljs-title"> Enq:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Redirty<span class="hljs-title"> Cards:</span> 0.1<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Humongous<span class="hljs-title"> Register:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Humongous<span class="hljs-title"> Reclaim:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Free<span class="hljs-title"> CSet:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>   [Eden: 10.0M(10.0M)-&gt;0.0B(21.0M)<span class="hljs-title"> Survivors:</span> 15.0M-&gt;4096.0K<span class="hljs-title"> Heap:</span> 425.6M(512.0M)-&gt;365.1M(512.0M)]<br> [Times:<span class="hljs-title"> user=0.01</span> sys=0.00,<span class="hljs-title"> real=0.00</span> secs] <br>......<br>021-07-21T00:45:22.278-0800: 5.032: [GC<span class="hljs-title"> pause</span> (G1<span class="hljs-title"> Evacuation</span> Pause) (young), 0.0006462<span class="hljs-title"> secs]</span><br><span class="hljs-title"></span>   [Parallel<span class="hljs-title"> Time:</span> 0.3<span class="hljs-title"> ms,</span> GC<span class="hljs-title"> Workers:</span> 8]<br>      [GC<span class="hljs-title"> Worker</span> Start (ms):<span class="hljs-title"> Min:</span> 5032.5,<span class="hljs-title"> Avg:</span> 5032.6,<span class="hljs-title"> Max:</span> 5032.6,<span class="hljs-title"> Diff:</span> 0.0]<br>      [Ext<span class="hljs-title"> Root</span> Scanning (ms):<span class="hljs-title"> Min:</span> 0.1,<span class="hljs-title"> Avg:</span> 0.1,<span class="hljs-title"> Max:</span> 0.1,<span class="hljs-title"> Diff:</span> 0.0,<span class="hljs-title"> Sum:</span> 0.7]<br>      [Update<span class="hljs-title"> RS</span> (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.0,<span class="hljs-title"> Max:</span> 0.1,<span class="hljs-title"> Diff:</span> 0.1,<span class="hljs-title"> Sum:</span> 0.2]<br>         [Processed<span class="hljs-title"> Buffers:</span> Min: 0,<span class="hljs-title"> Avg:</span> 0.9,<span class="hljs-title"> Max:</span> 1,<span class="hljs-title"> Diff:</span> 1,<span class="hljs-title"> Sum:</span> 7]<br>      [Scan<span class="hljs-title"> RS</span> (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.0,<span class="hljs-title"> Max:</span> 0.0,<span class="hljs-title"> Diff:</span> 0.0,<span class="hljs-title"> Sum:</span> 0.0]<br>      [Code<span class="hljs-title"> Root</span> Scanning (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.0,<span class="hljs-title"> Max:</span> 0.0,<span class="hljs-title"> Diff:</span> 0.0,<span class="hljs-title"> Sum:</span> 0.0]<br>      [Object<span class="hljs-title"> Copy</span> (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.0,<span class="hljs-title"> Max:</span> 0.0,<span class="hljs-title"> Diff:</span> 0.0,<span class="hljs-title"> Sum:</span> 0.0]<br>      [Termination (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.2,<span class="hljs-title"> Max:</span> 0.2,<span class="hljs-title"> Diff:</span> 0.2,<span class="hljs-title"> Sum:</span> 1.3]<br>         [Termination<span class="hljs-title"> Attempts:</span> Min: 1,<span class="hljs-title"> Avg:</span> 1.0,<span class="hljs-title"> Max:</span> 1,<span class="hljs-title"> Diff:</span> 0,<span class="hljs-title"> Sum:</span> 8]<br>      [GC<span class="hljs-title"> Worker</span> Other (ms):<span class="hljs-title"> Min:</span> 0.0,<span class="hljs-title"> Avg:</span> 0.0,<span class="hljs-title"> Max:</span> 0.0,<span class="hljs-title"> Diff:</span> 0.0,<span class="hljs-title"> Sum:</span> 0.0]<br>      [GC<span class="hljs-title"> Worker</span> Total (ms):<span class="hljs-title"> Min:</span> 0.2,<span class="hljs-title"> Avg:</span> 0.3,<span class="hljs-title"> Max:</span> 0.3,<span class="hljs-title"> Diff:</span> 0.1,<span class="hljs-title"> Sum:</span> 2.3]<br>      [GC<span class="hljs-title"> Worker</span> End (ms):<span class="hljs-title"> Min:</span> 5032.8,<span class="hljs-title"> Avg:</span> 5032.8,<span class="hljs-title"> Max:</span> 5032.9,<span class="hljs-title"> Diff:</span> 0.1]<br>   [Code<span class="hljs-title"> Root</span> Fixup: 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>   [Code<span class="hljs-title"> Root</span> Purge: 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>   [Clear<span class="hljs-title"> CT:</span> 0.1<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>   [Other: 0.2<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Choose<span class="hljs-title"> CSet:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Ref<span class="hljs-title"> Proc:</span> 0.1<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Ref<span class="hljs-title"> Enq:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Redirty<span class="hljs-title"> Cards:</span> 0.1<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Humongous<span class="hljs-title"> Register:</span> 0.1<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Humongous<span class="hljs-title"> Reclaim:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>      [Free<span class="hljs-title"> CSet:</span> 0.0<span class="hljs-title"> ms]</span><br><span class="hljs-title"></span>   [Eden: 0.0B(25.0M)-&gt;0.0B(25.0M)<span class="hljs-title"> Survivors:</span> 0.0B-&gt;0.0B<span class="hljs-title"> Heap:</span> 405.6M(512.0M)-&gt;405.6M(512.0M)]<br> [Times:<span class="hljs-title"> user=0.00</span> sys=0.00,<span class="hljs-title"> real=0.00</span> secs] <br>2021-07-21T00:45:22.279-0800: 5.033: [Full<span class="hljs-title"> GC</span> (Allocation<span class="hljs-title"> Failure)</span>  405M-&gt;378M(512M), 0.0339622<span class="hljs-title"> secs]</span><br><span class="hljs-title"></span>   [Eden: 0.0B(25.0M)-&gt;0.0B(25.0M)<span class="hljs-title"> Survivors:</span> 0.0B-&gt;0.0B<span class="hljs-title"> Heap:</span> 405.6M(512.0M)-&gt;378.8M(512.0M)], [Metaspace: 2565K-&gt;2565K(1056768K)]<br> [Times:<span class="hljs-title"> user=0.03</span> sys=0.00,<span class="hljs-title"> real=0.04</span> secs] <br>2021-07-21T00:45:22.313-0800: 5.067: [GC<span class="hljs-title"> concurrent-mark-abort]</span><br><span class="hljs-title">Heap</span><br><span class="hljs-title"></span> garbage-first<span class="hljs-title"> heap</span> <span class="hljs-title">  total</span> 524288K,<span class="hljs-title"> used</span> 387912K [0x00000007a0000000, 0x00000007a0101000, 0x00000007c0000000)<br><span class="hljs-title">  region</span> size 1024K, 1<span class="hljs-title"> young</span> (1024K), 0<span class="hljs-title"> survivors</span> (0K)<br><span class="hljs-title"> Metaspace</span> <span class="hljs-title">      used</span> 2571K,<span class="hljs-title"> capacity</span> 4486K,<span class="hljs-title"> committed</span> 4864K,<span class="hljs-title"> reserved</span> 1056768K<br><span class="hljs-title">  class</span> space<span class="hljs-title">    used</span> 276K,<span class="hljs-title"> capacity</span> 386K,<span class="hljs-title"> committed</span> 512K,<span class="hljs-title"> reserved</span> 1048576K<br></code></pre></td></tr></table></figure>

<p>以上是一部分G1的GC日志信息，实际上我们程序运行了几秒中却生成了1MB多的日志数据，由此可见G1输出的日志真的很多。其中我们主要能看到以下几种GC类型。</p>
<h4 id="Evacuation-Pause：young（纯年轻代模式转移暂停）"><a href="#Evacuation-Pause：young（纯年轻代模式转移暂停）" class="headerlink" title="Evacuation Pause：young（纯年轻代模式转移暂停）"></a>Evacuation Pause：young（纯年轻代模式转移暂停）</h4><p>当年轻代空间用满后，应用线程会被暂停，年轻代内存块中的存活对象被拷贝到存活区。如果还没有存活区，则任意选择一部分空闲内存块作为存活区。拷贝的过程被称为转移（Evacuation），这和前面介绍的其他年轻代收集器是一样的工作原理。由于日志记录非常多，所以并行阶段和“其他”阶段的日志将拆分多个部分解析。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">2021-07-21T00:45:17.323-0800: 0.077:</span> [<span class="hljs-string">GC</span> <span class="hljs-string">pause</span> <span class="hljs-string">(G1</span> <span class="hljs-string">Evacuation</span> <span class="hljs-string">Pause)</span> <span class="hljs-string">(young)</span>, <span class="hljs-number">0.0035596</span> <span class="hljs-string">secs</span>]<br>   [<span class="hljs-attr">Parallel Time:</span> <span class="hljs-number">2.8</span> <span class="hljs-string">ms</span>, <span class="hljs-attr">GC Workers:</span> <span class="hljs-number">8</span>]<br>      <span class="hljs-string">...GC</span> <span class="hljs-string">work</span> <span class="hljs-string">thread</span><br>   [<span class="hljs-attr">Code Root Fixup:</span> <span class="hljs-number">0.0</span> <span class="hljs-string">ms</span>]<br>   [<span class="hljs-attr">Code Root Purge:</span> <span class="hljs-number">0.0</span> <span class="hljs-string">ms</span>]<br>   [<span class="hljs-attr">Clear CT:</span> <span class="hljs-number">0.1</span> <span class="hljs-string">ms</span>]<br>   [<span class="hljs-attr">Other:</span> <span class="hljs-number">0.6</span> <span class="hljs-string">ms</span>]<br>        <span class="hljs-string">...other</span> <span class="hljs-string">job</span><br>   [<span class="hljs-attr">Eden:</span> <span class="hljs-number">25.</span><span class="hljs-string">0M(25.0M)-&gt;0.0B(27.0M)</span> <span class="hljs-attr">Survivors:</span> <span class="hljs-number">0.</span><span class="hljs-string">0B-&gt;4096.0K</span> <span class="hljs-attr">Heap:</span> <span class="hljs-number">28.</span><span class="hljs-string">6M(512.0M)-&gt;8908.2K(512.0M)</span>]<br> [<span class="hljs-attr">Times:</span> <span class="hljs-string">user=0.01</span> <span class="hljs-string">sys=0.01</span>, <span class="hljs-string">real=0.00</span> <span class="hljs-string">secs</span>] <br></code></pre></td></tr></table></figure>

<blockquote>
<p>日志分析如下：</p>
<ol>
<li><code>[GC pause (G1 Evacuation Pause) (young), 0.0035596 secs]</code> G1转移暂停，纯年轻代模式：只清理年轻空间。这次暂停在JVM启动之后77ms开始，持续的系统时间为：<code>0.0035596 secs</code>，也就是<code>3.5ms</code>。</li>
<li><code>[Parallel Time: 2.8 ms, GC Workers: 8]</code> 表明后面的活动由8个Worker 线程并行执行，消耗时间为<code>2.8ms</code>（real time）；<code>worker</code>是一种模式，类似于一个老板指挥多个工人干活，类似与Netty的 BossGroup 和 WorkerGroup。</li>
<li><code>[Code Root Fixup: 0.0 ms]</code> 释放用于管理并行活动的内部数据，一般都接近于零。这个过程是串行执行的。</li>
<li><code>[Code Root Purge: 0.0 ms]</code> 清理其他部分数据，也是非常快的，如非必要基本上等于零，也是串行的执行的过程。</li>
<li><code>[Other: 0.6 ms]</code> 其他活动消耗的时间，其中大部分都是并行的。</li>
<li><code>[Eden: 25.0M(25.0M)-&gt;0.0B(27.0M)</code> 暂停之前和暂停之后，Eden区的使用量/总容量。</li>
<li><code>Survivors: 0.0B-&gt;4096.0K</code> GC暂停前后，存活区的使用量。<code>Heap: 28.6M(512.0M)-&gt;8908.2K(512.0M)]</code> 暂停前后整个堆内存的使用量和总容量。</li>
<li><code>[Times: user=0.01 sys=0.01, real=0.00 secs]</code> GC事件的持续事件。</li>
</ol>
<p>系统事件（wall clock time/elapsed time），是指一段程序从运行到终止，系统时钟走过的时间，一般系统时间比CPU时间略微长一点。</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs json">[Parallel Time: <span class="hljs-number">2.3</span> ms, GC Workers: <span class="hljs-number">8</span>]<br>[GC Worker Start (ms): Min: <span class="hljs-number">323.3</span>, Avg: <span class="hljs-number">323.4</span>, Max: <span class="hljs-number">323.4</span>, Diff: <span class="hljs-number">0.2</span>]<br>[Ext Root Scanning (ms): Min: <span class="hljs-number">0.0</span>, Avg: <span class="hljs-number">0.1</span>, Max: <span class="hljs-number">0.2</span>, Diff: <span class="hljs-number">0.2</span>, Sum: <span class="hljs-number">0.7</span>]<br>[Update RS (ms): Min: <span class="hljs-number">0.1</span>, Avg: <span class="hljs-number">0.2</span>, Max: <span class="hljs-number">0.3</span>, Diff: <span class="hljs-number">0.2</span>, Sum: <span class="hljs-number">1.4</span>]<br>[Processed Buffers: Min: <span class="hljs-number">0</span>, Avg: <span class="hljs-number">2.4</span>, Max: <span class="hljs-number">3</span>, Diff: <span class="hljs-number">3</span>, Sum: <span class="hljs-number">19</span>]<br>[Scan RS (ms): Min: <span class="hljs-number">0.0</span>, Avg: <span class="hljs-number">0.0</span>, Max: <span class="hljs-number">0.0</span>, Diff: <span class="hljs-number">0.0</span>, Sum: <span class="hljs-number">0.1</span>]<br>[Code Root Scanning (ms): Min: <span class="hljs-number">0.0</span>, Avg: <span class="hljs-number">0.0</span>, Max: <span class="hljs-number">0.0</span>, Diff: <span class="hljs-number">0.0</span>, Sum: <span class="hljs-number">0.0</span>]<br>[Object Copy (ms): Min: <span class="hljs-number">1.6</span>, Avg: <span class="hljs-number">1.8</span>, Max: <span class="hljs-number">1.8</span>, Diff: <span class="hljs-number">0.2</span>, Sum: <span class="hljs-number">14.3</span>]<br>[Termination (ms): Min: <span class="hljs-number">0.0</span>, Avg: <span class="hljs-number">0.0</span>, Max: <span class="hljs-number">0.1</span>, Diff: <span class="hljs-number">0.1</span>, Sum: <span class="hljs-number">0.2</span>]<br>[Termination Attempts: Min: <span class="hljs-number">1</span>, Avg: <span class="hljs-number">1.0</span>, Max: <span class="hljs-number">1</span>, Diff: <span class="hljs-number">0</span>, Sum: <span class="hljs-number">8</span>]<br>[GC Worker Other (ms): Min: <span class="hljs-number">0.0</span>, Avg: <span class="hljs-number">0.0</span>, Max: <span class="hljs-number">0.0</span>, Diff: <span class="hljs-number">0.0</span>, Sum: <span class="hljs-number">0.1</span>]<br>[GC Worker Total (ms): Min: <span class="hljs-number">2.0</span>, Avg: <span class="hljs-number">2.1</span>, Max: <span class="hljs-number">2.2</span>, Diff: <span class="hljs-number">0.2</span>, Sum: <span class="hljs-number">16.9</span>]<br>[GC Worker End (ms): Min: <span class="hljs-number">325.5</span>, Avg: <span class="hljs-number">325.5</span>, Max: <span class="hljs-number">325.5</span>, Diff: <span class="hljs-number">0.0</span>]<br></code></pre></td></tr></table></figure>

<blockquote>
<p>上面这段日志是省略的工作线程的日志信息，简单的解读如下：</p>
<ol>
<li><code>[Parallel Time: 2.3 ms, GC Workers: 8]</code> 前面介绍过，这表明下列活动由8个线程并行执行，消耗的时间为2.3ms(real time)。</li>
<li><code>GC Worker Start(ms)</code> GC的worker线程开始启动时，相当于 pause 开始时间的毫秒间隔，如果<code>Min</code>和<code>Max</code>差别很大，则表明本机其他进程所使用的线程数量过多，挤占了GC的可用CPU时间。</li>
<li><code>Ext Root Scanning(ms)</code> 用了多长时间来扫描堆外内存(non-heap) 的GC ROOT，如classloader，JNI引用，JVM系统ROOT等。后面显示了运行时间，“Sum”指的是CPU时间。</li>
<li><code>Update RS</code>，<code>Processed Buffers</code>，<code>Scan RS</code>这三部分也是类似的，<code>RS</code>是<code>Remember Set</code>的缩写。</li>
<li><code>Code Root Scanning(ms)</code> 扫描实际代码中的 root 用了多长时间：例如线程栈中的局部变量。</li>
<li><code>Object Copy(ms)</code> 用了多长时间来拷贝回收集中的存活对象。</li>
<li><code>Tremination(ms)</code> GC 的worker线程用了多长时间来确保自身可以安全地停止，这段时间内什么都不做，完成后GC线程就终止了，所以叫终止等待。</li>
<li><code>Termination Attempts</code> GC的 woker 线程尝试多少次 try 和 teminate。如果 worker 发现还有一些任务没有处理完，则这一次尝试就是失败的，暂时还不能终止。</li>
<li><code>GC Worker Other (ms)</code> 其他的一些小任务，因为时间很短，在GC日志将他们归结在一起。</li>
<li><code>GC Worker Total (ms)</code> GC的worker线程工作总计。</li>
<li><code>GC Worker End (ms)</code> GC的worker线程完成作业的时刻，相对于此次GC暂停开始时间的毫秒数。通常来说这部分数字应该大致相等，否则就说明有太多的线程被挂起。</li>
</ol>
</blockquote>
<p>除此之外，在转移暂停期间还有一些琐碎的小任务。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs json">[Other: <span class="hljs-number">0.6</span> ms]<br>  [Choose CSet: <span class="hljs-number">0.0</span> ms]<br>  [Ref Proc: <span class="hljs-number">0.2</span> ms]<br>  [Ref Enq: <span class="hljs-number">0.0</span> ms]<br>  [Redirty Cards: <span class="hljs-number">0.1</span> ms]<br>  [Humongous Register: <span class="hljs-number">0.0</span> ms]<br>  [Humongous Reclaim: <span class="hljs-number">0.0</span> ms]<br>  [Free CSet: <span class="hljs-number">0.0</span> ms]<br></code></pre></td></tr></table></figure>

<blockquote>
<p>其他琐碎任务，这里只介绍其中一部分：</p>
<ol>
<li><code>[Other: 0.6 ms]</code> 其他活动消耗的时间，其中很多是并行执行的。</li>
<li><code>[Choose CSet: 0.0 ms]</code> 选择CSet消耗的时间，CSet 是Colletion Set 的缩写。</li>
<li><code>[Ref Proc: 0.2 ms]</code> 处理非强引用（non-strong）的时间：进行清理或者决定是否需要清理。</li>
<li><code>[Ref Enq: 0.0 ms]</code> 用来将剩下的 non-strong 引用排序到合适的 <code>ReferenceQueue</code> 中。</li>
<li><code>[Humongous Register: 0.0 ms]</code>，<code>[Humongous Reclaim: 0.0 ms]</code> 大对象相关部分。</li>
<li><code>[Free CSet: 0.0 ms]</code> 将回收集中被释放的小堆归还所消耗的时间，以便给他们能用来分配新对象。</li>
</ol>
</blockquote>
<h4 id="Concurrent-Marking（并发标记）"><a href="#Concurrent-Marking（并发标记）" class="headerlink" title="Concurrent Marking（并发标记）"></a>Concurrent Marking（并发标记）</h4><p>当堆内存的总体使用达到一定的数值时，就会触发并发标记。这个默认比例<code>是45%</code>，但也可以通过JVM参数<code>InitialtingHeapOccupancyPercent</code> 来设置。和CMS一样，G1的并发标记也是由多个阶段组成，其中一些阶段是完成并发的，还有一些阶段则会暂停应用线程。如下是并发标记的日志信息：</p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs subunit">2021<span class="hljs-string">-07</span><span class="hljs-string">-21</span>T00:45:17.538<span class="hljs-string">-0800</span>: 0.292: [GC pause (G1 Humongous Allocation) (young) (initial-mark), 0.0044054 secs]<br>   ...<br>2021<span class="hljs-string">-07</span><span class="hljs-string">-21</span>T00:45:17.542<span class="hljs-string">-0800</span>: 0.296: [GC concurrent-root-region-scan-start]<br>2021<span class="hljs-string">-07</span><span class="hljs-string">-21</span>T00:45:17.542<span class="hljs-string">-0800</span>: 0.296: [GC concurrent-root-region-scan-end, 0.0000326 secs]<br>2021<span class="hljs-string">-07</span><span class="hljs-string">-21</span>T00:45:17.542<span class="hljs-string">-0800</span>: 0.296: [GC concurrent-mark-start]<br>2021<span class="hljs-string">-07</span><span class="hljs-string">-21</span>T00:45:17.544<span class="hljs-string">-0800</span>: 0.298: [GC concurrent-mark-end, 0.0019507 secs]<br>2021<span class="hljs-string">-07</span><span class="hljs-string">-21</span>T00:45:17.544<span class="hljs-string">-0800</span>: 0.299: [GC remark 2021<span class="hljs-string">-07</span><span class="hljs-string">-21</span>T00:45:17.544<span class="hljs-string">-0800</span>: 0.299: [Finalize Marking, 0.0002050 secs] <br>2021<span class="hljs-string">-07</span><span class="hljs-string">-21</span>T00:45:17.544<span class="hljs-string">-0800</span>: 0.299: [GC ref-proc, 0.0000344 secs] <br>2021<span class="hljs-string">-07</span><span class="hljs-string">-21</span>T00:45:17.544<span class="hljs-string">-0800</span>: 0.299: [Unloading, 0.0003887 secs], 0.0010297 secs]<br> [Times: user=0.00 sys=0.00, real=0.00 secs] <br>2021<span class="hljs-string">-07</span><span class="hljs-string">-21</span>T00:45:17.545<span class="hljs-string">-0800</span>: 0.300: [GC cleanup 319M-&gt;319M(512M), 0.0007032 secs]<br> [Times: user=0.01 sys=0.00, real=0.00 secs] <br></code></pre></td></tr></table></figure>

<h5 id="阶段1：Initial-Mark（初始标记）-1"><a href="#阶段1：Initial-Mark（初始标记）-1" class="headerlink" title="阶段1：Initial Mark（初始标记）"></a>阶段1：Initial Mark（初始标记）</h5><p>以下是这次GC事件的开始，我们不难发现这是因为大对象的分配导致的GC。初始标记日志如下：</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-number">2021</span>-<span class="hljs-number">07-21T00:45</span>:<span class="hljs-number">17</span>.<span class="hljs-number">538-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">292</span>: <br>        [GC pause (G1 Humongous Allocation) (young) (initial-mark), <span class="hljs-number">0.0044054</span> secs]<br></code></pre></td></tr></table></figure>

<h5 id="阶段2：Root-Region-Scan（Root区扫描）"><a href="#阶段2：Root-Region-Scan（Root区扫描）" class="headerlink" title="阶段2：Root Region Scan（Root区扫描）"></a>阶段2：Root Region Scan（Root区扫描）</h5><p>此阶段从Root开始标记扫描可达对象。以下是对应的日志信息。</p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs subunit">2021<span class="hljs-string">-07</span><span class="hljs-string">-21</span>T00:45:17.542<span class="hljs-string">-0800</span>: 0.296: <br>        [GC concurrent-root-region-scan-start]<br>2021<span class="hljs-string">-07</span><span class="hljs-string">-21</span>T00:45:17.542<span class="hljs-string">-0800</span>: 0.296: <br>        [GC concurrent-root-region-scan-end, 0.0000326 secs]<br></code></pre></td></tr></table></figure>

<h5 id="阶段3：Concurrent-Mark（并发标记）"><a href="#阶段3：Concurrent-Mark（并发标记）" class="headerlink" title="阶段3：Concurrent Mark（并发标记）"></a>阶段3：Concurrent Mark（并发标记）</h5><p>以下是并发标记阶段的日志输出。</p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs subunit">2021<span class="hljs-string">-07</span><span class="hljs-string">-21</span>T00:45:17.542<span class="hljs-string">-0800</span>: 0.296: <br>        [GC concurrent-mark-start]<br>2021<span class="hljs-string">-07</span><span class="hljs-string">-21</span>T00:45:17.544<span class="hljs-string">-0800</span>: 0.298: <br>        [GC concurrent-mark-end, 0.0019507 secs]<br></code></pre></td></tr></table></figure>

<h5 id="阶段4：Final-mark（最终标记）"><a href="#阶段4：Final-mark（最终标记）" class="headerlink" title="阶段4：Final mark（最终标记）"></a>阶段4：Final mark（最终标记）</h5><p>对应的日志信息。</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-number">2021</span>-<span class="hljs-number">07-21T00:45</span>:<span class="hljs-number">17</span>.<span class="hljs-number">544-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">299</span>: <br>    [GC remark <br>    <span class="hljs-number">2021</span>-<span class="hljs-number">07-21T00:45</span>:<span class="hljs-number">17</span>.<span class="hljs-number">544-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">299</span>: <br>    [Finalize Marking, <span class="hljs-number">0.0002050</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-21T00:45</span>:<span class="hljs-number">17</span>.<span class="hljs-number">544-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">299</span>: <br>    [GC ref-proc, <span class="hljs-number">0.0000344</span> secs] <br><span class="hljs-number">2021</span>-<span class="hljs-number">07-21T00:45</span>:<span class="hljs-number">17</span>.<span class="hljs-number">544-0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">299</span>: <br>    [Unloading, <span class="hljs-number">0.0003887</span> secs], <span class="hljs-number">0.0010297</span> secs]<br> [Times: user=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> sys=<span class="hljs-number">0</span>.<span class="hljs-number">00</span>, real=<span class="hljs-number">0</span>.<span class="hljs-number">00</span> secs] <br></code></pre></td></tr></table></figure>

<h5 id="阶段5：Cleanup（清理）"><a href="#阶段5：Cleanup（清理）" class="headerlink" title="阶段5：Cleanup（清理）"></a>阶段5：Cleanup（清理）</h5><p>最后这个清理阶段为即将到来的转移阶段作准备，统计小堆块中所有存活的对象，并将小堆块进行排序，以提高GC效率。这个阶段也为下一次标记执行必需的所有整理工作(house-keeping activites)：维护并发标记的内部状态。要注意的是，所有包括存活对象的小堆块在此阶段都被回收了。有一部分任务是并发的，例如空堆区的回收，还有大部分的存活率计算，此阶段也需要一个短暂的STW，才能不受应用线程的影响并完成作业，对应日志如下：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2021</span>-<span class="hljs-number">07</span>-<span class="hljs-number">21</span>T<span class="hljs-number">00</span>:<span class="hljs-number">45</span>:<span class="hljs-number">17</span>.<span class="hljs-number">545</span>-<span class="hljs-number">0800</span>: <span class="hljs-number">0</span>.<span class="hljs-number">300</span>:<span class="hljs-meta"> [GC cleanup 319M-&gt;319M(512M), 0.0007032 secs]</span><br></code></pre></td></tr></table></figure>

<h4 id="Evacuation-Pause-mixed-转移暂停：混合模式"><a href="#Evacuation-Pause-mixed-转移暂停：混合模式" class="headerlink" title="Evacuation Pause(mixed)(转移暂停：混合模式)"></a>Evacuation Pause(mixed)(转移暂停：混合模式)</h4><p>并发标记完成之后，G1将执行一次混合收集（mixed collection），不只清理年轻代，还将一部分老年代区域也加入到collection set中。混合模式的转移暂停（Evacuation pause）不一定紧跟并发标记阶段。在并发标记与混合转移暂停之间，很可能会存在多次 young 模式的转移暂停。</p>
<blockquote>
<p><code>混合模式</code> 就是指这次GC事件混合着处理年轻代和老年代的region。这也是G1等增量垃圾收集器的特色。而ZGC等最新的垃圾收集器则不使用分代算法。</p>
</blockquote>
<p>混合模式下的日志，和纯年轻代模式相比，还是有一些区别的。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">2021-07-21T00:45:17.574-0800: 0.328:</span> <br>    [<span class="hljs-string">GC</span> <span class="hljs-string">pause</span> <span class="hljs-string">(G1</span> <span class="hljs-string">Evacuation</span> <span class="hljs-string">Pause)</span> <span class="hljs-string">(mixed)</span>, <span class="hljs-number">0.0028130</span> <span class="hljs-string">secs</span>]<br>   [<span class="hljs-attr">Parallel Time:</span> <span class="hljs-number">2.4</span> <span class="hljs-string">ms</span>, <span class="hljs-attr">GC Workers:</span> <span class="hljs-number">8</span>]<br>        <span class="hljs-string">......</span><br>      [<span class="hljs-string">Update</span> <span class="hljs-string">RS</span> <span class="hljs-string">(ms):</span> <span class="hljs-attr">Min:</span> <span class="hljs-number">0.0</span>, <span class="hljs-attr">Avg:</span> <span class="hljs-number">0.0</span>, <span class="hljs-attr">Max:</span> <span class="hljs-number">0.1</span>, <span class="hljs-attr">Diff:</span> <span class="hljs-number">0.1</span>, <span class="hljs-attr">Sum:</span> <span class="hljs-number">0.2</span>]<br>         [<span class="hljs-attr">Processed Buffers: Min:</span> <span class="hljs-number">0</span>, <span class="hljs-attr">Avg:</span> <span class="hljs-number">0.9</span>, <span class="hljs-attr">Max:</span> <span class="hljs-number">1</span>, <span class="hljs-attr">Diff:</span> <span class="hljs-number">1</span>, <span class="hljs-attr">Sum:</span> <span class="hljs-number">7</span>]<br>      [<span class="hljs-string">Scan</span> <span class="hljs-string">RS</span> <span class="hljs-string">(ms):</span> <span class="hljs-attr">Min:</span> <span class="hljs-number">0.0</span>, <span class="hljs-attr">Avg:</span> <span class="hljs-number">0.0</span>, <span class="hljs-attr">Max:</span> <span class="hljs-number">0.0</span>, <span class="hljs-attr">Diff:</span> <span class="hljs-number">0.0</span>, <span class="hljs-attr">Sum:</span> <span class="hljs-number">0.0</span>]<br>      <span class="hljs-string">......</span><br>   [<span class="hljs-attr">Code Root Fixup:</span> <span class="hljs-number">0.0</span> <span class="hljs-string">ms</span>]<br>   [<span class="hljs-attr">Code Root Purge:</span> <span class="hljs-number">0.0</span> <span class="hljs-string">ms</span>]<br>   [<span class="hljs-attr">Clear CT:</span> <span class="hljs-number">0.1</span> <span class="hljs-string">ms</span>]<br>   [<span class="hljs-attr">Other:</span> <span class="hljs-number">0.3</span> <span class="hljs-string">ms</span>]<br>      [<span class="hljs-attr">Choose CSet:</span> <span class="hljs-number">0.0</span> <span class="hljs-string">ms</span>]<br>      [<span class="hljs-attr">Ref Proc:</span> <span class="hljs-number">0.1</span> <span class="hljs-string">ms</span>]<br>      [<span class="hljs-attr">Ref Enq:</span> <span class="hljs-number">0.0</span> <span class="hljs-string">ms</span>]<br>      [<span class="hljs-attr">Redirty Cards:</span> <span class="hljs-number">0.1</span> <span class="hljs-string">ms</span>]<br>      [<span class="hljs-attr">Humongous Register:</span> <span class="hljs-number">0.0</span> <span class="hljs-string">ms</span>]<br>      [<span class="hljs-attr">Humongous Reclaim:</span> <span class="hljs-number">0.0</span> <span class="hljs-string">ms</span>]<br>      [<span class="hljs-attr">Free CSet:</span> <span class="hljs-number">0.0</span> <span class="hljs-string">ms</span>]<br>   [<span class="hljs-attr">Eden:</span> <span class="hljs-number">10.</span><span class="hljs-string">0M(10.0M)-&gt;0.0B(21.0M)</span> <br>        <span class="hljs-attr">Survivors:</span> <span class="hljs-number">15.</span><span class="hljs-string">0M-&gt;4096.0K</span> <br>      <span class="hljs-attr">Heap:</span> <span class="hljs-number">425.</span><span class="hljs-string">6M(512.0M)-&gt;365.1M(512.0M)</span>]<br> [<span class="hljs-attr">Times:</span> <span class="hljs-string">user=0.01</span> <span class="hljs-string">sys=0.00</span>, <span class="hljs-string">real=0.00</span> <span class="hljs-string">secs</span>] <br></code></pre></td></tr></table></figure>

<blockquote>
<p>简单解读如下（部分概念和名称，可以参考前面的G1的日志分析）：</p>
<ol>
<li><code>Update RS (ms)</code> 因为 Remember Sets 是并发处理的，必须确保在实际的垃圾收集之前，缓冲区中的card 的得到处理，如果card数量很多，则GC并发线程的负载可能就会很高。可能的原因是修改的字段过多，或CPU资源受限。</li>
<li><code>Processed Buffers</code> 各个worker 线程处理了多个本地缓冲区（local buffer）。</li>
<li><code>Scan RS (ms)</code> 用了多长时间扫描来自RSet的引用。</li>
<li><code>[Clear CT: 0.1 ms]</code> 清理 card table 中的 cards 的时间。清理工作只是简单地删除“脏”状态，此状态用来标识一个字段是否被更新，供Remebered Sets 使用。</li>
<li><code>[Redirty Cards: 0.1 ms]</code> 将 card table 中适当的位置标记为 dirty 所花费的时间。</li>
</ol>
</blockquote>
<h4 id="Full-GC（Allocation-Failure）"><a href="#Full-GC（Allocation-Failure）" class="headerlink" title="Full GC（Allocation Failure）"></a>Full GC（Allocation Failure）</h4><p>G1 是一款自适应的增量垃圾收集器。一般来说，只有在内存严重不足的情况下才会发生 FullGC，以下即是这部分的日志输出结果。</p>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xl"><span class="hljs-number">2021</span>-<span class="hljs-number">07</span>-<span class="hljs-number">21</span>T00:<span class="hljs-number">45</span>:<span class="hljs-number">22.279</span>-<span class="hljs-number">0800</span>: <span class="hljs-number">5.033</span>: <br>        [F<span class="hljs-function"><span class="hljs-title">ull</span> GC (Allocation Failure)  405M-&gt;</span><span class="hljs-number">378</span>M(<span class="hljs-number">512</span>M), <span class="hljs-number">0.0339622</span> secs]<br>    [E<span class="hljs-function"><span class="hljs-title">den</span>: 0.0B(25.0M)-&gt;</span><span class="hljs-number">0.0</span>B(<span class="hljs-number">25.0</span>M) <br>        S<span class="hljs-function"><span class="hljs-title">urvivors</span>: 0.0B-&gt;</span><span class="hljs-number">0.0</span>B H<span class="hljs-function"><span class="hljs-title">eap</span>: 405.6M(512.0M)-&gt;</span><span class="hljs-number">378.8</span>M(<span class="hljs-number">512.0</span>M)], <br>      [M<span class="hljs-function"><span class="hljs-title">etaspace</span>: 2565K-&gt;</span><span class="hljs-number">2565</span>K(<span class="hljs-number">1056768</span>K)]<br>[Times: user=<span class="hljs-number">0.03</span> sys=<span class="hljs-number">0.00</span>, <span class="hljs-keyword">real</span>=<span class="hljs-number">0.04</span> secs] <br></code></pre></td></tr></table></figure>

<h2 id="GC调优"><a href="#GC调优" class="headerlink" title="GC调优"></a>GC调优</h2><p>我们的GC有很多的默认参数，基本能满足我们大多数的场景下的性能需求。但是在一些场景下我们的硬件条件并不是那么充足，或者说是在一些默认的场景下JVM不能满足我们的个别性能点需求。因此我们需要通过观察分析GC日志调整GC参数的方式，让JVM在特定的场景表现出最优的性能表现。那么GC调优我们该怎么开始呢？</p>
<blockquote>
<p>我刚接触GC调优的时候，我对GC调优无从下手，面对那么多参数，怎么才算是调优了呢？换一个垃圾收集器，堆空间改大一点？一脸懵。。</p>
</blockquote>
<h3 id="调优的基本流程"><a href="#调优的基本流程" class="headerlink" title="调优的基本流程"></a>调优的基本流程</h3><p>刚接触调优的新手面对200多个GC参数基本上都会一脸懵逼，然后随便调几个参数试试结果或者改几行代码试试，但是这样的操作基本上是徒劳的。<strong>GC调优和其他的其他的性能调优其实是同样的道理</strong>，只要按照一下的步骤操作，基本能保证我们调优的大方向不会错。</p>
<ol>
<li><strong>列出性能调优指标（State your performance goals）</strong></li>
<li><strong>执行测试（Run tests）</strong></li>
<li><strong>检查结果（Measure the results）</strong></li>
<li><strong>与目标进行对比（Compare the results with goals）</strong></li>
<li><strong>如果达不到指标，修改配置参数，然后继续测试（go back to running tests）</strong></li>
</ol>
<h3 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h3><p>第一步，我们需要做的事情是：制定明确的GC性能指标。对所有的性能监控和管理来看，有三个纬度是通用的：</p>
<ul>
<li><strong>Latency（延迟）</strong></li>
<li><strong>Throughput（吞吐量）</strong></li>
<li><strong>Capacity（系统容量）</strong></li>
</ul>
<h4 id="Latency（延迟）"><a href="#Latency（延迟）" class="headerlink" title="Latency（延迟）"></a>Latency（延迟）</h4><p>GC的延迟率指标由一般的延迟需求决定。延迟指标的描述一般如下：</p>
<ul>
<li>所有的交易必须在10秒内得到响应。</li>
<li>90%的订单付款操作必须在3秒内处理完成。</li>
<li>推荐商品必须在 100ms 内展示到用户面前。</li>
</ul>
<p>面对这类性能指标时，需要保证在交易过程中，<strong>GC暂停时间不能占用太多的时间</strong>，否则满足不了指标，但是我们知道在GC过程中是必定会进行STW的，那么这里的“不能占用太多”的意思是需要视具体情况而定，还要考虑其他的因素，比如外部数据源的交互时间（round-trips），锁竞争（lock contention），以及其他的安全点等。</p>
<blockquote>
<p>在CMS之前的垃圾收集器，垃圾收集工作周期都是需要全程暂停应用线程的，因此之前GC的延迟，在GC暂停期间就是一个几乎没有优化的空间的硬伤。</p>
</blockquote>
<p>假设性能需求为：<code>90%</code> 的交易要在<code>1000ms</code> 以内完成，每次交易最长不能超过<code>10s</code>。根据经验，假设GC暂停时间比例不能超过10%，也就是90%的GC暂停必须在<code>100ms</code>内结束，也不能超过<code>1000ms</code>的GC暂停。为了简单期间，我们忽略在同一次交易过程中发生多次的GC的停顿可能性。下面是一段GC日志片段。</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-number">2015</span>‐<span class="hljs-number">06</span>‐<span class="hljs-number">04</span><span class="hljs-variable">T13</span><span class="hljs-operator">:</span><span class="hljs-number">34</span><span class="hljs-operator">:</span><span class="hljs-number">16.974</span>‐<span class="hljs-number">0200</span><span class="hljs-operator">:</span> <span class="hljs-number">2.578</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">93677</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">70109</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">254976</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">499597</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">511230</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">761856</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">593275</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">581339</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1016832</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2936</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">2936</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">,</span> <span class="hljs-number">0.0713174</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.21</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.02</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.07</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure>

<p>上面的这段日志表示一次Parallel GC暂停，发生在<code>2015‐06‐04T13:34:16.974‐0200</code> ，对应着JVM启动后的第<code>2.578</code>秒。本次应用线程暂停了<code>0.0713174</code>秒。这次是一次 FullGC 暂停，花费的总时间<code>210ms</code>，但因为是多核CPU机器，所有最后重要的数字是应用线程被暂停的总时间<code>real</code>，这里使用的是并行GC，所以暂停的总时间是<code>70ms</code>，这里我们的性能要是90%的GC暂停必须在100ms内结束，这里的暂停时间是70ms，满足要求。</p>
<h4 id="Throughput（吞吐量）"><a href="#Throughput（吞吐量）" class="headerlink" title="Throughput（吞吐量）"></a>Throughput（吞吐量）</h4><p>吞吐量和延迟指标有很大区别。当然两者都是根据一般吞吐量需求而得出的。一般吞吐量需求（Generic requirements for throughput）类似下面这样：</p>
<ul>
<li>解决方案必须每天处理100万个订单。</li>
<li>解决方案必须支持1000个登录用户，同时在5～10秒内执行某个操作：A、B或C。</li>
<li>每周对所有客户进行统计，时间不超过6小时，时间窗口为每周日晚12点到次日6点之间。</li>
</ul>
<p>可以看出，<strong>吞吐量需求不是针对单个操作的，而是给定的时间内，系统必须完成多少个操作</strong>。和延迟需求类似，GC调优也需要去定GC行为所消耗的总时间。每个系统能接受的时间不同，一般来说，GC占用的总时间比不能超过 <code>10%</code>。</p>
<p>假设选在需求为：每分钟处理 1000 笔交易。同时，每分钟GC暂停的总时间不能超过6秒（即10%）。有了正式的需求，通过分析GC日志，我们可以得到下面这些信息。</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-number">2015</span>‐<span class="hljs-number">06</span>‐<span class="hljs-number">04</span><span class="hljs-variable">T13</span><span class="hljs-operator">:</span><span class="hljs-number">34</span><span class="hljs-operator">:</span><span class="hljs-number">16.974</span>‐<span class="hljs-number">0200</span><span class="hljs-operator">:</span> <span class="hljs-number">2.578</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">93677</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">70109</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">254976</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">499597</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">511230</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">761856</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">593275</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">581339</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1016832</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2936</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">2936</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">,</span> <span class="hljs-number">0.0713174</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.21</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.02</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.07</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure>

<p>此时我们对<code>用户耗时（user）</code>和<code>系统耗时（sys）</code>感兴趣而不关心<code>实际耗时（real）</code>。这里我们关心的时间为<code>0.23s</code>（user + sys = 0.21s + 0.02s），这段时间内，GC暂停会占用CPU资源。重要的是<strong>系统运行在多核心的机器上，转换到实际的停顿时间（stop-the-world）</strong>为<code>0.07131474秒</code>。提取出这些有用的信息之后，剩下的就是要统计每分钟内GC暂停的总时间。看看是否满足需求。每分钟内暂停时间不超过<code>6000毫秒</code>（<code>6秒</code>）。</p>
<blockquote>
<p>其实对与吞吐量的优化还是围绕着GC吞吐量公示来的，即：<strong>吞吐量 = 运行应用代码时间/(运行应用代码时间+ 运行垃圾收集时间)**。其实我们可以发现，只要缩短单位时间内垃圾收集时间暂停时间就能增加吞吐量，因此在调优吞吐量我们还是需要关心</strong>单位时间内暂停的总时长**。</p>
<p>关于 GCTime 中的 user、sys、real。这个问题之前困扰了我很久很久，他们之间的关系是什么？为什么会 user + sys = real？</p>
<p>我之前是知道user、sys、real 分别代表 用户耗时、系统耗时、实际耗时。但是他们之间的关系看的不是很明白。难道单次GC的用户耗时还能比实际耗时还要久？这次梳理我又去重新找了资料理解这几个时间背后的意思。</p>
<ul>
<li><strong>user</strong> 进程执行用户态代码（核心之外）所有的时间。这是执行此进程此线程所使用的实际CPU时间。其他进程和此阻塞线程的时间并不包括在内。在是垃圾收集的情况下，表示GC线程执行所使用的CPU总时间。</li>
<li><strong>sys</strong> 进程在内核态消耗的 CPU 时间，即在内核执行系统调用或者等待系统事件所使用的 CPU 时间。</li>
<li><strong>real</strong> 程序从开始到结束所用的时钟时间。这个时间包括其他进程使用的时间片和进程阻塞的时间（比如等待I/O完成）。</li>
</ul>
<p>user + sys 时间告诉我们，程序实际执行使用的CPU时间，这里是指<strong>所有的CPU</strong>，因此<strong>有多个线程的话，这个时间会超过 real 所表示的时钟时间</strong>。</p>
<p>通常情况下我们只需要参考<code>real</code>时间来进行优化，如果我们想通过<strong>增加线程或者增加CPU数量来减少GC停顿时间</strong>，我们可以参考<code>user</code>和<code>sys</code>。</p>
</blockquote>
<h4 id="Capacity（系统容量）"><a href="#Capacity（系统容量）" class="headerlink" title="Capacity（系统容量）"></a>Capacity（系统容量）</h4><p>系统容量（Capacity）需求，是达成吞吐量和延迟指标的情况下，对硬件环境的额外约束。这类需求大多数都是源于计算资源或者预算方面的原因。例如：</p>
<ul>
<li>系统必须能部署到小于512MB内存的Android设备上。</li>
<li>系统必须部署在配置不超过4核8GB的ECS上。</li>
<li>每个月云ECS的账单不超过10000元。</li>
</ul>
<p>因此，在满足延迟和吞吐量需求的基础上<strong>必须考虑系统容量</strong>。如果有无限的计算资源可以挥霍，那么任何延迟和吞吐量的指标都可以满足，但是<strong>现实是预算和其他约束限制了可用的资源。</strong></p>
<blockquote>
<p><strong>没有资源的限制也就没有调优。</strong></p>
</blockquote>
<h3 id="针对指标的简单调优示例"><a href="#针对指标的简单调优示例" class="headerlink" title="针对指标的简单调优示例"></a>针对指标的简单调优示例</h3><p>介绍完上面的三个指标，我们对下面的程序进行实际分析操作以达成GC指标。测试代码如下：</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-comment">//imports skipped for brevity </span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Producer</span> <span class="hljs-title">implements</span> <span class="hljs-title">Runnable</span> &#123;</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ScheduledExecutorService executorService = Executors.newScheduledThreadPool(<span class="hljs-number">2</span>); <br>    <span class="hljs-keyword">private</span> Deque&lt;<span class="hljs-keyword">byte</span>[]&gt; <span class="hljs-built_in">deque</span>; <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> objectSize; <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> queueSize; <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Producer</span><span class="hljs-params">(<span class="hljs-keyword">int</span> objectSize, <span class="hljs-keyword">int</span> ttl)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.<span class="hljs-built_in">deque</span> = <span class="hljs-keyword">new</span> ArrayDeque&lt;<span class="hljs-keyword">byte</span>[]&gt;();<br>        <span class="hljs-keyword">this</span>.objectSize = objectSize;<br>        <span class="hljs-keyword">this</span>.queueSize = ttl * <span class="hljs-number">1000</span>; <br>    &#125;<br>    <br>    @Override <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) &#123; <br>            <span class="hljs-built_in">deque</span>.add(<span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[objectSize]);<br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">deque</span>.<span class="hljs-built_in">size</span>() &gt; queueSize) &#123; <br>                <span class="hljs-built_in">deque</span>.poll();<br>            &#125; <br>        &#125; <br>    &#125;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">String</span>[] args)</span> throws InterruptedException </span>&#123; <br>        executorService.scheduleAtFixedRate( <span class="hljs-keyword">new</span> Producer(<span class="hljs-number">200</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> / <span class="hljs-number">1000</span>, <span class="hljs-number">5</span>), <span class="hljs-number">0</span>, <span class="hljs-number">100</span>, TimeUnit.MILLISECONDS ); <br>        executorService.scheduleAtFixedRate( <span class="hljs-keyword">new</span> Producer(<span class="hljs-number">50</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> / <span class="hljs-number">1000</span>, <span class="hljs-number">120</span>), <span class="hljs-number">0</span>, <span class="hljs-number">100</span>, TimeUnit.MILLISECONDS); <br>        TimeUnit.MINUTES.sleep(<span class="hljs-number">10</span>); executorService.shutdownNow(); <br>    &#125; <br>&#125;<br></code></pre></td></tr></table></figure>

<p>这段代码每100ms提交两个作业（job），每个作业都模拟特定的生命周期：创建对象，然后在特定的时间释放，接着就不管了，由GC来自动回收占用的内存。我们通过下面的JVM参数打开GC日志信息，并通过加上JVM参数<code>-Xloggc</code> 来指定GC日志的存储位置。</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">-XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+PrintGCTimeStamps -Xloggc:gc.<span class="hljs-built_in">log</span><br></code></pre></td></tr></table></figure>

<p>这样我们可以得到如下的一些日志输出信息：</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">04</span><span class="hljs-variable">T17</span><span class="hljs-operator">:</span><span class="hljs-number">03</span><span class="hljs-operator">:</span><span class="hljs-number">12.320</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.284</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">65442</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">10721</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">76288</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">65442</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">63175</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">251392</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0429520</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.03</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.08</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">04</span><span class="hljs-variable">T17</span><span class="hljs-operator">:</span><span class="hljs-number">03</span><span class="hljs-operator">:</span><span class="hljs-number">12.518</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.482</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">76078</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">10710</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">141824</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">128531</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">128246</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">316928</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0607000</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.03</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.07</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.06</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">04</span><span class="hljs-variable">T17</span><span class="hljs-operator">:</span><span class="hljs-number">03</span><span class="hljs-operator">:</span><span class="hljs-number">12.579</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">0.542</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">10710</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">0</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">141824</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">117535</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">128105</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">275968</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">128246</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">128105</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">417792</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2729</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2729</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0303548</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.10</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.03</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">04</span><span class="hljs-variable">T17</span><span class="hljs-operator">:</span><span class="hljs-number">03</span><span class="hljs-operator">:</span><span class="hljs-number">13.114</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">1.077</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">131072</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">10748</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">141824</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">259177</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">259140</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">417792</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.1061217</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.06</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.11</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.11</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-operator">...</span><br></code></pre></td></tr></table></figure>

<p>基于日志中的信息，我们可以通过三个优化目标来提升性能：</p>
<ol>
<li>确保最坏情况下，GC暂停时间不超过预定阈值。</li>
<li>确保线程暂停的总时间不超过预定阈值。</li>
<li>在确保达到延迟和吞吐量的指标下，降低硬件配置以及成本。</li>
</ol>
<p>为此我们使用三种不同配置，将代码运行10分钟，得到了三种不同的结果，汇总如下：</p>
<table>
<thead>
<tr>
<th>堆内存大小（Heap）</th>
<th>GC算法（GC Algorithm）</th>
<th>有效时间比（Useful work）</th>
<th>最长暂停时间（Longest pause）</th>
</tr>
</thead>
<tbody><tr>
<td>-Xmx12g</td>
<td>-XX:+UseConcMarkSweepGC</td>
<td>89.8%</td>
<td>560ms</td>
</tr>
<tr>
<td>-Xmx12g</td>
<td>-XX:+UseParallelGC</td>
<td>91.5%</td>
<td>1104ms</td>
</tr>
<tr>
<td>-Xmx8g</td>
<td>-XX:UseConcMarkSweepGC</td>
<td>66.3%</td>
<td>1610ms</td>
</tr>
</tbody></table>
<p>使用不同的GC算法和不同的内存配置，运行相同的代码，以测量GC暂停时间与延迟、吞吐量的关系。</p>
<blockquote>
<p>⚠️为了尽可能简单，示例中只改变了很少的输入参数，此实验也灭有在不同的CPU数量或者不同的堆布局下进行测试</p>
</blockquote>
<h4 id="调优延迟指标（Tuning-for-Latancy）"><a href="#调优延迟指标（Tuning-for-Latancy）" class="headerlink" title="调优延迟指标（Tuning for Latancy）"></a>调优延迟指标（Tuning for Latancy）</h4><p>假设我们有一个需求，每次作业必须在 1000ms 内处理完成。我们知道，实际的作业处理只需要100ms，简化后，两者相减我们就可以算出对GC暂停的延迟要求。现在需求变成：GC暂停时间不能超过900ms。这个问题就很容易找到答案，只要分析GC日志文件，并找出GC暂停中最大的那个暂停时间即可。</p>
<table>
<thead>
<tr>
<th>堆内存大小（Heap）</th>
<th>GC算法（GC Algorithm）</th>
<th>有效时间比（Useful work）</th>
<th>最长暂停时间（Longest pause）</th>
</tr>
</thead>
<tbody><tr>
<td>-Xmx12g</td>
<td>-XX:+UseConcMarkSweepGC</td>
<td>89.8%</td>
<td>560ms</td>
</tr>
<tr>
<td>-Xmx12g</td>
<td>-XX:+UseParallelGC</td>
<td>91.5%</td>
<td>1104ms</td>
</tr>
<tr>
<td>-Xmx8g</td>
<td>-XX:UseConcMarkSweepGC</td>
<td>66.3%</td>
<td>1610ms</td>
</tr>
</tbody></table>
<p>从上表中，其中我们可以看到有一个配置达到了要求，当堆内存大小为<code>-Xmx12g -XX:+UseConcMarkSweepGC</code>是最大的暂停时间为560ms，满足最大暂停时间小于900ms的目标，如果没有其他的关于吞吐量和系统容量的要求的话，目标达成调优结束。其运行配置参数为：</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-Xmx12g -XX:+UseConcMarkSweepGC</span><br></code></pre></td></tr></table></figure>

<h4 id="吞吐量调优（Tuning-for-Throughout）"><a href="#吞吐量调优（Tuning-for-Throughout）" class="headerlink" title="吞吐量调优（Tuning for Throughout）"></a>吞吐量调优（Tuning for Throughout）</h4><p>假定吞吐量指标为：每小时完成1300万次操作处理。同样是上面的配置，其中有一种配置满足了需求：</p>
<table>
<thead>
<tr>
<th>堆内存大小（Heap）</th>
<th>GC算法（GC Algorithm）</th>
<th>有效时间比（Useful work）</th>
<th>最长暂停时间（Longest pause）</th>
</tr>
</thead>
<tbody><tr>
<td>-Xmx12g</td>
<td>-XX:+UseConcMarkSweepGC</td>
<td>89.8%</td>
<td>560ms</td>
</tr>
<tr>
<td>-Xmx12g</td>
<td>-XX:+UseParallelGC</td>
<td><strong>91.5%</strong></td>
<td>1104ms</td>
</tr>
<tr>
<td>-Xmx8g</td>
<td>-XX:UseConcMarkSweepGC</td>
<td>66.3%</td>
<td>1610ms</td>
</tr>
</tbody></table>
<p>从上面的表格的数据不难得出，这里<code>-Xmx12g -XX:+UseParallelGC</code>是唯一有效的解。这里的GC占用的8.5%的时间，剩下91.5%都是有效的计算时间。为了简单起见，我们忽略示例中的其他安全点。现在需要考虑：</p>
<ol>
<li>每个CPU核心处理一次作业需要耗时<code>100ms</code>。</li>
<li>因此，一分钟内每个核心可以执行60000次操作（每个job完成100次操作）。</li>
<li>一小时内，一个核心可以执行360万次。</li>
<li>有四个CPU内核，则每小时可以执行：4 * 3.6M = 1440万次操作。</li>
</ol>
<p>理论上，通过简单的计算就可以得出结论，每小时可以执行的操作数为：<code>14.4M * 91.5% = 13176000</code>次，满足需求。值得一提的是，假若还要满足延迟指标，那就有问题了，最坏的情况下，GC暂停时间为<code>1104ms</code>，最大延迟时间是前一种配置的两倍。</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-Xmx12g -XX:+UseParallelGC</span><br></code></pre></td></tr></table></figure>

<h4 id="调优系统容量（Tuning-for-Capacity）"><a href="#调优系统容量（Tuning-for-Capacity）" class="headerlink" title="调优系统容量（Tuning for Capacity）"></a>调优系统容量（Tuning for Capacity）</h4><p>假设需要将软件部署到服务器上，配置为<code>4核10G</code>。这样的话，系统容量的要求就变成，最大的堆内存空间不能超过<code>8G</code>。有了这个需求，我们的三套配置只有最后一个满足条件。</p>
<table>
<thead>
<tr>
<th>堆内存大小（Heap）</th>
<th>GC算法（GC Algorithm）</th>
<th>有效时间比（Useful work）</th>
<th>最长暂停时间（Longest pause）</th>
</tr>
</thead>
<tbody><tr>
<td>-Xmx12g</td>
<td>-XX:+UseConcMarkSweepGC</td>
<td>89.8%</td>
<td>560ms</td>
</tr>
<tr>
<td>-Xmx12g</td>
<td>-XX:+UseParallelGC</td>
<td>91.5%</td>
<td>1104ms</td>
</tr>
<tr>
<td><strong>-Xmx8g</strong></td>
<td>-XX:UseConcMarkSweepGC</td>
<td>66.3%</td>
<td>1610ms</td>
</tr>
</tbody></table>
<p>因此在这个需求下的运行配置</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-Xmx8g -XX:+UseConcMarkSweepGC</span><br></code></pre></td></tr></table></figure>

<h3 id="日志分析工具"><a href="#日志分析工具" class="headerlink" title="日志分析工具"></a>日志分析工具</h3><p>之前我们梳理过一些监控诊断工具，其中有很多工具都可以很好的监控GC，其中命令行工具 <code>jstat -gc</code>，<code>jvisulvm</code>，<code>jmc</code>都是可以很有效的监控堆空间使用以及GC工作情况。这里就详细介绍了，如果有不太记得了的朋友，可以回去看看😏。其中最主要用于分析GC的GC信息还是GC日志，日志中包含了GC最全面的描述，就是GC事实上的标准，可以作为GC性能评估的最真实数据来源。GC日志一般输出到文件之中，是纯text格式的，当然也可以打印到控制台。有多个可以控制GC日志的JVM参数，例如可以打印每次GC的持续时间，以及程序暂停时间（<code>-XX:+PrintGCApplicationStoppedTime</code>），还有GC清理了多少引用类型（<code>-XX:+PrintReferenceGC</code>）。</p>
<p>其中最基础的要打印出GC日志，需要在启动参数中指定以下参数（将所有GC事件打印到日志文件中，输出每次GC的日期和时间戳。不同GC算法输出的内容略有不同）：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">‐XX:+PrintGCTimeStamps ‐XX:+PrintGCDateStamps ‐XX:+PrintGCDetails ‐Xloggc:<span class="hljs-tag">&lt;<span class="hljs-name">filename</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>下面是一段GC的日志信息，其中记录了5次GC信息，其中包括了1次youngGC，还包括了4次FullGC。</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">04</span><span class="hljs-variable">T17</span><span class="hljs-operator">:</span><span class="hljs-number">03</span><span class="hljs-operator">:</span><span class="hljs-number">30.892</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">18.775</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">920064</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">189402</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1143808</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">2723073</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2722965</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">3912704</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.3732643</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.52</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.37</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.37</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">04</span><span class="hljs-variable">T17</span><span class="hljs-operator">:</span><span class="hljs-number">03</span><span class="hljs-operator">:</span><span class="hljs-number">31.266</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">19.148</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">189402</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">0</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1143808</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">2533562</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">1984964</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">2796544</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">2722965</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">1984964</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">3940352</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2764</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2764</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.1733963</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">1.04</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.17</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">04</span><span class="hljs-variable">T17</span><span class="hljs-operator">:</span><span class="hljs-number">03</span><span class="hljs-operator">:</span><span class="hljs-number">34.496</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">22.378</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">954368</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">0</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1143808</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">1984964</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2171912</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">2796544</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">2939332</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2171912</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">3940352</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2777</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2777</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.2171111</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">1.14</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.02</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.22</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">04</span><span class="hljs-variable">T17</span><span class="hljs-operator">:</span><span class="hljs-number">03</span><span class="hljs-operator">:</span><span class="hljs-number">38.196</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">26.078</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">954368</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">0</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1143808</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">2171912</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2361421</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">2796544</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">3126280</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2361421</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">3940352</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2780</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2780</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.2804937</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">1.44</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.03</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.28</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2021</span><span class="hljs-operator">-</span><span class="hljs-number">07</span><span class="hljs-operator">-</span><span class="hljs-number">04</span><span class="hljs-variable">T17</span><span class="hljs-operator">:</span><span class="hljs-number">03</span><span class="hljs-operator">:</span><span class="hljs-number">41.895</span><span class="hljs-operator">-</span><span class="hljs-number">0800</span><span class="hljs-operator">:</span> <span class="hljs-number">29.777</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">954368</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">0</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1143808</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">2361421</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2550111</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">2796544</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">3315789</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2550111</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">3940352</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">2782</span><span class="hljs-built_in">K</span><span class="hljs-operator">-&gt;</span><span class="hljs-number">2782</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.2061000</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">1.25</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.03</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.21</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br></code></pre></td></tr></table></figure>

<p>在上面的日志信息中记录了如下的信息：</p>
<ul>
<li>这一段日志截取自JVM后启动的18秒到30秒的区间。</li>
<li>young区域的空间大小是 1143808K 即 1117MB，老年代空间 2796544K 即 2731MB，这个堆空间大小3940352K 即 3848MB，Metaspace空间大小1032MB。</li>
<li>在这一段GC日志中，应用总共运行了 11.0002s，期间发生了4次GC（不算最后一次GC）其中3次FullGC和一次YoungGC，其中GC总暂停时间为1.25s，占总运行时间的～=8.8%。</li>
<li>在第一次youngGC之后，后续的GC全部为FullGC，并且在每次FullGC，整个堆空间的占用依旧呈现上升趋势，可以看出内存空间并不能及时的释放。</li>
</ul>
<p>通过对这些日志的简单分析，我们基本可以得出，目前JVM的GC是病态的，JVM频繁地进行FullGC，并且FullGC后，堆内存仍然呈上升的趋势。可以预见的是当增长的内存空间超过堆空间大小，应用将会出现OOM或持续GC无法正常工作的情况。</p>
<p>当然我们还可以从GC日志中得到更多的信息，比如在某个时间段内内存的分配速率和垃圾收集速率，在每次垃圾youngGC后对象的晋升速率等等。但是如果一般系统会产生大量的GC日志，纯靠人工很难进行完全地阅读和分析。</p>
<p>这个时候我们就要合理的利用我们的GC日志分析工具来帮助我们充分分析诊断GC，这里我们主要介绍两个工具在GC调优过程中的使用，一个是GCViewer，另外一个是 GCEasy。</p>
<h4 id="GCViewer"><a href="#GCViewer" class="headerlink" title="GCViewer"></a>GCViewer</h4><p>GCViewer 是一个开源工具的GC日志分析工具。项目在 GitHub 主页各项指标进行了完整的描述。下面我们介绍一些常用指标。第一步获取GC日志文件，并且使用以下命令打开 GCViewer，并且得到下面的界面。</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-keyword">java </span>-<span class="hljs-keyword">jar </span>gcviewer<span class="hljs-number">-1</span>.<span class="hljs-number">36</span>.<span class="hljs-keyword">jar </span>gc.log<br></code></pre></td></tr></table></figure>

<p><img src="https://gitee.com/realDaiwei/img/raw/master/20210707002631.png" srcset="/img/loading.gif"></p>
<p>如果不想打开界面，我们也可以使用下面的命令将GC数据导出到 summary.cvs 和 chart.png 中</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">java -jar gcviewer-<span class="hljs-number">1.36</span><span class="hljs-selector-class">.jar</span> gc<span class="hljs-selector-class">.log</span> <span class="hljs-selector-tag">summary</span><span class="hljs-selector-class">.csv</span> chart.png<br></code></pre></td></tr></table></figure>

<p>我们一起来简单看下分析下GCViewer输出的数据，我们先从左侧的第一个tab页图表（Chart）开始。GCViewer使用折线向我们展示了内存空间以及垃圾收集器的工作情况。其中黑色的线代表的是<code>FullGC</code>，深紫色的线表示堆空间的使用，绿色的线表示<code>GC时间</code>。图中两种颜色对应的区域，其中黄色的代表年轻代，紫色代表老年代。</p>
<p><img src="https://gitee.com/realDaiwei/img/raw/master/20210707004548.png" srcset="/img/loading.gif"></p>
<p>第二个tab页面是事件详情（Event details）其中记录了GC暂停事件（GC pauses）、FullGC暂停事件（Full gc pauses）和并发GC其中在GC暂停事件中，我们能看到这些GC事件的<code>名称（name）</code>、<code>次数（n）</code>、<code>最小值（min）</code>、<code>最大值（max）</code>、<code>平均值（avg）</code>、<code>标准差（stddev）</code>、<code>总时间（sum(s)）</code>、<code>分项总时间占比（sum(%)）</code>。我们可以看到GC暂停（GC pauses）记录的是YoungGC的暂停时间，而FullGC暂停（Full GC pauses）记录了两类暂停，一类是分配失败的FullGC（Allocation Failure），另一类是自适应（Ergonomics）产生的FullGC。其中我们不难发现绝大多数大部分的FullGC是由自适应调整带来的FullGC。我们测试的是 ParallelGC ，GC时会全程暂停应用线程，因此没有并发GC的数据。</p>
<p><img src="https://gitee.com/realDaiwei/img/raw/master/20210707234907.png" srcset="/img/loading.gif"><br>最后一个tab 语法分析程序（Parser）这个部分是一个类似日志输出的窗口，但输出的信息是GCViewer版本，JVM版本，内存大小，执行参数等信息。右侧我们有同样也有三个tab页，这里详细的收集记录了JVM这段时间内的堆空间信息，和GC暂停信息。第一个tab页是一个汇总（summary)信息，其中堆空间的使用情况，总暂停时间，总暂停次数、吞吐量等常用的统计数据一目了然。</p>
<p><img src="https://gitee.com/realDaiwei/img/raw/master/20210708000947.png" srcset="/img/loading.gif"></p>
<p>第二个tab页是内存有关信息（Memory），这里包括各个分代内存的使用情况、GC后的内存释放信息和对西那个的晋升速率的信息，可以帮助我们有效的分析堆空间中对象的存活与回收情况。</p>
<p><img src="https://gitee.com/realDaiwei/img/raw/master/20210725173205.png" srcset="/img/loading.gif"></p>
<p>最后一个tab页是暂停有关信息（pause）从总暂停、FullGC暂停、GC暂停这三个纬度统计了GC的最大、最小和平均暂停时间、GC间隔时间的数据，这些数据可以帮助我们全面分析GC的暂停情况。</p>
<p><img src="https://gitee.com/realDaiwei/img/raw/master/20210708001650.png" srcset="/img/loading.gif"></p>
<p>以上就是GCViewer对一次GC日志的分析结果，GCViewer通过GC日志对GC的内存和暂停进行了充分的分析，数据分析地非常全面。但如果要说缺点的话，GCViewer的UI设计还有很大的提升空间。</p>
<h4 id="GCEasy"><a href="#GCEasy" class="headerlink" title="GCEasy"></a>GCEasy</h4><p>GCEasy在前面的文章中我们做过简单的介绍，今天介绍GC的分析结果。通过GCEasy输出的图表数据，帮助大家快速有效的分析GC日志。第一个图表是JVM的内存概览图，左侧是图表包括分配内存量，和内存最大值，右侧是数据的柱状图。</p>
<p><img src="https://gitee.com/realDaiwei/img/raw/master/20210708231952.png" srcset="/img/loading.gif"></p>
<p>第二个图表是关键性能指标（Key Performance Indicators），其中主要记录的指标是吞吐量和GC暂停的图表数据。</p>
<p><img src="https://gitee.com/realDaiwei/img/raw/master/20210708232336.png" srcset="/img/loading.gif"></p>
<p>第三张图是交互图表（Interactive Graphs），其中<code>Heap after GC</code>表示GC后的堆空间大小，<code>Heap before GC</code>表示GC前的堆空间大小，</p>
<p><code>GC Duration</code>是GC的持续时间，<code>Reclaimed Bytes</code>表示GC后回收的字节大小，<code>Young Gen</code>表示young区的内存使用情况，同理<code>Old Gen</code>表示老年代的内存使用情况，<code>Meta Space</code> 表示Meta区的内存使用情况最后一个<code>A &amp; P</code>表示对象从新生代晋升到老年代的晋升速率。</p>
<p><img src="https://gitee.com/realDaiwei/img/raw/master/20210708232943.png" srcset="/img/loading.gif"></p>
<p>第四张图表是GC的统计数据（GC Statistics），按照各个不同的纬度统计GC的数据，可以帮助我们从各个角度详细的分析GC。</p>
<p><img src="https://gitee.com/realDaiwei/img/raw/master/20210708234008.png" srcset="/img/loading.gif"></p>
<p>最后的两张图是对象统计（Object Stats）和 GC产生原因（GC Causes）分析，其中对象统计计算了对象创建数量和对象晋升的数据。而GC产生原因分析造成GC的原因以及相关的一些GC产生时的一些数据统计。</p>
<p><img src="https://gitee.com/realDaiwei/img/raw/master/20210708234450.png" srcset="/img/loading.gif"><img src="https://gitee.com/realDaiwei/img/raw/master/20210708234435.png" srcset="/img/loading.gif"></p>
<p>以上就是GCEasy对“普通”用户上传的GC日志进行分析的结果，如果想要获得更多的数据可以进行充值，但是这么多纬度和这么数据分析足以让我们完成GC问题定位和GC调优目标达成判定。相较于GCViewer，GCEasy的图表更加丰富，结果展示更加直观，并且不用额外下载软件。如果遇到此类需求，我更倾向使用GCEasy🙈。</p>
<h3 id="GC调优实战"><a href="#GC调优实战" class="headerlink" title="GC调优实战"></a>GC调优实战</h3><p>这一小节我们介绍导致性能问题的典型情况，这些示例都是来自于生产环境，为演示做了一定长度的精简。</p>
<blockquote>
<p><code>Allocation Rate</code> 翻译过来就是<code>分配速率</code>，而不是分配率；因为不是百分比，而是单位时间内分配的量。</p>
<p><code>Promotion Rate</code> 翻译为 <code>提成速率</code>，即从新生代提升到老年代的速率。</p>
</blockquote>
<h4 id="高分配速率（High-Allocation-Rate）"><a href="#高分配速率（High-Allocation-Rate）" class="headerlink" title="高分配速率（High Allocation Rate）"></a>高分配速率（High Allocation Rate）</h4><p>分配速率（<code>Allocation rate</code>）表示单位时间内分配的内存量。通常使用<code>MB/sec</code>作为单位，也可以使用<code>PB/year</code> 等。分配率过高就会严重影响程序的性能，在JVM中会导致巨大的GC开销。</p>
<h5 id="如何测量分配速率"><a href="#如何测量分配速率" class="headerlink" title="如何测量分配速率"></a>如何测量分配速率</h5><p>在测试分配速率之前，我们需要设置JVM参数：<code>-XX:+PrintGCDetails -XX:+PrintGCTimeStamps</code>，通过GC日志来计算分配速率，GC日志如下所示：</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-number">0.291</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <br>            <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">33280</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">5088</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">38400</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">33280</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">24360</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">125952</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0365286</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>      <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.11</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.02</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">0.446</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <br>            <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">38368</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">5120</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">71680</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">57640</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">46240</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">159232</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0456796</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>      <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.15</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.02</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.04</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">0.829</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <br>            <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">71680</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">5120</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">71680</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">112800</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">81912</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">159232</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0861795</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>      <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.23</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.03</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.09</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure>

<p>计算<code>上一次垃圾收集之后</code>，与<code>下一次GC开始之前</code>的年轻代使用量，两者的差值除以时间，就是分配速率。痛殴上面的日志，可以计算出以下的信息：</p>
<ul>
<li>JVM启动之后<code>291ms</code>，共创建了<code>33280KB</code>的对象。第一次 Minor GC（小型GC）完成后，年轻代中还有<code>5088KB</code>的对象存活。</li>
<li>在启动之后<code>446ms</code>，年轻代的使用量增加到<code>38368KB</code>，触发第二次GC，触发第二次GC，完成后年轻代的使用量减少到<code>5129KB</code>。</li>
<li>在启动之后<code>829ms</code>，年轻代的使用量为<code>71680KB</code>，GC后变为<code>5120KB</code>。</li>
</ul>
<p>通过使用年轻代的使用量我们可以计算分配速率（Allocation druing/ time），如下表所示：</p>
<table>
<thead>
<tr>
<th>Event</th>
<th>TIme</th>
<th>Young before</th>
<th>Young after</th>
<th>Allocation during</th>
<th>Allocation rate</th>
</tr>
</thead>
<tbody><tr>
<td>1st GC</td>
<td>291ms</td>
<td>33280KB</td>
<td>5088KB</td>
<td>33280KB</td>
<td>144MB/sec</td>
</tr>
<tr>
<td>2nd GC</td>
<td>446ms</td>
<td>38368KB</td>
<td>5120KB</td>
<td>33280KB</td>
<td>215MB/sec</td>
</tr>
<tr>
<td>3rd GC</td>
<td>829ms</td>
<td>71680KB</td>
<td>5120KB</td>
<td>66560KB</td>
<td>173MB/sec</td>
</tr>
<tr>
<td>Total</td>
<td>829ms</td>
<td>N/A</td>
<td>N/A</td>
<td>133120KB</td>
<td>161MB/sec</td>
</tr>
</tbody></table>
<p>通过这些信息可以知道，在测量期间，该程序的内存分配速率为<code>161MB/sec</code>。</p>
<h5 id="分配速率的意义"><a href="#分配速率的意义" class="headerlink" title="分配速率的意义"></a>分配速率的意义</h5><p>分配速率的的变化，会增加或降低GC暂停的频率，从而影响吞吐量。但只有年轻代的<code>minor GC</code>受分配速率的影响，老年代GC的频率和持续时间不受<code>分配速率（allocation rate）</code>的直接影响，而收到<code>提升速率（promotion rate）</code>的影响。</p>
<p>现在我们只关心 Minor GC的暂停，查看年轻代的3个内存池。因为对象在Eden区分配。所以我们一起来看 Eden 区的大小和分配速率的关系，看看增加 Eden 区的容量，能不能减少Minor GC 暂停次数，从而使程序能够维持更高的分配速率。进过我们的实验，通过参数 <code>-XX:NewSize</code>、<code>-XX:MaxNewSize</code>以及<code>-XX:SurvivorRatio</code> 设置不同的Eden空间，运行同一程序时，可以发现：</p>
<ul>
<li>Eden 空间为<code>100MB</code> 时，分配速率低于<code>100MB/sec</code>。</li>
<li>将 Eden 区增加为<code>1G</code>，分配速率也随之增长，大约等于<code>200MB/sec</code>。</li>
</ul>
<p>为什么会这样？<strong>因为减少GC暂停，就等价于减少了任务线的暂停，就可以更多的工作了</strong>，也就可以创建更多的对象，所以对同一应用来说，分配速率越高越好。通过这个结论我们可以得出<strong>“**</strong>Eden区越大越好**<strong>”</strong>这个结论前，我们注意到，分配速率可能会也可能不会影响程序的实际吞吐量。吞吐量和分配速率有一定关系，因为分配速率会影响MinorGC暂停，但对于总体吞吐量的影响，还要考虑<code>MajorGC</code>暂停，而且吞吐量的单位不是<code>MB/s</code>，而是系统所处理的业务量。</p>
<h5 id="高分配率对JVM的影响及解决方案"><a href="#高分配率对JVM的影响及解决方案" class="headerlink" title="高分配率对JVM的影响及解决方案"></a>高分配率对JVM的影响及解决方案</h5><p>首先，我们应该检查程序的吞吐量是否降低，如果创建了过多的临时对象，minorGC的次数将会增加。如果并发较大，则GC可能会严重影响吞吐量。遇到这种情况时，MinorGC会非常频繁，GC日志将会像下面这样，JVM的启动参数为<code>-XX+PringGCDetails -XX:PringGCTimeStamps -Xmx32m</code>。</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-number">2.808</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">9760</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">32</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">10240</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0003076</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2.819</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">9760</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">32</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">10240</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0003079</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2.830</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">9760</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">32</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">10240</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0002968</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2.842</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">9760</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">32</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">10240</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0003374</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2.853</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">9760</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">32</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">10240</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0004672</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2.864</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">9760</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">32</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">10240</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0003371</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2.875</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">9760</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">32</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">10240</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0003214</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2.886</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">9760</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">32</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">10240</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0003374</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2.896</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">9760</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">32</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">10240</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0003588</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure>

<p>很显然minGC 的频率太高了，这说明创建了大量的对象。另外年轻在GC之后的使用量又很低，也没有FullGC发生，种种迹象表明，GC对吞吐量造成了严重的影响。那么我们要如何处理这些问题呢？其实在某些情况下，<strong>只要增加年轻代的大小，即可降低分配速率过高所造成的影响</strong>，增加年轻代并不会降低分配速率，但是会减少GC的频率，如果每次GC剩余的对象很少，GC的持续时间也不会明显的增长。增加年轻代是开源的方式解决，我们还可以节流。我们可以在代码中<strong>尽量使用基础类型代替包装类型，从而减少对象的创建。</strong></p>
<h4 id="过早提升（Premature-Promotion）"><a href="#过早提升（Premature-Promotion）" class="headerlink" title="过早提升（Premature Promotion）"></a>过早提升（Premature Promotion）</h4><p><code>提升速率（promotion rate）</code>，用于<strong>衡量单位时间内从年轻代提升到老年代的数据量</strong>，一般用<code>MB/sec</code>作为单位和分配速率类似。JVM会将长时间存活的对象从年轻代提升到老年代。根据分代假设，可能存在一种情况，老年代中不仅有存活时间长的对象，也可能存在存活时间短的对象。因此<strong>过早提升即对象存活时间还不够长的时候就被提升到老年代。</strong>majorGC 不是为频繁回收而设计的，但 majorGC现在也要清理这些生命短暂的对象，就会导致GC暂停时间过长，这会<strong>严重影响系统的吞吐量**</strong>。**</p>
<h5 id="如何测量提升速率"><a href="#如何测量提升速率" class="headerlink" title="如何测量提升速率"></a>如何测量提升速率</h5><p>可以指定JVM参数<code>-XX:+PrintGCTimeStamps</code>，通过GC日志来测量提升速率，JVM记录的GC暂停信息如下所示：</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-number">2.176</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <br>                                <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">9216</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">0</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">10752</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <br>                <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">10020</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">9042</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">12288</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">19236</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">9042</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">23040</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0036840</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2.394</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <br>                                <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">9216</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">0</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">10752</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <br>                <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">9042</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">8064</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">12288</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">18258</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">8064</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">23040</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0032855</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2.611</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <br>                                <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">9216</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">0</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">10752</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <br>                                <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">8064</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">7085</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">12288</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">17280</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">7085</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">23040</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0031675</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2.817</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <br>                                <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">9216</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">0</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">10752</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <br>                <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">7085</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">6107</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">12288</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">16301</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">6107</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">23040</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0030652</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure>

<p>从上面的日志可以得知：GC之前和之后的年轻代使用量以及堆内存使用量。这样就可以通过差值算出老年代的使用量，GC日志中的信息可以表述为：</p>
<table>
<thead>
<tr>
<th>Event</th>
<th>TIme</th>
<th>Young descreased</th>
<th>Total descreased</th>
<th>Promoted</th>
<th>Promotion rate</th>
</tr>
</thead>
<tbody><tr>
<td>事件</td>
<td>耗时</td>
<td>年轻减少</td>
<td>整个堆内存减少</td>
<td>提升量</td>
<td>提升速率</td>
</tr>
<tr>
<td>1st GC</td>
<td>291ms</td>
<td>28192K</td>
<td>8920K</td>
<td>19272K</td>
<td>66.2MB/sec</td>
</tr>
<tr>
<td>2nd GC</td>
<td>446ms</td>
<td>33248K</td>
<td>11400K</td>
<td>21848K</td>
<td>140.95MB/sec</td>
</tr>
<tr>
<td>3rd GC</td>
<td>829ms</td>
<td>66560K</td>
<td>30888K</td>
<td>35672K</td>
<td>93.14MB/sec</td>
</tr>
<tr>
<td>Total</td>
<td>829ms</td>
<td></td>
<td></td>
<td>76792K</td>
<td>92.63MB/sec</td>
</tr>
</tbody></table>
<p>乍一看似乎不是过早提升的问题。事实上，在每次GC之后老年代的使用率似乎在减少。但反过来想，要是没有对象提升或提升率很小，也就不会看到那么多的FullGC了。简单解释一下这里的GC行为：有<strong>很多对象提升到老年代，同时老年代中也有很多对象被回收了，这就是造成了老年代使用量减少的假性，但事实是大量的对象不断地被提升到老年代，并触发 fullGC。</strong></p>
<h5 id="提升速率的意义"><a href="#提升速率的意义" class="headerlink" title="提升速率的意义"></a>提升速率的意义</h5><p>和分配速率一样，提升速率也会影响GC暂停的频率。但是分配速率主要影响 MinorGC，而提升速率则直接影响 Major GC的频率。有大量的对象提升，自然很快将老年代塞满，老年代填充的越快，则Major GC事件的频率也就越高。</p>
<p><img src="https://gitee.com/realDaiwei/img/raw/master/20210723234555.png" srcset="/img/loading.gif"></p>
<p>此前我们介绍过，fullGC 通常需要更多的时间，因为需要处理更多的对象，还需要执行碎片整理等额外的复杂过程。通常过早提升的症状表现为以下的形式：</p>
<ul>
<li><strong>短时间内频繁地执行FullGC。</strong></li>
<li><strong>每次FullGC后老年代的使用率都非常低，都在10%～20%或以下。</strong></li>
<li><strong>提升速率接近于分配速率。</strong></li>
</ul>
<h5 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h5><p>简单来说，要解决这类问题，需要让年轻代存放得下暂存的数据。有两种简单的方法：</p>
<ul>
<li><strong>增加年轻代的大小。</strong>设置JVM启动参数，类似这样：<code>-Xmx64m -XX:NewSize=32m</code>，程序在执行时，Full GC 的次数自然会减少很多，只会 minorGC 的持续时间产生影响：</li>
</ul>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-number">2.251</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <br>                    <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">28672</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">3872</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">28672</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">37126</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">12358</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">61440</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0008543</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br><span class="hljs-number">2.776</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Allocation</span> <span class="hljs-built_in">Failure</span><span class="hljs-punctuation">)</span> <br>                    <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">28448</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">4096</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">28672</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">36934</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">16974</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">61440</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0033022</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure>

<ul>
<li><strong>减少每次批处理的数量</strong>。也能得到类似的结果，至于选用那个方案，要根据业务需求决定。在某些情况下，业务逻辑不允许减少批处理的数量，那就只能增加堆内存，或者重新指定年轻代的大小。</li>
</ul>
<p>如果都不可行，就只能优化数据结构，减少内存消耗。但总体目标依然是一致的，让临时数据能够在年轻代存放的下。</p>
<blockquote>
<p>能在年轻代就尽量不要提升到老年代，从而避免过早提升。</p>
</blockquote>
<h4 id="Weak，Soft-及-Phantom-引用"><a href="#Weak，Soft-及-Phantom-引用" class="headerlink" title="Weak，Soft 及 Phantom 引用"></a>Weak，Soft 及 Phantom 引用</h4><p>另一类影响GC的问题是程序中中的<code>non-strong引用</code>。虽然这类引用在很多情况下可以避免出现<code>OutOfMemoryError</code>，但过量使用也会对GC造成严重的影响，反而降低系统性能。</p>
<h5 id="弱引用的缺点"><a href="#弱引用的缺点" class="headerlink" title="弱引用的缺点"></a>弱引用的缺点</h5><p>首先，<code>弱引用(weak reference)</code> 是可以被GC强制回收的。当垃圾收集器发现一个弱可达对象(weakly reachable 即指向该对象的引用只剩下弱引用) 时，就会将其置入相应的<code>ReferenceQueue</code>中，变成可终结的对西那个，之后可能遍历这个 reference queue，并执行相应的清理。典型的示例是清除缓存中不再引用的KEY。当然，在这个时候，我们还可以将该对象赋值给新的强引用，在最后终结和回收前，GC会在此确认该对象是否可以安全回收。因此，弱引用对象的回收过程是横跨多个GC周期的。实际上<strong>弱引用使用的很多，大部分缓存框架(caching solution) 都是基于弱引用实现的</strong>，所以虽然业务代码中没有直接使用弱引用，但是程序中依然大量存在。其次，<code>软引用</code>(soft reference)<strong>比弱引用更难被垃圾收集器回收，回收软引用没有确切的时间点，由JVM自己决定，一般只会在即将耗尽可用内存时，才会回收软引用，以作最后手段</strong>。这意味着，可能会有更频繁的 fullGC，暂停时间也比预期更长，因为老年代中的存活对象会很多。最后，<strong>使用虚引用（phantom reference）时，必须手动进行内存管理，以标识这些对象是否可以安全地回收</strong>，表面上看起来很正常，但实际上并不是。javadoc 中写到：</p>
<blockquote>
<p>In order to ensure that a reclaimable object remains so, the referent of a phantom reference may not be </p>
<p>retrieved: The get method of a phantom reference always returns null. (为了防止可回收对象的残留，虚引用对象不应该被获取<code>phantom reference</code> 的 <code>get</code> 方法返回值永远是<code>null</code>)。</p>
</blockquote>
<p>令人惊讶的是，很多开发这更容易忽略下面一段内容（这才是重点）：</p>
<blockquote>
<p>Unlike soft and weak references, phantom references are not automatically cleared by the garbage collector as they are enqueued. An object that is reachable via phantom references will remain so until all such references are cleared or themselves become unreachable.(与软引用和弱引用不同，虚引用不会被被GC自动清除，因为他们被存放在队列中，通过虚引用可达对象会继续存在内从中，直到调此引用的 clear 方法，或者引用自身变为不可达)。</p>
</blockquote>
<p>也就是说，<strong>我们必须手动调用 clear() 来清除虚引用，否则可能造成OutOfMemeoryError 而导致JVM挂掉</strong>，使用虚引用的理由是，对于用编程手段来跟踪某个对象何时变为不可达对象，这是唯一的常规手段。<strong>和软引用/弱引用不同的是，我们不能复活虚可达（phantom-reachable）对象</strong>。</p>
<h5 id="使用非强引用的影响"><a href="#使用非强引用的影响" class="headerlink" title="使用非强引用的影响"></a>使用非强引用的影响</h5><p>建议使用JVM参数 <code>-XX:+PrintReferenceGC</code> 来看看各种引用对GC的影响，如果将此参数用于启动，将会看到：</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-number">2.173</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <br>        <span class="hljs-number">2.234</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">SoftReference</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span> <span class="hljs-variable">refs</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0000151</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>    <span class="hljs-number">2.234</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">WeakReference</span><span class="hljs-operator">,</span> <span class="hljs-number">2648</span> <span class="hljs-variable">refs</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0001714</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>    <span class="hljs-number">2.234</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">FinalReference</span><span class="hljs-operator">,</span> <span class="hljs-number">1</span> <span class="hljs-variable">refs</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0000037</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>    <span class="hljs-number">2.234</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PhantomReference</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span> <span class="hljs-variable">refs</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span> <span class="hljs-variable">refs</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0000039</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>    <span class="hljs-number">2.234</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">JNI</span> <span class="hljs-variable">Weak</span> <span class="hljs-variable">Reference</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0000027</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>   <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">9216</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">8676</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">10752</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <br>   <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">12115</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">12115</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">12288</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">21331</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">20792</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">23040</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <br>   <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">3725</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">3725</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0766685</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>   <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.49</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.08</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>   <br><span class="hljs-number">2.250</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <br>        <span class="hljs-number">2.307</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">SoftReference</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span> <span class="hljs-variable">refs</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0000173</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>    <span class="hljs-number">2.307</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">WeakReference</span><span class="hljs-operator">,</span> <span class="hljs-number">2298</span> <span class="hljs-variable">refs</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0001535</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>    <span class="hljs-number">2.307</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">FinalReference</span><span class="hljs-operator">,</span> <span class="hljs-number">3</span> <span class="hljs-variable">refs</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0000043</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>    <span class="hljs-number">2.307</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PhantomReference</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span> <span class="hljs-variable">refs</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span> <span class="hljs-variable">refs</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0000042</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>    <span class="hljs-number">2.307</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">JNI</span> <span class="hljs-variable">Weak</span> <span class="hljs-variable">Reference</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0000029</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>   <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">9215</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">8747</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">10752</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>   <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">12115</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">12115</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">12288</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">21331</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">20863</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">23040</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <br>   <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">3725</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">3725</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0734832</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>   <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.52</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.07</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>   <br><span class="hljs-number">2.323</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-built_in">Full</span> <span class="hljs-variable">GC</span> <span class="hljs-punctuation">(</span><span class="hljs-variable">Ergonomics</span><span class="hljs-punctuation">)</span> <br>        <span class="hljs-number">2.383</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">SoftReference</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span> <span class="hljs-variable">refs</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0000161</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>    <span class="hljs-number">2.383</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">WeakReference</span><span class="hljs-operator">,</span> <span class="hljs-number">1981</span> <span class="hljs-variable">refs</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0001292</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>    <span class="hljs-number">2.383</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">FinalReference</span><span class="hljs-operator">,</span> <span class="hljs-number">16</span> <span class="hljs-variable">refs</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0000049</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>    <span class="hljs-number">2.383</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">PhantomReference</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span> <span class="hljs-variable">refs</span><span class="hljs-operator">,</span> <span class="hljs-number">0</span> <span class="hljs-variable">refs</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0000040</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>    <span class="hljs-number">2.383</span><span class="hljs-operator">:</span> <span class="hljs-punctuation">[</span><span class="hljs-variable">JNI</span> <span class="hljs-variable">Weak</span> <span class="hljs-variable">Reference</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0000027</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>   <span class="hljs-punctuation">[</span><span class="hljs-variable">PSYoungGen</span><span class="hljs-operator">:</span> <span class="hljs-number">9216</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">8809</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">10752</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <br>   <span class="hljs-punctuation">[</span><span class="hljs-variable">ParOldGen</span><span class="hljs-operator">:</span> <span class="hljs-number">12115</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">12115</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">12288</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-number">21331</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">20925</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">23040</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <br>   <span class="hljs-punctuation">[</span><span class="hljs-variable">Metaspace</span><span class="hljs-operator">:</span> <span class="hljs-number">3725</span><span class="hljs-built_in">K</span>‐<span class="hljs-operator">&gt;</span><span class="hljs-number">3725</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">(</span><span class="hljs-number">1056768</span><span class="hljs-built_in">K</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-operator">,</span> <span class="hljs-number">0.0738414</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span> <br>   <span class="hljs-punctuation">[</span><span class="hljs-built_in">Times</span><span class="hljs-operator">:</span> <span class="hljs-variable">user</span><span class="hljs-operator">=</span><span class="hljs-number">0.52</span> <span class="hljs-variable">sys</span><span class="hljs-operator">=</span><span class="hljs-number">0.01</span><span class="hljs-operator">,</span> <span class="hljs-variable">real</span><span class="hljs-operator">=</span><span class="hljs-number">0.08</span> <span class="hljs-variable">secs</span><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure>

<p>只有确认了GC对应的吞吐量和延迟造成影响之后，才应该花心思来分析这些信息，审查这部分日志，通常情况下，每次GC清理的引用数据都是很少的，发部分情况下为<code>0</code>，如果GC花了较多的时间来清理这类引用，或者清理了很多的此类引用，就需要进一步观察分析了。</p>
<h5 id="解决方案-1"><a href="#解决方案-1" class="headerlink" title="解决方案"></a>解决方案</h5><p>如果程序确实碰到了<code>mis-</code>, <code>ab-</code> 问题或者滥用 week，soft，phantom引用，一般都要修改程序的实现逻辑。每个系统不一样，因此很难提供通用的知道建议，但是有一些通用的办法：</p>
<ul>
<li><code>弱引用(week reference)</code> 如果某个内存池的使用量增大，造成了性能问题，那么增加内存池的大小（可能也要增加堆内存的最大容量）。如示例中可以看到，增加堆内存大小，以及年轻代的大小，可以减轻症状。</li>
<li><code>软引用(soft reference)</code> 如果确定问题的根源是软引用，唯一的解决办法是修改程序源码，改变内部实现逻辑。</li>
<li><code>虚引用(Phantom reference)</code> 请确保在程序中调用了虚引用的<code>clear</code>方法。编程中很容易忽略某些虚引用，或者清理的速度跟不上生产的速度，又或者清楚引用队列的线程挂了，就会对GC造成很大压力，最终引起<code>OutOfMemeoryError</code>。</li>
</ul>
<h4 id="巨无霸对象的分配-Humongous-Allocation"><a href="#巨无霸对象的分配-Humongous-Allocation" class="headerlink" title="巨无霸对象的分配(Humongous Allocation)"></a>巨无霸对象的分配(Humongous Allocation)</h4><p>如果使用G1垃圾收集算法；会产生一种巨无霸对象引起的GC性能问题。</p>
<blockquote>
<p>说明 在G1中，巨无霸对象是指所占空间超过一个小堆区(region) <code>50%</code> 的对象。</p>
</blockquote>
<p>频繁创建巨无霸对象，无疑会造成GC的性能问题，我们先看看G1的处理方式：</p>
<ul>
<li>如果 region 中含有巨无霸对象，则巨无霸对象后面的空间将不会进行分配。如果所有巨无霸对象都超过某个比例，则未使用空间就会引发内存碎片问题。</li>
<li>G1 没有对巨无霸对象进行优化。这在JDK8以前是一个特别棘手的问题——在Java1.8u4.0之前的版本中，巨无霸对象所在region的回收只能在fullGC中进行。最新版本的Hotspot JVM，在marking 阶段之后的 cleanup 阶段中释放巨无霸区间，所以这个问题在新版本JVM中的影响已大大降低。</li>
</ul>
<p>如果存在巨无霸对象分配问题会输出如下日志：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">0.106:</span> [<span class="hljs-string">G1Ergonomics</span> <span class="hljs-string">(Concurrent</span> <span class="hljs-string">Cycles)</span> <br>                <span class="hljs-string">request</span> <span class="hljs-string">concurrent</span> <span class="hljs-string">cycle</span> <span class="hljs-string">initiation</span>, <br>        <span class="hljs-attr">reason:</span> <span class="hljs-string">occupancy</span> <span class="hljs-string">higher</span> <span class="hljs-string">than</span> <span class="hljs-string">threshold</span>, <br>        <span class="hljs-attr">occupancy:</span> <span class="hljs-number">60817408</span> <span class="hljs-string">bytes</span>, <span class="hljs-attr">allocation request:</span> <span class="hljs-number">1048592</span> <span class="hljs-string">bytes</span>, <br>        <span class="hljs-attr">threshold:</span> <span class="hljs-number">60397965</span> <span class="hljs-string">bytes</span> <span class="hljs-string">(45.00</span> <span class="hljs-string">%)</span>, <span class="hljs-attr">source:</span> <span class="hljs-string">concurrent</span> <span class="hljs-string">humongous</span> <span class="hljs-string">allocation</span>] <br><span class="hljs-attr">0.106:</span> [<span class="hljs-string">G1Ergonomics</span> <span class="hljs-string">(Concurrent</span> <span class="hljs-string">Cycles)</span> <span class="hljs-string">request</span> <span class="hljs-string">concurrent</span> <span class="hljs-string">cycle</span> <span class="hljs-string">initiation</span>, <br>                <span class="hljs-attr">reason:</span> <span class="hljs-string">requested</span> <span class="hljs-string">by</span> <span class="hljs-string">GC</span> <span class="hljs-string">cause</span>, <span class="hljs-attr">GC cause:</span> <span class="hljs-string">G1</span> <span class="hljs-string">Humongous</span> <span class="hljs-string">Allocation</span>] <br><span class="hljs-attr">0.106:</span> [<span class="hljs-string">G1Ergonomics</span> <span class="hljs-string">(Concurrent</span> <span class="hljs-string">Cycles)</span> <span class="hljs-string">initiate</span> <span class="hljs-string">concurrent</span> <span class="hljs-string">cycle</span>, <br>                <span class="hljs-attr">reason:</span> <span class="hljs-string">concurrent</span> <span class="hljs-string">cycle</span> <span class="hljs-string">initiation</span> <span class="hljs-string">requested</span>] <br><span class="hljs-attr">0.106:</span> [<span class="hljs-string">GC</span> <span class="hljs-string">pause</span> <span class="hljs-string">(G1</span> <span class="hljs-string">Humongous</span> <span class="hljs-string">Allocation)</span> <span class="hljs-string">(young)</span> <span class="hljs-string">(initial‐mark)</span> <br><span class="hljs-attr">0.106:</span> [<span class="hljs-string">G1Ergonomics</span> <span class="hljs-string">(CSet</span> <span class="hljs-string">Construction)</span> <span class="hljs-string">start</span> <span class="hljs-string">choosing</span> <span class="hljs-string">CSet</span>, <br>                <span class="hljs-attr">_pending_cards:</span> <span class="hljs-number">0</span>, <span class="hljs-attr">predicted base time:</span> <span class="hljs-number">10.00</span> <span class="hljs-string">ms</span>, <br>        <span class="hljs-attr">remaining time:</span> <span class="hljs-number">190.00</span> <span class="hljs-string">ms</span>, <span class="hljs-attr">target pause time:</span> <span class="hljs-number">200.00</span> <span class="hljs-string">ms</span>]<br></code></pre></td></tr></table></figure>

<p>这样的日志表明程序中确实创建了巨无霸对象，可以看到<code>G1 Humongous Allocation</code> 是GC暂停的原因。再看前面一点的<code>allocation request: 1048592 bytes</code>，可以发现程序试图分配一个<code>1048592</code> 字节的对象，这要比巨无霸区域(<code>2MB</code>)的50%多出16字节。第一中解决方式是修改 region size，以使得大多数的对象大小不超过<code>50%</code>，也就不进行巨无霸对象区域的分配。 region 的默认大小在启动时根据堆内存的大小算出。但也可以指定参数来覆盖默认设置，<code>-XX:G1HeapRegionSize=XX</code>。指定region size必须在<code>1～32MB</code>之间，还必须是2的幂大小，所以region size 只能是：<code>1m</code>，<code>2m</code>，<code>4m</code>，<code>8m</code>，<code>16m</code>，<code>32m</code>。 这种方式也有副作用，<strong>增加region 的大小也就变相减少了region 的数量，所以需要谨慎使用</strong>。更好的方式是，<strong>如果可以的话在程序中限制对象大小</strong>。避免大对象问题的出现。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这一小节我们总结梳理了JVM目前主要使用中的GC的日志分析解读和GC调优，其中我们分析了SerialGC、ParallelGC、CMS 和 G1的日志，通过这段日志信息的解读为后面的GC调优打下基础。第二个部分我们介绍了GC调优。GC调优分为以下几步：<code>列出性能调优指标</code>、<code>执行测试</code>、<code>检查结果</code>、<code>与目标进行对比</code>、<code>如果达不到指标，修改指标，调整参数继续测试</code>。接下来我们介绍了几个核心参数概念：<code>Latency</code>、<code>Throughput</code>、<code>Capacity</code>。</p>
<p>我们可以针对这几个参数进行调优。当然手动人工的去分析一行行GC日志，效率必然很低也很容易漏掉一些参数，我们介绍了可视化GC工具——GCViewer 和 GCEasy。最后我们分析了线上的几种常见的GC问题的日志分析和解决方案。</p>
<h2 id="学习资料"><a href="#学习资料" class="headerlink" title="学习资料"></a>学习资料</h2><ul>
<li>Java 垃圾收集必备手册 （github项目地址：<a target="_blank" rel="noopener" href="https://github.com/cncounter/gc-handbook%EF%BC%89">https://github.com/cncounter/gc-handbook）</a></li>
<li>GC 日志的解读与分析（上、中、下）</li>
<li><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1491229">如何选择合适的 GC 时间 —— USER, SYS, REAL？</a></li>
</ul>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Java%E8%99%9A%E6%8B%9F%E6%9C%BA/">Java虚拟机</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/JVM/">JVM</a>
                    
                      <a class="hover-with-bg" href="/tags/Java%E7%9F%A5%E8%AF%86%E7%BB%93%E6%9E%84%E6%A2%B3%E7%90%86/">Java知识结构梳理</a>
                    
                      <a class="hover-with-bg" href="/tags/%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/">学习总结</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/08/02/icebreaker-of-JIT/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">JVM 进阶 — 即时编译入门</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/06/27/garbage-collector-2/">
                        <span class="hidden-mobile">JVM GC篇 — 垃圾收集器（下）</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>

<!-- SCRIPTS -->

  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      $('#local-search-input').on('click', function() {
        searchFunc(path, 'local-search-input', 'local-search-result');
      });
      $('#modalSearch').on('shown.bs.modal', function() {
        $('#local-search-input').focus();
      });
    })()
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>



</body>
</html>
